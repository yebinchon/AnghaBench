#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_6__   TYPE_1__ ;

/* Type definitions */
typedef  scalar_t__ uint16_t ;
struct TYPE_6__ {int wct; int andx_command; int pwlen; int bcc; scalar_t__ user_id; } ;
typedef  TYPE_1__ tree_connect_andx_request ;
typedef  TYPE_1__ smb_header ;

/* Variables and functions */
 unsigned char SESSION_MESSAGE ; 
 int /*<<< orphan*/  SMB_TREE_CONNECT_ANDX ; 
 scalar_t__ FUNC0 (scalar_t__) ; 
 int /*<<< orphan*/  FUNC1 (TYPE_1__*,int /*<<< orphan*/ ,int,int,int /*<<< orphan*/ ,scalar_t__,scalar_t__,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC2 (unsigned char*) ; 
 unsigned char* FUNC3 (scalar_t__) ; 
 int /*<<< orphan*/  FUNC4 (unsigned char*,TYPE_1__*,int) ; 
 int /*<<< orphan*/  FUNC5 (TYPE_1__*,int /*<<< orphan*/ ,int) ; 
 unsigned char* FUNC6 (unsigned char*,...) ; 
 scalar_t__ FUNC7 () ; 
 int /*<<< orphan*/  FUNC8 (unsigned char*,char*,char const*) ; 
 scalar_t__ FUNC9 (char const*) ; 
 int /*<<< orphan*/  FUNC10 (int,unsigned char*,int) ; 

void
FUNC11 (unsigned char *buffer, int fd,
                           const char *netbios_name)
{
  smb_header hdr;
  tree_connect_andx_request tcar;
  uint16_t proc_id, user_id;
  unsigned char *p, *q;

  proc_id = (uint16_t) FUNC7 ();
  user_id = ((smb_header *) (buffer + 4))->user_id;

  FUNC1 (&hdr, SMB_TREE_CONNECT_ANDX, 0x18, 0x2001, 0, proc_id,
                    user_id, 0);

  buffer[0] = SESSION_MESSAGE;
  buffer[1] = 0x0;

  FUNC4 (buffer + 4, &hdr, sizeof (smb_header));

  FUNC5 (&tcar, 0, sizeof (tree_connect_andx_request));

  tcar.wct = 4;
  tcar.andx_command = 0xff;     /* No further commands */
  tcar.pwlen = 1;

  p = buffer + 4 + sizeof (smb_header) + sizeof (tree_connect_andx_request);

  /* Password */
  p = FUNC6 (p, "");

  /* Path */
  q = FUNC3 (8 + FUNC9 (netbios_name));

  FUNC8 (q, "\\\\%s\\IPC$", netbios_name);
  p = FUNC6 (p, q);

  FUNC2 (q);

  /* Service */
  p = FUNC6 (p, "IPC");

  tcar.bcc =
    p - buffer - 4 - sizeof (smb_header) - sizeof (tree_connect_andx_request);

  FUNC4 (buffer + 4 + sizeof (smb_header), &tcar,
          sizeof (tree_connect_andx_request));

  /* Another byte count */
  *(uint16_t *) (buffer + 2) =
    FUNC0 ((uint16_t)
             (sizeof (tree_connect_andx_request) + sizeof (smb_header) +
              tcar.bcc));

  FUNC10 (fd, buffer,
         sizeof (tree_connect_andx_request) + sizeof (smb_header) + 4 +
         tcar.bcc);
}