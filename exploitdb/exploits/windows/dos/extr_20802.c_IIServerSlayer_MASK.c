#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {int /*<<< orphan*/  rem; } ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  IPPROTO_TCP ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 TYPE_1__ FUNC1 (int,int) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int FUNC4 (int,char*,int) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int /*<<< orphan*/  FUNC6 (char*,...) ; 
 int FUNC7 (int,char*,int,int /*<<< orphan*/ ) ; 
 int s ; 
 int /*<<< orphan*/  FUNC8 (int,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int FUNC9 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC10 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/ * FUNC11 (char*,char*) ; 

void FUNC12(char *target,int lenght,int port,int flags) {
  char buff[2],header[512],*IIS_string = "Server: Microsoft-IIS/3.0";
  char *IIS_patch = "Bad Request";
  int count = 0,return_status;
  if ((s = FUNC9(AF_INET, SOCK_STREAM, IPPROTO_TCP)) == -1) {
    FUNC5("socket()");
    FUNC2(1);
  }
  if((return_status = FUNC4(s,target,port))) FUNC2(return_status);
  if(lenght) FUNC6("Sending request lenght = %d to %s\n",lenght,target);
  else FUNC6("Sending request to test if %s is a Microsoft-IIS/3.0 server\n"
              ,target);
  FUNC8(s,FUNC3(lenght),FUNC10(FUNC3(lenght)),0);
  FUNC6("Waiting for the reply from %s\n",target);
  buff[1]=0;
  while(FUNC7(s,buff,1,0) == 1) {
    if(flags & 1) FUNC6("%s",buff);
    else if(!FUNC1(count,50).rem) FUNC6(".");
    if(count < 511) header[count]=buff[0];
    count++;
  }
  FUNC6("\n");
  header[511]=0;
  if(FUNC11(header,IIS_string) == NULL && lenght == 0) {
    FUNC6("This is not a Microsoft-IIS/3.0 web server\n");
    if(!(flags & 2)) FUNC2(0);
  }
  else if(!lenght) FUNC6("Ok, this is a Microsoft-IIS/3.0 web server\n");
  if(FUNC11(header,IIS_patch) != NULL) {
    FUNC6("This IIS/3.0 web server is patched against this exploit\n");
    if(!(flags & 2)) FUNC2(0);
  }
  FUNC0(s);
}