#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 scalar_t__ FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (unsigned char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC2 (char*,int,int,int,int,unsigned char*,int,unsigned char*,int) ; 

int FUNC3() {
unsigned char * buf;
buf = (unsigned char *)FUNC0(4000000);
FUNC1(buf,0,4000000);
unsigned char * buf2;
buf2 = (unsigned char *)FUNC0(4000000);
FUNC1(buf2,0,4000000);

//overflows specifying too large palette
FUNC2("ok8bit.bmp",16,16,8,0,buf,256,buf,16*16);
FUNC2("paletteof1.bmp",16,16,8,0,buf,65535,buf,16*16);
FUNC2("paletteof2.bmp",16,16,8,0,buf,1000000,buf,16*16);

//integer overflows with image dimensions
FUNC2("ok24bit.bmp",16,16,24,0,NULL,0,buf,16*16*4);
FUNC2("wh4intof.bmp",32769,32768,24,0,NULL,0,buf,4000000);
FUNC2("wh3intof.bmp",37838,37838,24,0,NULL,0,buf,4000000);
FUNC2("w4intof.bmp",1073741825,1,24,0,NULL,0,buf,4000000);
FUNC2("w3intof.bmp",1431655767,1,24,0,NULL,0,buf,4000000);

//overflows with RLE encoded BMPs
buf2[0]=16;
buf2[1]=0;
FUNC2("okRLE.bmp",16,1,8,1,buf,256,buf2,2);
for(long i=0;i<500000;i++) {
buf2[i*2]=255;
buf2[i*2+1]=0;
}
FUNC2("rle8of1.bmp",16,1,8,1,buf,256,buf2,1000000);
buf2[0]=15;
buf2[1]=0;
for(long i=1;i<500000;i++) {
buf2[i*2]=255;
buf2[i*2+1]=0;
}
FUNC2("rle8of2.bmp",16,1,8,1,buf,256,buf2,1000000);
FUNC1(buf2,0,4000000);
buf2[0]=0;
buf2[1]=2;
buf2[2]=255;
buf2[3]=0;
for(long i=4;i<100000-1;) {
buf2[i]=0;
buf2[i+1]=254;
i+=255;
}
FUNC2("rle8of3.bmp",16,1,8,1,buf,256,buf2,1000000);
FUNC1(buf2,0,4000000);
for(long i=0;i<100000-1;) {
buf2[i]=0;
buf2[i+1]=254;
i+=255;
}
FUNC2("rle8of4.bmp",16,1,8,1,buf,256,buf2,1000000);
}