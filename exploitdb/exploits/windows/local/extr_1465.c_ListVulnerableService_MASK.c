#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_9__   TYPE_3__ ;
typedef  struct TYPE_8__   TYPE_2__ ;
typedef  struct TYPE_7__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  lpServices ;
struct TYPE_7__ {int dwCurrentState; } ;
struct TYPE_9__ {char* lpServiceName; char* lpDisplayName; TYPE_1__ ServiceStatusProcess; } ;
struct TYPE_8__ {char* lpBinaryPathName; } ;
typedef  int /*<<< orphan*/ * SC_HANDLE ;
typedef  TYPE_2__* LPQUERY_SERVICE_CONFIG ;
typedef  TYPE_3__* LPENUM_SERVICE_STATUS_PROCESS ;
typedef  int /*<<< orphan*/  LPBYTE ;
typedef  unsigned int DWORD ;

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (int /*<<< orphan*/ *) ; 
 scalar_t__ FUNC1 (int /*<<< orphan*/ *,int /*<<< orphan*/ ,unsigned int,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int,unsigned int*,unsigned int*,unsigned int*,int /*<<< orphan*/ *) ; 
 int GENERIC_READ ; 
 int /*<<< orphan*/  FUNC2 () ; 
 char* FUNC3 (char*) ; 
 int /*<<< orphan*/  LPTR ; 
 scalar_t__ FUNC4 (int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC5 (TYPE_3__*) ; 
 int /*<<< orphan*/ * FUNC6 (char*,int /*<<< orphan*/ *,int) ; 
 int /*<<< orphan*/ * FUNC7 (int /*<<< orphan*/ *,char*,int) ; 
 scalar_t__ FUNC8 (int /*<<< orphan*/ *,TYPE_2__*,int,unsigned int*) ; 
 int /*<<< orphan*/  RemoteHost ; 
 int /*<<< orphan*/  SC_ENUM_PROCESS_INFO ; 
 int SC_MANAGER_ENUMERATE_SERVICE ; 
 int SERVICE_CHANGE_CONFIG ; 
 unsigned int SERVICE_DRIVER ; 
 int /*<<< orphan*/  SERVICE_STATE_ALL ; 
 unsigned int SERVICE_WIN32 ; 
 int /*<<< orphan*/  TRUE ; 
 int /*<<< orphan*/  FUNC9 (int /*<<< orphan*/ ,int /*<<< orphan*/ *,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC10 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC11 (int) ; 
 int /*<<< orphan*/  FUNC12 (TYPE_3__*,char,int) ; 
 int /*<<< orphan*/  FUNC13 (char*,...) ; 

void FUNC14(char *host) {
 SC_HANDLE SCM;
 SC_HANDLE Svc;
 DWORD nResumeHandle;
 DWORD dwServiceType;
 LPENUM_SERVICE_STATUS_PROCESS lpServices;
 DWORD nSize = 0;
 DWORD nServicesReturned;
 unsigned int n;
 unsigned int l=0;
 DWORD dwByteNeeded;
 LPQUERY_SERVICE_CONFIG lpConfig;
 char *p;

    SCM = FUNC6(host,NULL,SC_MANAGER_ENUMERATE_SERVICE);
    if (!SCM){
        FUNC13("[-] OpenScManager() FAILED\n");
        FUNC10(FUNC2());
        FUNC11(-1);
    }
    nResumeHandle = 0;
    dwServiceType = SERVICE_WIN32 | SERVICE_DRIVER;
    lpServices = (LPENUM_SERVICE_STATUS_PROCESS) FUNC4(LPTR, 65535);
    if (!lpServices) {
        FUNC13("[-] CRITICAL ERROR: LocalAlloc() Failed\n");
        FUNC11(-1);
    }
    FUNC12(lpServices,'\0',sizeof(lpServices));
    if (FUNC1(SCM, SC_ENUM_PROCESS_INFO,
        dwServiceType, SERVICE_STATE_ALL,
        (LPBYTE)lpServices, 65535,
        &nSize, &nServicesReturned,
        &nResumeHandle, NULL) == 0)
    {
        FUNC13("EnumServicesStatusEx FAILED\n");
        FUNC11(-1);
    }

    FUNC13("[+] Listing Vulnerable Services...\n");
    for (n = 0; n < nServicesReturned; n++) {
        Svc = FUNC7(SCM,lpServices[n].lpServiceName, SERVICE_CHANGE_CONFIG | SC_MANAGER_ENUMERATE_SERVICE |GENERIC_READ);
        if (Svc!=NULL) {
            l++;
            FUNC13("\n    [%s]\t\t%s\n",lpServices[n].lpServiceName, lpServices[n].lpDisplayName);
            FUNC13("    Status: 0x%x\n",lpServices[n].ServiceStatusProcess.dwCurrentState);
            if (!host) {
                p=FUNC3(lpServices[n].lpServiceName);
                if (p) {
                    FUNC13("    Context:\t\t%s\n",p);
                } 
            }
    		dwByteNeeded = 0;
		    lpConfig = (LPQUERY_SERVICE_CONFIG) FUNC4(LPTR, 1024*8);
		    if (FUNC8(Svc, lpConfig, 1024*8, &dwByteNeeded)!=0) {
                FUNC13("    Parameter:\t\t%s\n",lpConfig->lpBinaryPathName);
            }else {
                FUNC10(FUNC2());
            }
        }
    }
    FUNC13("\n[+] Analyzed %i Services in your system\n",nServicesReturned);
    if (l>0) {
        FUNC13("[+] You were Lucky. %i vulnerable services found\n",l);
    }   else {
        FUNC13("[+] Your system is secure! Great! :/\n");
    }
     if (host) FUNC9(RemoteHost,NULL,TRUE);
    FUNC0(SCM);
    FUNC5(lpServices);
    FUNC11(1);
}