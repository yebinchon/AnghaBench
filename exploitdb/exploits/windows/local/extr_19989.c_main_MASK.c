#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 unsigned char EOF ; 
 int /*<<< orphan*/  FUNC0 () ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC2 (char*,char*) ; 
 unsigned char FUNC3 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC4 (char*,...) ; 
 int /*<<< orphan*/  FUNC5 (unsigned char,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * stdout ; 

int FUNC6(int argc, char *argv[])
{
   unsigned char charpos;
   FILE* outfile;
   FILE* infile;
   unsigned char a;
   unsigned char b;
   unsigned char key;
   unsigned char x;

   unsigned char charset[] = "\b\t\n\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSPUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\b\t\n\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSPUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";

   FUNC4("\nDecoder for PassWD v1.2 `pass.dat' password files\n");
   FUNC4("Written 2000 by Daniel Roethlisberger <admin@roe.ch>\n\n");

   if((argc > 3) || (argc < 2))
   {
      FUNC4("Usage: %s <infile> [<outfile>]\n\n", argv[0]);
      FUNC4("If <outfile> is omitted, the output is dumped to stdout.\n", argv[0]);
      return;
   }

   infile = FUNC2(argv[1], "r");
   if(infile == NULL)
   {
      FUNC4("Could not open file %s\n", argv[1]);
      return;
   }

   if(argc == 2)
      outfile = stdout;
   else
   {
      outfile = FUNC2(argv[2], "w");
      if(outfile == NULL)
      {
         FUNC4("Could not write to file %s\n", argv[2]);
         FUNC0();
         return;
      }
   }

   FUNC3(infile);       /* jump over decoy byte    */
   a = FUNC3(infile);   /* read encoded key byte 1 */
   b = FUNC3(infile);   /* read encoded key byte 2 */

   if(b == EOF)
   {
      FUNC4("ERROR - encountered EOF within header\n");
      return;
   }

   /* this line `decodes' the key */
   key = (unsigned char)((a - 'b') * 10 + (b - 'b'));

   /* read through infile and dump decoded output to outfile: */
   x = FUNC3(infile);
   while(!FUNC1(infile))
   {
      for(charpos = 0; x != charset[charpos]; charpos++)
      {
         if(charpos > 99)
         {
            FUNC4("\nERROR - encountered illegal character in source file\n");
            FUNC0();
            return;
         }
      }
      /* plain = cypher - key */
      FUNC5(charset[charpos + 99 - key], outfile);
      x = FUNC3(infile);
   }

   if(argc == 2)
      FUNC4("\n\n");
   FUNC4("Done.\n");

   FUNC0();
   return;
}