#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC2 (char*) ; 
 int /*<<< orphan*/  FUNC3 (int,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC4 (char*,char*) ; 
 int FUNC5 (char*) ; 

int FUNC6(int sock, char method, char* dn, char* cred)
{
	int cred_len, message_len, request_len;
	char krb_bind_request[2000];
	char* p;

	FUNC1(krb_bind_request,
		"\x30\x82\xff\xff"	/* request length */
		"\x02\x01\x01"		/* message id = 1 */
		"\x60"				/* bind request */
		"\x82\xff\xff"		/* message length */
		"\x02\x01\x02"		/* LDAP version 3 */
		"\x04",				/* dn */
	15);
	
	p = &krb_bind_request[15];
	
	if (FUNC5(dn) > 255) {
		FUNC2("bind_dn too long\n");
		FUNC0(1);
	}

	*p++ = (char)FUNC5(dn);
	FUNC4(p, dn);

	p += FUNC5(dn);
	
	*p++ = method;		/* authentication method */
	*p++ = '\x82';

	cred_len = FUNC5(cred);
	
	*p++ = (char) ((cred_len >> 8) & 0xff);
	*p++ = (char) (cred_len & 0xff);
	
	FUNC4(p, cred);
	
	message_len = 5 + FUNC5(dn) + 4 + cred_len;
	krb_bind_request[9] = (char) ((message_len >> 8) & 0xff);
	krb_bind_request[10] = (char) (message_len & 0xff);

	request_len = 7 + message_len;
	krb_bind_request[2] = (char) ((request_len >> 8) & 0xff);
	krb_bind_request[3] = (char) (request_len & 0xff);
	
	FUNC3(sock, krb_bind_request, 4+request_len, 0);
}