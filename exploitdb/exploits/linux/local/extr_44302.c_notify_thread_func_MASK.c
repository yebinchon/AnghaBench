#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct pollfd {int fd; int events; int revents; } ;
typedef  int nfds_t ;

/* Variables and functions */
 scalar_t__ EINTR ; 
 int /*<<< orphan*/  EXIT_FAILURE ; 
 int /*<<< orphan*/  EXIT_SUCCESS ; 
 int IN_ACCESS ; 
 int IN_CLOSE ; 
 int /*<<< orphan*/  IN_NONBLOCK ; 
 int IN_OPEN ; 
 int POLLIN ; 
 int STDIN_FILENO ; 
 int* FUNC0 (int,int) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 scalar_t__ errno ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,char*,char*) ; 
 int /*<<< orphan*/  FUNC4 (int*) ; 
 int /*<<< orphan*/  FUNC5 (int,int*,int,char**) ; 
 int FUNC6 (int,char*,int) ; 
 int FUNC7 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 
 int FUNC9 (struct pollfd*,int,int) ; 
 int /*<<< orphan*/  FUNC10 (char*) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stop ; 

__attribute__((used)) static void* FUNC11(void* arg) 
{
   char buf;
   int fd, i, poll_num;
   int *wd;
   nfds_t nfds;
   struct pollfd fds[2];

   int argc = 2;
   char *argv[] = { NULL, "test_dir", NULL};
/*
   if (argc < 2) {
       printf("Usage: %s PATH [PATH ...]\n", argv[0]);
       exit(EXIT_FAILURE);
   }
*/
   //printf("Press ENTER key to terminate.\n");

   /* Create the file descriptor for accessing the inotify API */

   fd = FUNC7(IN_NONBLOCK);
   if (fd == -1) {
       FUNC8("inotify_init1");
       FUNC2(EXIT_FAILURE);
   }

   /* Allocate memory for watch descriptors */

   wd = FUNC0(argc, sizeof(int));
   if (wd == NULL) {
       FUNC8("calloc");
       FUNC2(EXIT_FAILURE);
   }

   /* Mark directories for events
      - file was opened
      - file was closed */

   for (i = 1; i < argc; i++) {
       wd[i] = FUNC6(fd, argv[i],
                                 IN_OPEN | IN_CLOSE| IN_ACCESS);
       if (wd[i] == -1) {
           FUNC3(stderr, "Cannot watch '%s'\n", argv[i]);
           FUNC8("inotify_add_watch");
           FUNC2(EXIT_FAILURE);
       }
   }

   /* Prepare for polling */

   nfds = 2;

   /* Console input */

   fds[0].fd = STDIN_FILENO;
   fds[0].events = POLLIN;

   /* Inotify input */

   fds[1].fd = fd;
   fds[1].events = POLLIN;

   FUNC10("Listening for events.\n");
   while (!stop) {
       poll_num = FUNC9(fds, nfds, -1);
       if (poll_num == -1) {
           if (errno == EINTR)
               continue;
           FUNC8("poll");
           FUNC2(EXIT_FAILURE);
       }

       if (poll_num > 0) {

           if (fds[1].revents & POLLIN) {

               FUNC5(fd, wd, argc, argv);
           }
       }
   }

   FUNC1(fd);

   FUNC4(wd);
   FUNC2(EXIT_SUCCESS);
}