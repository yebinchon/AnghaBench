#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct utsname {char* release; } ;
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 int EOF ; 
 int /*<<< orphan*/  FUNC0 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC1 (char*,char*) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ,char*,char*,void*,char*) ; 
 int FUNC3 (int /*<<< orphan*/ *,char*,...) ; 
 int /*<<< orphan*/  FUNC4 (char*,char*,char*) ; 
 int /*<<< orphan*/  stdout ; 
 int /*<<< orphan*/  FUNC5 (char*,char*) ; 
 scalar_t__ FUNC6 (char*,char*,int) ; 
 char* FUNC7 (char*,char) ; 
 scalar_t__ FUNC8 (char*,char*) ; 
 int /*<<< orphan*/  FUNC9 (struct utsname*) ; 

unsigned long FUNC10(char *name)
{
        FILE *f;
        unsigned long addr;
        char dummy;
        char sname[512];
        struct utsname ver;
        int ret;
        int rep = 0;
        int oldstyle = 0;

        f = FUNC1("/proc/kallsyms", "r");
        if (f == NULL) {
                f = FUNC1("/proc/ksyms", "r");
                if (f == NULL)
                        goto fallback;
                oldstyle = 1;
        }

repeat:
        ret = 0;
        while(ret != EOF) {
                if (!oldstyle)
                        ret = FUNC3(f, "%p %c %s\n", (void **)&addr, &dummy, sname);
                else {
                        ret = FUNC3(f, "%p %s\n", (void **)&addr, sname);
                        if (ret == 2) {
                                char *p;
                                if (FUNC8(sname, "_O/") || FUNC8(sname, "_S."))
                                        continue;
                                p = FUNC7(sname, '_');
                                if (p > ((char *)sname + 5) && !FUNC6(p - 3, "smp", 3)) {
                                        p = p - 4;
                                        while (p > (char *)sname && *(p - 1) == '_')
                                                p--;
                                        *p = '\0';
                                }
                        }
                }
                if (ret == 0) {
                        FUNC3(f, "%s\n", sname);
                        continue;
                }
                if (!FUNC5(name, sname)) {
                        FUNC2(stdout, " [+] Resolved %s to %p%s\n", name, (void *)addr, rep ? " (via System.map)" : 
"");
                        FUNC0(f);
                        return addr;
                }
        }

        FUNC0(f);
        if (rep)
                return 0;
fallback:
        FUNC9(&ver);
        if (FUNC6(ver.release, "2.6", 3))
                oldstyle = 1;
        FUNC4(sname, "/boot/System.map-%s", ver.release);
        f = FUNC1(sname, "r");
        if (f == NULL)
                return 0;
        rep = 1;
        goto repeat;
}