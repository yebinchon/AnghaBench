#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct sockaddr_nl {int nl_pid; unsigned long nl_groups; } ;
typedef  int /*<<< orphan*/  addr ;

/* Variables and functions */
 scalar_t__ FUNC0 (int,struct sockaddr_nl*,size_t*) ; 
 int /*<<< orphan*/  FUNC1 (struct sockaddr_nl*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC2 (char*) ; 
 int /*<<< orphan*/  FUNC3 (char*,...) ; 

__attribute__((used)) static bool FUNC4(int sock_fd, int magic_pid, unsigned long magic_groups)
{
  struct sockaddr_nl addr;
  size_t addr_len = sizeof(addr);

  FUNC1(&addr, 0, sizeof(addr));
  // this will invoke "netlink_getname()" (uncontrolled read)
  if (FUNC0(sock_fd, &addr, &addr_len))
  {
    FUNC2("[-] getsockname");
    goto fail;
  }
  FUNC3("[ ] addr_len = %lu\n", addr_len);
  FUNC3("[ ] addr.nl_pid = %d\n", addr.nl_pid);
  FUNC3("[ ] magic_pid = %d\n", magic_pid);

  if (addr.nl_pid != magic_pid)
  {
    FUNC3("[-] magic PID does not match!\n");
    goto fail;
  }

  if (addr.nl_groups != magic_groups) 
  {
    FUNC3("[-] groups pointer does not match!\n");
    goto fail;
  }

  return true;
  
fail:
  FUNC3("[-] failed to check realloc success status!\n");
  return false;
}