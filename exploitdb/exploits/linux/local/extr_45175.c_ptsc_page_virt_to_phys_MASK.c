#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct pud_entry {int addr; struct pmd_entry** entries; } ;
struct pgd_entry {int addr; struct pud_entry** entries; } ;
struct ptsc {unsigned long physmap; struct pgd_entry entry; } ;
struct pte_entry {int addr; unsigned long* entries; } ;
struct pmd_entry {int addr; TYPE_1__* entries; } ;
struct TYPE_2__ {unsigned long phys; int huge; struct pte_entry* pte; } ;

/* Variables and functions */
 unsigned long HUGE_PAGE_MASK ; 
 unsigned long PAGE_MASK ; 
 unsigned long PHYSICAL_PAGE_MASK ; 
 int _PAGE_PSE ; 
 int /*<<< orphan*/  FUNC0 (char*,...) ; 
 int FUNC1 (unsigned long) ; 
 scalar_t__ FUNC2 (unsigned long) ; 
 int /*<<< orphan*/  FUNC3 (unsigned long) ; 
 int FUNC4 (unsigned long) ; 
 int FUNC5 (unsigned long) ; 
 scalar_t__ FUNC6 (unsigned long) ; 
 int /*<<< orphan*/  FUNC7 (unsigned long) ; 
 int FUNC8 (unsigned long) ; 
 scalar_t__ FUNC9 (unsigned long) ; 
 int /*<<< orphan*/  FUNC10 (unsigned long) ; 
 struct pmd_entry* FUNC11 (unsigned long) ; 
 struct pte_entry* FUNC12 (unsigned long) ; 
 struct pud_entry* FUNC13 (unsigned long) ; 
 int FUNC14 (unsigned long) ; 
 scalar_t__ FUNC15 (unsigned long) ; 
 int /*<<< orphan*/  FUNC16 (unsigned long) ; 
 unsigned long FUNC17 (int) ; 

__attribute__((used)) static unsigned long FUNC18(struct ptsc* ptsc,
						unsigned long addr) {
	struct pgd_entry *pgd_e;
	struct pud_entry *pud_e;
	struct pmd_entry *pmd_e;
	struct pte_entry *pte_e;
	unsigned long phys_a;
	int index;

	FUNC0("looking up phys addr for %016lx:\n", addr);

	pgd_e = &ptsc->entry;

	index = FUNC1(addr);
	FUNC0(" pgd: %016lx, index: %d\n", pgd_e->addr, index);
	if (!pgd_e->entries[index]) {
		unsigned long pgd_v = FUNC17(
			pgd_e->addr + index * sizeof(unsigned long));
		FUNC0("   -> %016lx\n", pgd_v);
		if (FUNC2(pgd_v)) {
			FUNC0(" not found, pgd is none\n");
			return 0;
		}
		if (!FUNC3(pgd_v)) {
			FUNC0(" not found, pgd is not present\n");
			return 0;
		}
		unsigned long pud_a =
			ptsc->physmap + (pgd_v & PHYSICAL_PAGE_MASK);
		pud_e = FUNC13(pud_a);
		pgd_e->entries[index] = pud_e;
	}
	pud_e = pgd_e->entries[index];

	index = FUNC14(addr);
	FUNC0(" pud: %016lx, index: %d\n", pud_e->addr, index);
	if (!pud_e->entries[index]) {
		unsigned long pud_v = FUNC17(
			pud_e->addr + index * sizeof(unsigned long));
		FUNC0("   -> %016lx\n", pud_v);
		if (FUNC15(pud_v)) {
			FUNC0(" not found, pud is none\n");
			return 0;
		}
		if (!FUNC16(pud_v)) {
			FUNC0(" not found, pud is not present\n");
			return 0;
		}
		unsigned long pmd_a =
			ptsc->physmap + (pud_v & PHYSICAL_PAGE_MASK);
		pmd_e = FUNC11(pmd_a);
		pud_e->entries[index] = pmd_e;
	}
	pmd_e = pud_e->entries[index];

	index = FUNC5(addr);
	FUNC0(" pmd: %016lx, index: %d\n", pmd_e->addr, index);
	if (!pmd_e->entries[index].pte) {
		unsigned long pmd_v = FUNC17(
			pmd_e->addr + index * sizeof(unsigned long));
		FUNC0("   -> %016lx\n", pmd_v);
		if (FUNC6(pmd_v)) {
			FUNC0(" not found, pmd is none\n");
			return 0;
		}
		if (!FUNC7(pmd_v)) {
			FUNC0(" not found, pmd is not present\n");
			return 0;
		}
		if (FUNC4(pmd_v) & _PAGE_PSE) {
			phys_a = ptsc->physmap + (pmd_v & PHYSICAL_PAGE_MASK) +
					(addr & ~HUGE_PAGE_MASK);
			pmd_e->entries[index].phys = phys_a;
			pmd_e->entries[index].huge = true;
		} else {
			unsigned long pte_a =
				ptsc->physmap + (pmd_v & PHYSICAL_PAGE_MASK);
			pte_e = FUNC12(pte_a);
			pmd_e->entries[index].pte = pte_e;
			pmd_e->entries[index].huge = false;
		}
	}

	if (pmd_e->entries[index].huge) {
		FUNC0(" phy: %016lx (huge)\n", phys_a);
		return pmd_e->entries[index].phys;
	}

	pte_e = pmd_e->entries[index].pte;

	index = FUNC8(addr);
	FUNC0(" pte: %016lx, index: %d\n", pte_e->addr, index);
	if (!pte_e->entries[index]) {
		unsigned long pte_v = FUNC17(
			pte_e->addr + index * sizeof(unsigned long));
		FUNC0("   -> %016lx\n", pte_v);
		if (FUNC9(pte_v)) {
			FUNC0(" not found, pte is none\n");
			return 0;
		}
		if (!FUNC10(pte_v)) {
			FUNC0(" not found, pte is not present\n");
			return 0;
		}
		phys_a = ptsc->physmap + (pte_v & PHYSICAL_PAGE_MASK) +
				(addr & ~PAGE_MASK);
		pte_e->entries[index] = phys_a;
	}
	phys_a = pte_e->entries[index];

	return phys_a;
}