#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct pollfd {int fd; int events; int /*<<< orphan*/  revents; } ;
typedef  int ssize_t ;
typedef  int /*<<< orphan*/  lastbytes ;

/* Variables and functions */
 int LASTBUFSZ ; 
 int POLLERR ; 
 int POLLHUP ; 
 int POLLIN ; 
 int /*<<< orphan*/  POLL_TIMEOUT ; 
 int /*<<< orphan*/  FUNC0 () ; 
 int /*<<< orphan*/  errno ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ,char*,...) ; 
 scalar_t__ FUNC3 (char*,char*,size_t) ; 
 int /*<<< orphan*/  FUNC4 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC5 (char*,int,int /*<<< orphan*/ ) ; 
 int FUNC6 (struct pollfd*,int,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC7 (char*,size_t,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC8 (char*,int /*<<< orphan*/ ) ; 
 int FUNC9 (int,char*,int) ; 
 int /*<<< orphan*/  stderr ; 
 char* FUNC10 (int /*<<< orphan*/ ) ; 

__attribute__((used)) static void FUNC11(int masterfd, char *str, size_t len)
{
	char lastbytes[LASTBUFSZ + 1];
	size_t totalbytes = 0;
	FUNC5(lastbytes, sizeof(lastbytes), 0);

	for (;;) {
	  	char buf[1];
		ssize_t bytes;
		int ret;
		struct pollfd fds = {
			.fd = masterfd,
			.events = POLLIN | POLLERR | POLLHUP,
			.revents = 0,
		};
		ret = FUNC6(&fds, 1, POLL_TIMEOUT);
		if (ret == 0) {
			FUNC2(stderr, "Timeout while waiting for '");
			FUNC8(str, stderr);
			FUNC2(stderr, "' ");
			FUNC7(lastbytes, totalbytes, stderr);
			FUNC2(stderr,"\n");
			FUNC1(5);
		}
		else if (ret < 0) {
			FUNC2(stderr, "poll failed: %s\n", FUNC10(errno));
			FUNC1(4);
		}
		bytes = FUNC9(masterfd, buf, 1);
		if (bytes == 1) {
			totalbytes++;
			FUNC4(lastbytes, lastbytes +1, LASTBUFSZ);
			lastbytes[LASTBUFSZ - 1] = buf[0];
			lastbytes[LASTBUFSZ] = '\0';
			if (FUNC3(&lastbytes[LASTBUFSZ - len], str, len) == 0)
				return;
		}
		else if (bytes < 0) {
			FUNC2(stderr, "read failed: %s\n",
				FUNC10(errno));
			FUNC7(lastbytes, totalbytes, stderr);
			FUNC2(stderr,"\n");
			FUNC0();
			FUNC1(3);
		}
	}
}