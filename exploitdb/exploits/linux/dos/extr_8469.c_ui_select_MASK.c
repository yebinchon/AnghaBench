#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_8__   TYPE_3__ ;
typedef  struct TYPE_7__   TYPE_2__ ;
typedef  struct TYPE_6__   TYPE_1__ ;

/* Type definitions */
typedef  int /*<<< orphan*/  uint32 ;
struct TYPE_7__ {int /*<<< orphan*/  scancode; } ;
typedef  TYPE_2__ key_translation ;
typedef  int /*<<< orphan*/  fd_set ;
struct TYPE_6__ {int /*<<< orphan*/  state; int /*<<< orphan*/  keycode; } ;
struct TYPE_8__ {TYPE_1__ xkey; } ;
typedef  TYPE_3__ XEvent ;
typedef  int /*<<< orphan*/  KeySym ;

/* Variables and functions */
 scalar_t__ FUNC0 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC1 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  RDP_KEYPRESS ; 
 scalar_t__ True ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,TYPE_2__) ; 
 int /*<<< orphan*/  errno ; 
 int /*<<< orphan*/  FUNC4 (char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC5 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,scalar_t__) ; 
 int /*<<< orphan*/  ix ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int FUNC7 (int,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC8 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC9 (int /*<<< orphan*/ *) ; 
 int x_socket ; 
 TYPE_2__ FUNC10 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 

int
FUNC11(int rdp_socket)
{
	int n = (rdp_socket > x_socket) ? rdp_socket + 1 : x_socket + 1;
	fd_set rfds;



// Begin PoC mods
        XEvent xevent;
        KeySym keysym;
        uint32 ev_time;
        key_translation tr;
        if (ix-- >= 0)
        { return 1; }
        ev_time = FUNC9(NULL);
        FUNC5(keysym, xevent.xkey.state, ev_time, True);
	tr = FUNC10(keysym, xevent.xkey.keycode, xevent.xkey.state);
	FUNC3(ev_time, tr);
	FUNC6(ev_time, RDP_KEYPRESS, tr.scancode);
// End PoC mods



	FUNC2(&rfds);
	while (True)
	{
		/* Process any events already waiting */

//		if (!xwin_process_events())
//			/* User quit */
//			return 0;

		FUNC2(&rfds);
		FUNC1(rdp_socket, &rfds);
		FUNC1(x_socket, &rfds);

		switch (FUNC7(n, &rfds, NULL, NULL, NULL))
		{
			case -1:
				FUNC4("select: %s\n", FUNC8(errno));

			case 0:
				continue;
		}

		if (FUNC0(rdp_socket, &rfds))
			return 1;
	}
}