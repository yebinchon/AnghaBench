#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  uint8_t ;
struct nlmsghdr {scalar_t__ nlmsg_type; int nlmsg_len; } ;
struct inet_diag_msg {int dummy; } ;
typedef  int /*<<< orphan*/  recv_buf ;
typedef  int /*<<< orphan*/  pthread_t ;

/* Variables and functions */
 int /*<<< orphan*/  AF_NETLINK ; 
 int EXIT_FAILURE ; 
 int EXIT_SUCCESS ; 
 int /*<<< orphan*/  NETLINK_INET_DIAG ; 
 scalar_t__ FUNC0 (struct nlmsghdr*) ; 
 scalar_t__ NLMSG_DONE ; 
 scalar_t__ NLMSG_ERROR ; 
 int FUNC1 (int) ; 
 struct nlmsghdr* FUNC2 (struct nlmsghdr*,int) ; 
 scalar_t__ FUNC3 (struct nlmsghdr*,int) ; 
 int SOCKET_BUFFER_SIZE ; 
 int /*<<< orphan*/  SOCK_DGRAM ; 
 int client_stop_flag ; 
 int /*<<< orphan*/  client_thread ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ ,char*) ; 
 int /*<<< orphan*/  FUNC5 (struct inet_diag_msg*,int) ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 scalar_t__ FUNC8 (int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ ,int /*<<< orphan*/ *) ; 
 scalar_t__ FUNC9 (int /*<<< orphan*/ ,int /*<<< orphan*/ *) ; 
 int FUNC10 (int,int /*<<< orphan*/ *,int,int /*<<< orphan*/ ) ; 
 scalar_t__ FUNC11 (int) ; 
 int /*<<< orphan*/  server_thread ; 
 int servser_stop_flag ; 
 int /*<<< orphan*/  FUNC12 (int) ; 
 int FUNC13 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  stderr ; 

int FUNC14(int argc, char *argv[]){
    int nl_sock = 0, numbytes = 0, rtalen = 0;
    struct nlmsghdr *nlh;
    uint8_t recv_buf[SOCKET_BUFFER_SIZE];
    struct inet_diag_msg *diag_msg;
    pthread_t sctp_server;
    pthread_t sctp_client;

    // run sctp server & client
    if (FUNC8(&sctp_server, NULL, server_thread, NULL))
        return EXIT_FAILURE;
    FUNC12(2);

    if (FUNC8(&sctp_client, NULL, client_thread, NULL))
        return EXIT_FAILURE;
    FUNC12(2);

    // run inet_diag
    if((nl_sock = FUNC13(AF_NETLINK, SOCK_DGRAM, NETLINK_INET_DIAG)) == -1){
        FUNC6("socket: ");
        return EXIT_FAILURE;
    }

    if(FUNC11(nl_sock) < 0){
        FUNC6("sendmsg: ");
        return EXIT_FAILURE;
    }

    while(1){
        numbytes = FUNC10(nl_sock, recv_buf, sizeof(recv_buf), 0);
        nlh = (struct nlmsghdr*) recv_buf;

        while(FUNC3(nlh, numbytes)){
            if(nlh->nlmsg_type == NLMSG_DONE) {
                return EXIT_SUCCESS;
            }

            if(nlh->nlmsg_type == NLMSG_ERROR){
                FUNC4(stderr, "Error in netlink message\n");
                return EXIT_FAILURE;
            }

            diag_msg = (struct inet_diag_msg*) FUNC0(nlh);
            rtalen = nlh->nlmsg_len - FUNC1(sizeof(*diag_msg));
            FUNC5(diag_msg, rtalen);

            nlh = FUNC2(nlh, numbytes); 
        }
    }
    FUNC7("loop next\n");

    // exit threads
    client_stop_flag = 1;
    if (FUNC9(sctp_client, NULL))
        return EXIT_FAILURE;

    servser_stop_flag = 1;
    if (FUNC9(sctp_server, NULL))
        return EXIT_FAILURE;

    FUNC7("end\n");
    return EXIT_SUCCESS;
}