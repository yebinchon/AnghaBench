#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int u_short ;
typedef  int /*<<< orphan*/  u_long ;
typedef  int /*<<< orphan*/  libnet_t ;
typedef  int libnet_ptag_t ;

/* Variables and functions */
 char* DEVICE ; 
 char* DST_IP ; 
 int DST_PRT ; 
 int /*<<< orphan*/  EXIT_FAILURE ; 
 int EXIT_SUCCESS ; 
 int /*<<< orphan*/  IPPROTO_UDP ; 
 int IP_MF ; 
 int LIBNET_ERRBUF_SIZE ; 
 int /*<<< orphan*/  LIBNET_RAW4 ; 
 int /*<<< orphan*/  LIBNET_RESOLVE ; 
 int LIBNET_UDP_H ; 
 char* SRC_IP ; 
 int SRC_PRT ; 
 int /*<<< orphan*/  FUNC0 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ,char*,char*) ; 
 int FUNC2 (int,int /*<<< orphan*/ ,int,int,int,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ *,int /*<<< orphan*/ ,int /*<<< orphan*/ *,int) ; 
 int FUNC3 (int,int,int,int /*<<< orphan*/ ,unsigned char*,int,int /*<<< orphan*/ *,int) ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ *) ; 
 char* FUNC5 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC6 (int /*<<< orphan*/ ,char*,char*) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ *,char*,int /*<<< orphan*/ ) ; 
 int FUNC8 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  stderr ; 

int FUNC10 (char *device, char *pSRC, char *pDST, u_short sPRT,
                u_short dPRT, int count)
{                           

    libnet_t *l = NULL;
    libnet_ptag_t udp = 0;
    libnet_ptag_t ip = 0;
    
    char errbuf[LIBNET_ERRBUF_SIZE];
    char *payload = NULL;
    u_short payload_s = 0, src_prt, dst_prt;
    u_long src_ip, dst_ip;
    int c, frag;
        
    if (!device)
        device = DEVICE;
        
    l = FUNC6 (LIBNET_RAW4, device, errbuf);

    if (!l) {
        FUNC1 (stderr, "libnet_init() failed: %s\n", errbuf);
        FUNC0 (EXIT_FAILURE);
    }
	
    src_ip = pSRC ? FUNC7 (l, pSRC, LIBNET_RESOLVE) :
        FUNC7 (l, SRC_IP, LIBNET_RESOLVE);

    dst_ip = pDST ? FUNC7 (l, pDST, LIBNET_RESOLVE) :
        FUNC7 (l, DST_IP, LIBNET_RESOLVE);

    src_prt = sPRT ? sPRT : SRC_PRT;

    dst_prt = dPRT ? dPRT : DST_PRT;

    if (count == 1) {
        payload = "\0\0\0\0\0\0\0\0";
        payload_s = 8;
    }

    udp = FUNC3 (src_prt,
                            dst_prt,
                            (LIBNET_UDP_H + payload_s) * 2,
                            0, (unsigned char *)payload, payload_s, l, udp);

    if (udp == -1) {
        FUNC1 (stderr, "Can't build UDP header: %s\n", FUNC5 (l));
        FUNC0 (EXIT_FAILURE);
    }

    switch (count) {

    case 1:
        frag = IP_MF;
        break;

    case 2:
        frag = 0x2002;
        break;

    case 3:
        frag = 0x0003;
        break;
    }

    ip = FUNC2 (20,
                            0,
                            1800,
                            frag,
                            128,
                            IPPROTO_UDP, 0, src_ip, dst_ip, NULL, 0, l, ip);

    if (ip == -1) {
        FUNC1 (stderr, "Can't build IP header: %s\n", FUNC5 (l));
        FUNC0 (EXIT_FAILURE);
    }

    c = FUNC8 (l);

    if (c == -1) {
        FUNC1 (stderr, "Write error: %s\n", FUNC5 (l));
        FUNC0 (EXIT_FAILURE);
    }

    FUNC9 ("Wrote UDP packet; check the wire.\n");

    FUNC4 (l);

    return (EXIT_SUCCESS);

}