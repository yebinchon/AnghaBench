#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct timeval {int /*<<< orphan*/  member_1; int /*<<< orphan*/  member_0; } ;
struct TYPE_2__ {unsigned long s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int /*<<< orphan*/  sin_family; int /*<<< orphan*/  sin_port; } ;
struct sockaddr {int dummy; } ;
typedef  int /*<<< orphan*/  server ;
typedef  int /*<<< orphan*/  fd_set ;
typedef  int /*<<< orphan*/  error ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 scalar_t__ EINPROGRESS ; 
 scalar_t__ FUNC0 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC1 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  F_GETFL ; 
 int /*<<< orphan*/  F_SETFL ; 
 int O_NONBLOCK ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  SOL_SOCKET ; 
 int /*<<< orphan*/  SO_ERROR ; 
 int /*<<< orphan*/  TIMEOUT ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int FUNC4 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC5 (char*) ; 
 scalar_t__ errno ; 
 int FUNC6 (int,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ ,char*) ; 
 int FUNC8 (int,int /*<<< orphan*/ ,int /*<<< orphan*/ ,int*,int*) ; 
 int /*<<< orphan*/  FUNC9 (unsigned short) ; 
 int /*<<< orphan*/  FUNC10 (struct sockaddr_in*,int,int) ; 
 int /*<<< orphan*/  FUNC11 (char*) ; 
 int FUNC12 (int,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ *,struct timeval*) ; 
 int FUNC13 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  stderr ; 

int FUNC14( unsigned long ip, unsigned short port )
{

        int     ret, flags, s ;
        struct  sockaddr_in     server ;

        FUNC10( &server, 0x0, sizeof(server) );

        server.sin_port = FUNC9 ( port );
        server.sin_family = AF_INET ;
        server.sin_addr.s_addr = ip ;

        if ((s = FUNC13(AF_INET, SOCK_STREAM, 0)) == -1 ) {
                FUNC11("[-] Socket");
                return -1 ;
        }

        /**
         ** sets non blocking socket and connects, ripped somewhere
        **/

        if ((flags = FUNC6 (s, F_GETFL, 0)) == -1 ) {
                FUNC3( s );
                return -1;
        }

        if (FUNC6(s, F_SETFL, flags | O_NONBLOCK) == -1) {
                FUNC3( s );
                return -1;
        }

        ret = FUNC4(s, (struct sockaddr *)&server, sizeof(server));

        if ( ret < 0 )
        {
                if ( errno != EINPROGRESS ) {
                        FUNC3( s );
                        return -1;
                }
                else
                {
                        int                     n ;
                        struct timeval          tv = { TIMEOUT, 0 };
                        fd_set                  rset, wset;

                        FUNC2( &rset );
                        FUNC2( &wset );
                        FUNC1( s, &rset );
                        FUNC1( s, &wset );

                        if ((n = FUNC12( s + 1, &rset, &wset, NULL, &tv)) == -1 ) {
                                FUNC11("[-] Select");
                                return -1;
                        }
                        /**
                         ** handles timeout
                         **/
                        if (n == 0) {
                                FUNC3( s );
                                FUNC7(stderr,"[-] Timeout\n");
                                return -1;
                        }

                        if (FUNC0( s, &rset ) || FUNC0( s, &wset ))
                        {
                                int error = 0 ;
                                int len = sizeof( error );
                                if (FUNC8(s, SOL_SOCKET, SO_ERROR, &error, &len) == -1) {
                                        FUNC11("[-] Getsockopt");
                                        return -1;
                                }
                                if (error != 0) {
                                        FUNC5("[*] SO_ERROR != 0\n");
                                        return -1;
                                }
                        }
                        else
                        {
                                return -1 ;
                        }
                }
        }
        /**
         **      restores flags and returns
         **/
        if ( FUNC6(s, F_SETFL, flags) == -1 )
                return -1;
        else
                return s;
}