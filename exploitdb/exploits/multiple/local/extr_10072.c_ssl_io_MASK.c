#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
struct ssl_io_t {int fd; } ;
typedef  int /*<<< orphan*/  fd_set ;

/* Variables and functions */
 scalar_t__ FUNC0 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC1 (int,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC2 (int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  SHUT_RD ; 
 int /*<<< orphan*/  SHUT_WR ; 
 int /*<<< orphan*/  FUNC3 (char*) ; 
 int FUNC4 (struct ssl_io_t*,unsigned char*) ; 
 int /*<<< orphan*/  FUNC5 (struct ssl_io_t*,unsigned char*,int) ; 
 int FUNC6 (int,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ *,int /*<<< orphan*/ *) ; 
 int /*<<< orphan*/  FUNC7 (int,int /*<<< orphan*/ ) ; 

void
FUNC8
    (struct ssl_io_t *assl, struct ssl_io_t *cssl)
{
  struct ssl_io_t *ssls[2];
  int maxfd, active;
  int i, r, l;
  fd_set rfd;
  unsigned char buf[1 << 16];

  ssls[0] = assl;
  ssls[1] = cssl;
  active = 3;
  maxfd = 0;
  for (i = 0; i < 2; i++)
    if (ssls[i]->fd >= maxfd)
      maxfd = ssls[i]->fd + 1;

  while (active) {
    FUNC2(&rfd);
    for (i = 0; i < 2; i++)
      if (active & (1 << i))
	FUNC1(ssls[i]->fd, &rfd);
    r = FUNC6(maxfd, &rfd, NULL, NULL, NULL);
    if (r == -1)
      FUNC3("rec_io:select");
    for (i = 0; i < 2; i++) {
      if (active & (1 << i) && FUNC0(ssls[i]->fd, &rfd)) {
	r = FUNC4(ssls[i], buf);
	if (r == 0) {
	  FUNC7(ssls[i]->fd, SHUT_RD);
	  FUNC7(ssls[1 - i]->fd, SHUT_WR);
	  active &= ~(1 << i);
	  continue;
	}
	l = r;
	FUNC5(ssls[1 - i], buf, l);
      }
    }
  }
}