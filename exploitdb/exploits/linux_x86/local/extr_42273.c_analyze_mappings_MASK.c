#define NULL ((void*)0)
typedef unsigned long size_t;  // Customize by platform.
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;  // Either arithmetic or pointer type.
/* By default, we understand bool (as a convenience). */
typedef int bool;
#define false 0
#define true 1

/* Forward declarations */

/* Type definitions */
typedef  int ssize_t ;
typedef  int /*<<< orphan*/  buf ;

/* Variables and functions */
 scalar_t__ EAGAIN ; 
 scalar_t__ EINTR ; 
 int EXIT_FAILURE ; 
 int EXIT_SUCCESS ; 
 int /*<<< orphan*/  O_RDONLY ; 
 int /*<<< orphan*/  STDERR_FILENO ; 
 scalar_t__ FUNC0 (int const) ; 
 int /*<<< orphan*/  FUNC1 () ; 
 scalar_t__ errno ; 
 int /*<<< orphan*/  FUNC2 (int) ; 
 int /*<<< orphan*/  FUNC3 (int /*<<< orphan*/ ,char*) ; 
 char* FUNC4 (char*,char,int) ; 
 int FUNC5 (char*,int /*<<< orphan*/ ) ; 
 int FUNC6 (int const,char*,int) ; 
 int /*<<< orphan*/  stderr ; 
 char* FUNC7 (char const*,char) ; 
 int /*<<< orphan*/  FUNC8 (char*,char const* const) ; 
 int FUNC9 (char*) ; 
 char* FUNC10 (char*,char) ; 
 size_t FUNC11 (char const*,char**,int) ; 
 int const FUNC12 (int /*<<< orphan*/ ,char*,int const) ; 

__attribute__((used)) static void
FUNC13(const char * const binary)
{
    if (!binary) FUNC1();
    if (FUNC7(binary, ' ')) FUNC1();
    int rval = EXIT_FAILURE;
    int dump = 0;

    const int fd = FUNC5("/proc/self/maps", O_RDONLY);
    if (fd <= -1) FUNC1();

    static char buf[4096] = " ";
    char * cp = buf;
    for (;;) {
        if (cp >= buf + sizeof(buf)) FUNC1();
        const ssize_t nr = FUNC6(fd, cp, buf + sizeof(buf) - cp);
        if (nr <= 0) {
            if (nr == 0) break;
            if (nr != -1) FUNC1();
            if (errno != EAGAIN && errno != EINTR) FUNC1();
            continue;
        }
        cp += nr;
    }
    *cp = '\0';
    if (FUNC4(buf, '\0', sizeof(buf)) != cp) FUNC1();

    size_t hi_bin = 0;
    size_t lo_lib = 0;
    size_t lo_heap = 0;
    size_t lo_stack = 0;
    const char * line = buf;
    for (;;) {
        char * const nl = FUNC7(line, '\n');
        if (!nl) FUNC1();
        *nl = '\0';

        cp = NULL;
        const size_t lo = FUNC11(line, &cp, 16);
        if (cp <= line || *cp != '-') FUNC1();
        if (lo <= 0) FUNC1();

        line = cp + 1;
        cp = NULL;
        const size_t hi = FUNC11(line, &cp, 16);
        if (cp <= line || *cp != ' ') FUNC1();
        if (hi <= lo) FUNC1();

        cp = FUNC10(cp + 1, ' ');
        if (!cp) FUNC1();
        cp++;

        if (!FUNC8(cp, binary)) {
            hi_bin = hi;
            if (lo == 0x08048000) {
                FUNC3(stderr, "Please recompile with -fpie -pie\n");
                FUNC1();
            }
        } else if (!FUNC8(cp, "[heap]")) {
            if (!lo_heap) lo_heap = lo;
            else {
                if (lo_stack) FUNC1();
                lo_stack = lo;
                dump = 1;
            }
        } else if (!FUNC8(cp, "[stack]")) {
            if (!lo_stack) lo_stack = lo;
            else {
                FUNC1();
            }
        } else if (*cp == '/') {
            if (!lo_lib) lo_lib = lo;
        }

        *nl = '\n';
        line = nl + 1;
        if (*line == '\0') break;
    }
    if (!hi_bin) FUNC1();
    if (!lo_lib) FUNC1();
    if (!lo_stack) {
        if (!lo_heap) FUNC1();
        lo_stack = lo_heap;
        lo_heap = 0;
    }

    if (hi_bin <= lo_lib && lo_lib - hi_bin <= 4096) {
        FUNC3(stderr, "CVE-2017-1000370 triggered\n");
        rval = EXIT_SUCCESS;
        dump = 1;
    }
    if (hi_bin <= lo_stack && lo_stack - hi_bin <= 4096) {
        FUNC3(stderr, "CVE-2017-1000371 triggered\n");
        rval = EXIT_SUCCESS;
        dump = 1;
    }
    if (dump) {
        const ssize_t len = FUNC9(buf);
        if (len <= 0) FUNC1();
        if (FUNC12(STDERR_FILENO, buf, len) != len) FUNC1();
    }
    if (FUNC0(fd)) FUNC1();
    FUNC2(rval);
}